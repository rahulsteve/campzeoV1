[{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\admin\\_components\\create-org-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":58,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1569,1572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1569,1572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { Plus } from \"lucide-react\";\r\n\r\ninterface CreateOrgDialogProps {\r\n  onSuccess: () => void;\r\n}\r\n\r\nexport function CreateOrgDialog({ onSuccess }: CreateOrgDialogProps) {\r\n  const [open, setOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [name, setName] = useState(\"\");\r\n  const [plan, setPlan] = useState(\"FREE_TRIAL\");\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/admin/organisations\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ name, plan }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(\"Organisation created successfully\");\r\n        setOpen(false);\r\n        setName(\"\");\r\n        setPlan(\"FREE_TRIAL\");\r\n        onSuccess();\r\n      } else {\r\n        throw new Error(data.message || \"Failed to create organisation\");\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.message);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        <Button>\r\n          <Plus className=\"mr-2 size-4\" />\r\n          Add Organisation\r\n        </Button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"sm:max-w-[425px]\">\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogHeader>\r\n            <DialogTitle>Add Organisation</DialogTitle>\r\n            <DialogDescription>\r\n              Create a new tenant organisation. You can assign users later.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"grid gap-4 py-4\">\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"name\" className=\"text-right\">\r\n                Name\r\n              </Label>\r\n              <Input\r\n                id=\"name\"\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n                className=\"col-span-3\"\r\n                required\r\n              />\r\n            </div>\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"plan\" className=\"text-right\">\r\n                Plan\r\n              </Label>\r\n              <Select value={plan} onValueChange={setPlan}>\r\n                <SelectTrigger className=\"col-span-3\">\r\n                  <SelectValue placeholder=\"Select a plan\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"FREE_TRIAL\">Free Trial</SelectItem>\r\n                  <SelectItem value=\"PROFESSIONAL\">Professional</SelectItem>\r\n                  <SelectItem value=\"ENTERPRISE\">Enterprise</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button type=\"submit\" disabled={isLoading}>\r\n              {isLoading ? \"Creating...\" : \"Create Organisation\"}\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\admin\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\admin\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Printer' is defined but never used.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DropdownMenu' is defined but never used.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DropdownMenuContent' is defined but never used.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DropdownMenuItem' is defined but never used.","line":38,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DropdownMenuTrigger' is defined but never used.","line":39,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'constants' is defined but never used.","line":54,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1818,1821],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1818,1821],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1876,1879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1876,1879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1946,1949],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1946,1949],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2008,2011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2008,2011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2056,2059],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2056,2059],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setPageSize' is assigned a value but never used.","line":69,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":135,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":135,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchOrganisations'. Either include it or remove the dependency array.","line":174,"column":6,"nodeType":"ArrayExpression","endLine":174,"endColumn":53,"suggestions":[{"desc":"Update the dependencies array to be: [activeTab, fetchOrganisations, pageNumber, pageSize, statusFilter]","fix":{"range":[5467,5514],"text":"[activeTab, fetchOrganisations, pageNumber, pageSize, statusFilter]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":272,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8914,8917],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8914,8917],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":279,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9051,9054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9051,9054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":310,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":310,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9966,9969],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9966,9969],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":372,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12006,12009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12006,12009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":388,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":388,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12512,12515],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12512,12515],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":403,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":403,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12983,12986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12983,12986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":432,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":432,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13901,13904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13901,13904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleApproveEnquiry' is assigned a value but never used.","line":438,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":438,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is defined but never used.","line":438,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":438,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":460,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":460,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15054,15057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15054,15057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'jobName' is defined but never used.","line":464,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":464,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'frequency' is defined but never used.","line":464,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":464,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isEnabled' is defined but never used.","line":464,"column":70,"nodeType":null,"messageId":"unusedVar","endLine":464,"endColumn":79},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is defined but never used.","line":465,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":465,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":476,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":476,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15694,15697],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15694,15697],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":489,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":489,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16508,16511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16508,16511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":513,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":513,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17379,17382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17379,17382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport {\r\n  Users,\r\n  Settings,\r\n  Shield,\r\n  MessageSquare,\r\n  MoreVertical,\r\n  CheckCircle,\r\n  Plus,\r\n  ArrowLeft,\r\n  Search,\r\n  Printer,\r\n  Mail,\r\n  Smartphone,\r\n  Facebook,\r\n  Instagram,\r\n  Linkedin,\r\n  Youtube,\r\n  ChevronLeft,\r\n  Eye,\r\n  EyeOff,\r\n  ChevronRight,\r\n  Download\r\n} from \"lucide-react\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { SecretInput } from \"@/components/ui/secret-input\";\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport { useUser , UserButton } from \"@clerk/nextjs\";\r\nimport { toast } from \"sonner\";\r\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { constants } from \"buffer\";\r\n\r\nexport default function AdminDashboard() {\r\n  const [activeTab, setActiveTab] = useState(\"organisations\");\r\n  const { user } = useUser();\r\n  // Data State\r\n  const [organisations, setOrganisations] = useState<any[]>([]);\r\n  const [enquiries, setEnquiries] = useState<any[]>([]);\r\n  const [platformConfigs, setPlatformConfigs] = useState<any[]>([]);\r\n  const [jobSettings, setJobSettings] = useState<any[]>([]);\r\n  const [logs, setLogs] = useState<any[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // Pagination & Filter State\r\n  const [pageNumber, setPageNumber] = useState(1);\r\n  const [pageSize, setPageSize] = useState(10);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState(\"all\"); // 'all', 'active', 'suspended'\r\n\r\n  // Enquiry Filter State\r\n  const [enquirySearch, setEnquirySearch] = useState(\"\");\r\n  const [dateFrom, setDateFrom] = useState(\"\");\r\n  const [dateTo, setDateTo] = useState(\"\");\r\n\r\n  // Add/Edit Org Form State\r\n  const [isAddingOrg, setIsAddingOrg] = useState(false);\r\n  const [isCreatingOrg, setIsCreatingOrg] = useState(false);\r\n  const [selectedPlatform, setSelectedPlatform] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    id: \"\",\r\n    name: \"\",\r\n    ownerName: \"\",\r\n    phone: \"\",\r\n    email: \"\",\r\n    taxNumber: \"\",\r\n    address: \"\",\r\n    postalCode: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    country: \"\",\r\n    platforms: [] as string[],\r\n    isFreeTrial: false\r\n  });\r\n\r\n  // Approval Modal State\r\n  const [approvalModalOpen, setApprovalModalOpen] = useState(false);\r\n  const [approvalData, setApprovalData] = useState({\r\n    orgId: \"\",\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    password: \"\"\r\n  });\r\n\r\n  // Fetch Data\r\n  const fetchOrganisations = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const params = new URLSearchParams({\r\n        pageNumber: pageNumber.toString(),\r\n        pageSize: pageSize.toString(),\r\n        searchText: searchText,\r\n      });\r\n\r\n      // Only add isDeleted filter if not 'all'\r\n      if (statusFilter === 'suspended') {\r\n        params.append('isDeleted', 'true');\r\n      } else if (statusFilter === 'active') {\r\n        params.append('isDeleted', 'false');\r\n      }\r\n      // For 'all', don't add isDeleted parameter to show both\r\n\r\n      const res = await fetch(`/api/admin/organisations?${params}`);\r\n      const data = await res.json();\r\n\r\n      if (data.isSuccess) {\r\n        setOrganisations(data.data.list);\r\n        setTotalCount(data.data.totalCount);\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Failed to fetch organisations\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchOtherData = async () => {\r\n    try {\r\n      const [enqRes, confRes, jobsRes, logsRes] = await Promise.all([\r\n        fetch('/api/admin/enquiries'),\r\n        fetch('/api/admin/platform-config'),\r\n        fetch('/api/admin/job-settings'),\r\n        fetch('/api/admin/logs')\r\n      ]);\r\n\r\n      if (enqRes.ok) {\r\n        const data = await enqRes.json();\r\n        setEnquiries(data.data || []);\r\n      } else {\r\n        const errorData = await enqRes.json();\r\n        toast.error(`Failed to fetch enquiries: ${errorData.message || 'Access denied'}`);\r\n      }\r\n\r\n      if (confRes.ok) setPlatformConfigs((await confRes.json()).data || []);\r\n      if (jobsRes.ok) setJobSettings((await jobsRes.json()).data || []);\r\n      if (logsRes.ok) setLogs((await logsRes.json()).data || []);\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch other data\", error);\r\n      toast.error(\"Failed to load admin data\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (activeTab === 'organisations') {\r\n      fetchOrganisations();\r\n    } else {\r\n      fetchOtherData();\r\n    }\r\n  }, [activeTab, pageNumber, pageSize, statusFilter]); // Search text handled separately with debounce ideally, or on enter\r\n\r\n  // Handle Search Enter\r\n  const handleSearch = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      setPageNumber(1);\r\n      fetchOrganisations();\r\n    }\r\n  };\r\n\r\n  // Filter enquiries based on search and date range\r\n  const filteredEnquiries = useMemo(() => {\r\n    return enquiries.filter(enq => {\r\n      // Search filter (name, email, organisation)\r\n      const searchLower = enquirySearch.toLowerCase();\r\n      const matchesSearch = !enquirySearch ||\r\n        (enq.name && enq.name.toLowerCase().includes(searchLower)) ||\r\n        (enq.organisationName && enq.organisationName.toLowerCase().includes(searchLower)) ||\r\n        (enq.email && enq.email.toLowerCase().includes(searchLower));\r\n\r\n      // Date range filter\r\n      const createdDate = new Date(enq.createdAt);\r\n      const fromDate = dateFrom ? new Date(dateFrom) : null;\r\n      const toDate = dateTo ? new Date(dateTo) : null;\r\n\r\n      // Set time to start/end of day for accurate comparison\r\n      if (fromDate) fromDate.setHours(0, 0, 0, 0);\r\n      if (toDate) toDate.setHours(23, 59, 59, 999);\r\n\r\n      const matchesDateFrom = !fromDate || createdDate >= fromDate;\r\n      const matchesDateTo = !toDate || createdDate <= toDate;\r\n\r\n      return matchesSearch && matchesDateFrom && matchesDateTo;\r\n    });\r\n  }, [enquiries, enquirySearch, dateFrom, dateTo]);\r\n\r\n  // Organisation Actions\r\n  const handleCreateOrg = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsCreatingOrg(true);\r\n    // Validation\r\n    if (!formData.name || !formData.ownerName || !formData.phone || !formData.email || !formData.taxNumber || !formData.address || !formData.postalCode || !formData.city || !formData.state || !formData.country) {\r\n      toast.error(\"Please fill in all required fields\");\r\n      setIsCreatingOrg(false);\r\n      return;\r\n    }\r\n\r\n    // Email validation\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(formData.email)) {\r\n      toast.error(\"Please enter a valid email address\");\r\n      setIsCreatingOrg(false);\r\n      return;\r\n    }\r\n\r\n    // Phone validation (simple check for now)\r\n    if (formData.phone.length < 10) {\r\n      toast.error(\"Please enter a valid phone number\");\r\n      setIsCreatingOrg(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const payload = {\r\n        ...formData,\r\n        organisationPlatform: formData.platforms, // Send as string array directly\r\n      };\r\n\r\n      const res = await fetch(\"/api/admin/organisations\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(formData.id ? \"Organisation updated\" : \"Organisation created successfully\");\r\n        setFormData({\r\n          id: \"\",\r\n          name: \"\",\r\n          ownerName: \"\",\r\n          phone: \"\",\r\n          email: \"\",\r\n          taxNumber: \"\",\r\n          address: \"\",\r\n          postalCode: \"\",\r\n          city: \"\",\r\n          state: \"\",\r\n          country: \"\",\r\n          platforms: [],\r\n          isFreeTrial: false\r\n        });\r\n        setIsAddingOrg(false);\r\n        fetchOrganisations();\r\n      } else {\r\n        throw new Error(data.message || \"Failed to save organisation\");\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.message);\r\n    } finally {\r\n      setIsCreatingOrg(false);\r\n    }\r\n  };\r\n\r\n  const handleEditOrg = (org: any) => {\r\n    let parsedPlatforms = [];\r\n    try {\r\n      if (org.platforms && typeof org.platforms === 'string') {\r\n        parsedPlatforms = JSON.parse(org.platforms);\r\n      } else if (Array.isArray(org.platforms)) {\r\n        parsedPlatforms = org.platforms;\r\n      }\r\n    } catch (e) {\r\n      console.error('Error parsing platforms:', e);\r\n      parsedPlatforms = [];\r\n    }\r\n\r\n    setFormData({\r\n      id: org.id,\r\n      name: org.name,\r\n      ownerName: org.ownerName || \"\",\r\n      phone: org.phone || \"\",\r\n      email: org.email || \"\",\r\n      taxNumber: org.taxNumber || \"\",\r\n      address: org.address || \"\",\r\n      postalCode: org.postalCode || \"\",\r\n      city: org.city || \"\",\r\n      state: org.state || \"\",\r\n      country: org.country || \"\",\r\n      platforms: parsedPlatforms,\r\n      isFreeTrial: org.plan === 'FREE_TRIAL'\r\n    });\r\n    setIsAddingOrg(true);\r\n  };\r\n\r\n  const handleApproveClick = (org: any) => {\r\n    // Check if user exists (in DB)\r\n    // The list API includes 'users', so we can check that array.\r\n    const hasUser = org.users && org.users.length > 0;\r\n\r\n    if (hasUser) {\r\n        // User exists, just approve directly\r\n        handleApproveOrg(org.id);\r\n        return;\r\n    }\r\n\r\n    // No user exists, show modal to create one\r\n    const nameParts = (org.ownerName || \"\").split(\" \");\r\n    const firstName = nameParts[0] || \"\";\r\n    const lastName = nameParts.slice(1).join(\" \") || \"\";\r\n    const email = org.email || \"\";\r\n    // Generate a simple username from email or name\r\n    const username = email.split('@')[0].replace(/[^a-zA-Z0-9]/g, \"\") || firstName.toLowerCase();\r\n\r\n    setApprovalData({\r\n      orgId: org.id,\r\n      firstName,\r\n      lastName,\r\n      username,\r\n      email,\r\n      password: \"\" \r\n    });\r\n    setApprovalModalOpen(true);\r\n  };\r\n\r\n  const submitApproval = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!approvalData.firstName || !approvalData.email || !approvalData.password) {\r\n        toast.error(\"Please fill in all required fields\");\r\n        return;\r\n    }\r\n\r\n    try {\r\n      toast.loading(\"Approving organisation and creating user...\");\r\n      const res = await fetch(`/api/admin/organisations/${approvalData.orgId}/approve`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n            firstName: approvalData.firstName,\r\n            lastName: approvalData.lastName,\r\n            username: approvalData.username,\r\n            email: approvalData.email,\r\n            password: approvalData.password\r\n        })\r\n      });\r\n      const data = await res.json();\r\n      \r\n      toast.dismiss(); // Dismiss loading toast\r\n\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(\"Organisation approved and user created successfully\");\r\n        setApprovalModalOpen(false);\r\n        fetchOrganisations();\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    } catch (e: any) {\r\n      toast.dismiss();\r\n      toast.error(e.message || \"Failed to approve organisation\");\r\n    }\r\n  };\r\n\r\n  const handleApproveOrg = async (id: string) => {\r\n    try {\r\n      const res = await fetch(`/api/admin/organisations/${id}/approve`, {\r\n        method: 'POST',\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(\"Organisation approved\");\r\n        fetchOrganisations();\r\n      } else throw new Error(data.message);\r\n    } catch (e: any) {\r\n      toast.error(e.message || \"Failed to approve organisation\");\r\n    }\r\n  };\r\n\r\n  const handleSuspendOrg = async (id: string) => {\r\n    try {\r\n      const res = await fetch(`/api/admin/organisations/${id}/suspend`, {\r\n        method: 'POST',\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(data.message);\r\n        fetchOrganisations();\r\n      } else throw new Error(data.message);\r\n    } catch (e: any) {\r\n      toast.error(e.message || \"Failed to update organisation status\");\r\n    }\r\n  };\r\n\r\n  const handleImpersonate = async (orgId: string) => {\r\n    if (!orgId) {\r\n      toast.error(\"Invalid organisation ID\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      toast.loading(\"Generating access token...\");\r\n\r\n      const res = await fetch(`/api/admin/organisations/${orgId}/impersonate`, {\r\n        method: 'POST',\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(\"Opening organisation dashboard...\");\r\n        // Set a cookie to track impersonation state\r\n        document.cookie = \"admin_impersonation=true; path=/; max-age=3600\";\r\n        // Open the sign-in URL in the same tab\r\n        window.location.href = data.data.signInUrl;\r\n      } else {\r\n        throw new Error(data.message || \"Failed to generate access token\");\r\n      }\r\n    } catch (e: any) {\r\n      toast.error(e.message || \"Failed to impersonate user\");\r\n    }\r\n  };\r\n\r\n  // ... (Other handlers: Enquiry, Config, Jobs, Notifications - kept same or simplified)\r\n  const handleApproveEnquiry = async (id: string) => { /* ... */ };\r\n  const handleUpdateConfig = async (key: string, value: string, platform: string) => {\r\n    try {\r\n      const res = await fetch('/api/admin/platform-config', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ key, value, platform })\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok && data.isSuccess) {\r\n        toast.success(\"Configuration updated\");\r\n        setPlatformConfigs(prev => {\r\n            const existing = prev.find(p => p.key === key);\r\n            if (existing) {\r\n                return prev.map(p => p.key === key ? { ...p, value } : p);\r\n            } else {\r\n                return [...prev, { key, value, platform }]; // Optimistic update might need more fields but this is fine for now\r\n            }\r\n        });\r\n      } else {\r\n        throw new Error(data.message);\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Failed to update configuration\");\r\n    }\r\n  };\r\n  const handleUpdateJob = async (jobName: string, frequency: string, isEnabled: boolean) => { /* ... */ };\r\n  const handleSendNotification = async (message: string) => { /* ... */ };\r\n\r\n  const togglePlatform = (platform: string) => {\r\n    setFormData(prev => {\r\n      const platforms = prev.platforms.includes(platform)\r\n        ? prev.platforms.filter(p => p !== platform)\r\n        : [...prev.platforms, platform];\r\n      return { ...prev, platforms };\r\n    });\r\n  };\r\n\r\n  const PlatformIcon = ({ name, icon: Icon, label }: { name: string, icon: any, label: string }) => (\r\n    <div\r\n      className={`flex flex-col items-center justify-center p-4 border rounded-lg cursor-pointer transition-all ${formData.platforms.includes(name) ? 'border-primary bg-primary/5' : 'hover:bg-muted'}`}\r\n      onClick={() => togglePlatform(name)}\r\n    >\r\n      <Icon className={`size-6 mb-2 ${formData.platforms.includes(name) ? 'text-primary' : 'text-muted-foreground'}`} />\r\n      <span className=\"text-xs\">{label}</span>\r\n      <div className={`w-4 h-4 rounded-full border mt-2 flex items-center justify-center ${formData.platforms.includes(name) ? 'border-primary' : 'border-muted-foreground'}`}>\r\n        {formData.platforms.includes(name) && <div className=\"w-2 h-2 rounded-full bg-primary\" />}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  async function handleConvertToOrg(enq: any): Promise<void> {\r\n    try {\r\n      toast.loading(\"Creating organisation and user account...\");\r\n\r\n      // Call the server-side API to handle all Clerk and database operations\r\n      const res = await fetch(\"/api/admin/convert-enquiry\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ enquiryId: enq.id }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.isSuccess) {\r\n        throw new Error(data.error || data.details || \"Failed to convert enquiry\");\r\n      }\r\n\r\n      // Update local state\r\n      setEnquiries(prev => prev.map(e =>\r\n        e.id === enq.id ? { ...e, isConverted: true } : e\r\n      ));\r\n\r\n      toast.success(\"Organisation created and user invited successfully!\");\r\n      fetchOrganisations(); // Refresh organisations list\r\n    } catch (error: any) {\r\n      console.error(\"Error converting enquiry to organisation:\", error);\r\n      toast.error(error.message || \"Failed to create organisation\");\r\n    }\r\n  }\r\n\r\n  const exportEnquiriesToCSV = () => {\r\n    if (enquiries.length === 0) {\r\n      toast.error(\"No enquiries to export\");\r\n      return;\r\n    }\r\n\r\n    // Define CSV headers\r\n    const headers = [\r\n      \"ID\",\r\n      \"Business Name\",\r\n      \"Name\",\r\n      \"Email\",\r\n      \"Phone\",\r\n      \"Mobile\",\r\n      \"Address\",\r\n      \"City\",\r\n      \"State\",\r\n      \"Country\",\r\n      \"Postal Code\",\r\n      \"Tax Number\",\r\n      \"Enquiry Text\",\r\n      \"Created Date\"\r\n    ];\r\n\r\n    // Convert enquiries to CSV rows\r\n    const csvRows = [\r\n      headers.join(\",\"), // Header row\r\n      ...enquiries.map(enq => [\r\n        enq.id,\r\n        `\"${(enq.organisationName || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.name || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${enq.email}\"`,\r\n        `\"${(enq.phone || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.mobile || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.address || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.city || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.state || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.country || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.postalCode || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.taxNumber || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${(enq.enquiryText || '').replace(/\"/g, '\"\"')}\"`,\r\n        `\"${new Date(enq.createdAt).toLocaleString()}\"`\r\n      ].join(\",\"))\r\n    ];\r\n\r\n    // Create CSV content\r\n    const csvContent = csvRows.join(\"\\n\");\r\n\r\n    // Create blob and download\r\n    const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    const url = URL.createObjectURL(blob);\r\n\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\"download\", `enquiries_${new Date().toISOString().split('T')[0]}.csv`);\r\n    link.style.visibility = \"hidden\";\r\n\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n\r\n    toast.success(`Exported ${enquiries.length} enquiries to CSV`);\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-screen w-full bg-muted/30 overflow-hidden\">\r\n      {/* Header - Full Width */}\r\n      <header className=\"h-16 border-b bg-background flex items-center justify-between px-6 shrink-0 z-20 relative\">\r\n        <div className=\"flex items-center gap-4\">\r\n          {/* Mobile Menu Trigger */}\r\n          <Sheet>\r\n            <SheetTrigger asChild>\r\n              <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden text-muted-foreground\">\r\n                <MoreVertical className=\"size-5\" />\r\n                <span className=\"sr-only\">Toggle Menu</span>\r\n              </Button>\r\n            </SheetTrigger>\r\n            <SheetContent side=\"left\" className=\"p-0 w-72 bg-[#0f172a] text-white border-r-slate-800\">\r\n              {/* Mobile Menu Content */}\r\n              <div className=\"p-6\">\r\n                <div className=\"flex items-center gap-2 font-bold text-xl tracking-wide text-white mb-8\">\r\n                  <div className=\"size-8 rounded-full bg-primary/20 flex items-center justify-center\">\r\n                    <Shield className=\"size-5 text-primary\" />\r\n                  </div>\r\n                  CampZeo\r\n                </div>\r\n                <div className=\"flex flex-col gap-1\">\r\n                  {['organisations', 'enquiry', 'platform', 'system', 'logs'].map((tab) => (\r\n                    <Button\r\n                      key={tab}\r\n                      variant=\"ghost\"\r\n                      className={`justify-start text-slate-400 hover:text-white hover:bg-slate-800 ${activeTab === tab ? 'bg-primary text-white' : ''}`}\r\n                      onClick={() => setActiveTab(tab)}\r\n                    >\r\n                      <span className=\"capitalize\">{tab}</span>\r\n                    </Button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </SheetContent>\r\n          </Sheet>\r\n\r\n          <div className=\"flex items-center gap-2 font-bold text-xl tracking-wide text-primary\">\r\n            <div className=\"size-8 rounded-full bg-primary/10 flex items-center justify-center\">\r\n              <Shield className=\"size-5 text-primary\" />\r\n            </div>\r\n            <span className=\"hidden md:inline-block\">CampZeo</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4 w-1/3 justify-end md:justify-between md:w-auto lg:w-1/3\">\r\n          {/* Global Search - Optional */}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"ghost\" size=\"icon\" className=\"text-muted-foreground hidden sm:flex\">\r\n            <Mail className=\"size-5\" />\r\n          </Button>\r\n          <div className=\"flex  items-center gap-3\">\r\n            <div className=\"text-right hidden  md:block\">\r\n              <p className=\"text-sm font-medium leading-none\">Admin User</p>\r\n              <p className=\"text-xs text-muted-foreground\">Administrator</p>\r\n            </div>\r\n\r\n            Hi, {user?.firstName || user?.username || \"User\"}  <UserButton afterSignOutUrl=\"/\" />\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Main Layout - Sidebar + Content */}\r\n      <Tabs value={activeTab} onValueChange={setActiveTab} orientation=\"vertical\" className=\"flex-1 flex flex-row overflow-hidden\">\r\n        {/* Sidebar - Desktop */}\r\n        <div className=\"hidden md:flex w-64 shrink-0 bg-[#0f172a] text-white flex-col border-r border-slate-800 overflow-y-auto\">\r\n          <div className=\"p-4 py-6\">\r\n            <div className=\"mb-6 px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider\">\r\n              Main Menu\r\n            </div>\r\n            <TabsList className=\"flex flex-col h-auto items-stretch bg-transparent p-0 gap-1 text-slate-400\">\r\n              <TabsTrigger value=\"organisations\" className=\"justify-start px-4 py-3 data-[state=active]:bg-primary data-[state=active]:text-white hover:bg-slate-800 hover:text-slate-200 transition-all rounded-md mx-2\">\r\n                <Users className=\"mr-3 size-4\" /> Organisation\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"enquiry\" className=\"justify-start px-4 py-3 data-[state=active]:bg-primary data-[state=active]:text-white hover:bg-slate-800 hover:text-slate-200 transition-all rounded-md mx-2\">\r\n                <MessageSquare className=\"mr-3 size-4\" /> Enquiry\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"platform\" className=\"justify-start px-4 py-3 data-[state=active]:bg-primary data-[state=active]:text-white hover:bg-slate-800 hover:text-slate-200 transition-all rounded-md mx-2\">\r\n                <Settings className=\"mr-3 size-4\" /> Platform Config\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"system\" className=\"justify-start px-4 py-3 data-[state=active]:bg-primary data-[state=active]:text-white hover:bg-slate-800 hover:text-slate-200 transition-all rounded-md mx-2\">\r\n                <MoreVertical className=\"mr-3 size-4\" /> Job Settings\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"logs\" className=\"justify-start px-4 py-3 data-[state=active]:bg-primary data-[state=active]:text-white hover:bg-slate-800 hover:text-slate-200 transition-all rounded-md mx-2\">\r\n                <CheckCircle className=\"mr-3 size-4\" /> Audit Logs\r\n              </TabsTrigger>\r\n            </TabsList>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content Area */}\r\n        <main className=\"flex-1 overflow-y-auto p-8 md:p-24\" style={{ paddingBlock: \"20px\" }}>\r\n          <div className=\"max-w-7xl mx-auto space-y-6\">\r\n\r\n            {/* 1. Organisation Management */}\r\n            <TabsContent value=\"organisations\" className=\"m-0 space-y-6 focus-visible:outline-none\" style={{ minHeight: \"calc(60vh)\" }}>\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">Organisations</h2>\r\n                  <p className=\"text-muted-foreground\">Manage and monitor all tenant organisations.</p>\r\n                </div>\r\n              </div>\r\n\r\n              <Card className=\"border shadow-sm bg-white\">\r\n                {isAddingOrg ? (\r\n                  <>\r\n                    <CardHeader className=\"border-b pb-4\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                          <CardTitle>{formData.id ? 'Edit Organisation' : 'Add Organisation'}</CardTitle>\r\n                          <CardDescription>Enter the details for the organisation.</CardDescription>\r\n                        </div>\r\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsAddingOrg(false)}>\r\n                          <ArrowLeft className=\"mr-2 size-4\" /> Back to List\r\n                        </Button>\r\n                      </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"pt-6\">\r\n                      <form onSubmit={handleCreateOrg} className=\" space-y-8\">\r\n                        <div className=\"  gap-4\">\r\n                          <div className=\"row flex space-y-4 \">\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"orgName\">Organisation Name*</Label>\r\n                            <Input id=\"orgName\"  className=\"w-1/2 border border-red-500 \"  value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})} required placeholder=\"e.g. Mobile team\" />\r\n                          </div>\r\n                          \r\n                          <div className=\"space-y-2\"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"ownerName\">Owner Name*</Label>\r\n                            <Input id=\"ownerName\"  className=\"w-1/2 border border-red-500 \"  value={formData.ownerName} onChange={(e) => setFormData({...formData, ownerName: e.target.value})} required placeholder=\"e.g. John Doe\" />\r\n                          </div>\r\n                          <div className=\"space-y-2\"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"phone\">Phone*</Label>\r\n                            <Input id=\"phone\"   className=\"w-1/2 border border-red-500 \" value={formData.phone} onChange={(e) => setFormData({...formData, phone: e.target.value})} required placeholder=\"e.g. 7807271261\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"email\">Email address*</Label>\r\n                            <Input id=\"email\"  className=\"w-1/2 border border-red-500 \"  type=\"email\" value={formData.email} onChange={(e) => setFormData({...formData, email: e.target.value})} required placeholder=\"e.g. contact@example.com\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"taxNumber\">Tax Number*</Label>\r\n                            <Input id=\"taxNumber\"  className=\"w-1/2 border border-red-500 \"  value={formData.taxNumber} onChange={(e) => setFormData({...formData, taxNumber: e.target.value})} required placeholder=\"e.g. TEMP123\" />\r\n                          </div>\r\n                          </div>\r\n\r\n                              <div className=\"row flex space-y-4\">\r\n                          \r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"address\">Address*</Label>\r\n                            <Input id=\"address\"  className=\"w-1/2 border border-red-500 \"  value={formData.address} onChange={(e) => setFormData({...formData, address: e.target.value})} required placeholder=\"e.g. Village Karehari\" />\r\n                          </div>\r\n                          \r\n                          \r\n                              <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"postalCode\">Postal Code*</Label>\r\n                            <Input id=\"postalCode\"  className=\"w-1/2 border border-red-500 \"  value={formData.postalCode} onChange={(e) => setFormData({...formData, postalCode: e.target.value})} required placeholder=\"e.g. 175021\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"city\">City*</Label>\r\n                            <Input id=\"city\"  className=\"w-1/2 border border-red-500 \"  value={formData.city} onChange={(e) => setFormData({...formData, city: e.target.value})} required placeholder=\"e.g. Mandi\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"state\">State*</Label>\r\n                            <Input id=\"state\"  className=\"w-1/2 border border-red-500 \"  value={formData.state} onChange={(e) => setFormData({...formData, state: e.target.value})} required placeholder=\"e.g. Himachal Pradesh\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 \"  style={{marginInline:\"10px\"}}>\r\n                            <Label htmlFor=\"country\">Country*</Label>\r\n                            <Input id=\"country\"  className=\"w-1/2 border border-red-500 \"  value={formData.country} onChange={(e) => setFormData({...formData, country: e.target.value})} required placeholder=\"e.g. India\" />\r\n                          </div>\r\n                          </div>\r\n                          <div className=\"flex items-center \">\r\n                            <Switch id=\"free-trial\" checked={formData.isFreeTrial} onCheckedChange={(checked) => setFormData({ ...formData, isFreeTrial: checked })} />\r\n                            <Label htmlFor=\"free-trial\">Free Trial?</Label>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-4\">\r\n                          <Label>Choose your Platforms</Label>\r\n                          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4\">\r\n                            <PlatformIcon name=\"email\" icon={Mail} label=\"Email\" />\r\n                            <PlatformIcon name=\"sms\" icon={Smartphone} label=\"SMS\" />\r\n                            <PlatformIcon name=\"whatsapp\" icon={MessageSquare} label=\"WhatsApp\" />\r\n                            <PlatformIcon name=\"facebook\" icon={Facebook} label=\"Facebook\" />\r\n                            <PlatformIcon name=\"instagram\" icon={Instagram} label=\"Instagram\" />\r\n                            <PlatformIcon name=\"linkedin\" icon={Linkedin} label=\"LinkedIn\" />\r\n                            <PlatformIcon name=\"youtube\" icon={Youtube} label=\"Youtube\" />\r\n                            <PlatformIcon name=\"pinterest\" icon={Settings} label=\"Pinterest\" />\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-4 pt-4 border-t\">\r\n                          <Button type=\"submit\" disabled={isCreatingOrg}>Submit</Button>\r\n                          <Button type=\"button\" variant=\"outline\" onClick={() => setIsAddingOrg(false)}>Cancel</Button>\r\n                        </div>\r\n                      </form>\r\n                    </CardContent>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <div className=\"p-4 border-b flex  items-center justify-between gap-4 bg-slate-50/50\">\r\n                      <div className=\"flex gap-2 w-1/2 md:w-auto \">\r\n                        <div className=\"relative w-1/2 border border-red-500 rounded-xl md:max-w-sm\">\r\n                          <Search className=\"absolute left-2 top-2.5 size-4 text-muted-foreground\" style={{ top: \"10px\" }} />\r\n                          <Input\r\n                            placeholder=\"Search organisations...\"\r\n                            className=\"pl-8 bg-white\"\r\n                            value={searchText}\r\n                            onChange={(e) => setSearchText(e.target.value)}\r\n                            onKeyDown={handleSearch}\r\n                          />\r\n                        </div>\r\n                        <div className=\"hidden sm:block\">\r\n                          <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                            <SelectTrigger className=\"w-[140px] bg-white\">\r\n                              <SelectValue placeholder=\"All Status\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"all\">All Status</SelectItem>\r\n                              <SelectItem value=\"active\">Active</SelectItem>\r\n                              <SelectItem value=\"suspended\">Suspended</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex  gap-2 w-1/2 md:w-auto justify-end\">\r\n                        <Button size=\"sm\" onClick={() => {\r\n                          setFormData({\r\n                            id: \"\",\r\n                            name: \"\",\r\n                            ownerName: \"\",\r\n                            phone: \"\",\r\n                            email: \"\",\r\n                            taxNumber: \"\",\r\n                            address: \"\",\r\n                            postalCode: \"\",\r\n                            city: \"\",\r\n                            state: \"\",\r\n                            country: \"\",\r\n                            platforms: [],\r\n                            isFreeTrial: false\r\n                          });\r\n                          setIsAddingOrg(true);\r\n                        }}>\r\n                          <Plus className=\"mr-2 size-4\" /> Add New\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                    <CardContent className=\"p-0\">\r\n                      <Table>\r\n                        <TableHeader className=\"bg-slate-50 \">\r\n                          <TableRow>\r\n                            <TableHead className=\"font-semibold text-slate-700\">Name</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700  md:table-cell\">Phone</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700  lg:table-cell\">Email</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700  xl:table-cell\">Address</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700\">Owner</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700\">Status</TableHead>\r\n                            <TableHead className=\"font-semibold text-slate-700\">Action</TableHead>\r\n                          </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                          {organisations.map((org) => (\r\n                            <TableRow key={org.id} className=\"hover:bg-slate-50/50\">\r\n                              <TableCell className=\"font-medium\">{org.name}</TableCell>\r\n                              <TableCell className=\" md:table-cell\">{org.phone || 'N/A'}</TableCell>\r\n                              <TableCell className=\" lg:table-cell\">{org.email || org.users?.[0]?.email || 'N/A'}</TableCell>\r\n                              <TableCell className=\"max-w-[200px] truncate  xl:table-cell\" title={org.address}>{org.address || 'N/A'}</TableCell>\r\n                              <TableCell>{org.ownerName || org.users?.[0]?.firstName || 'N/A'}</TableCell>\r\n                              <TableCell>\r\n                                <div className=\"flex gap-1\">\r\n                                  <Badge variant={org.isApproved ? 'default' : 'secondary'} className=\"rounded-md font-normal\">\r\n                                    {org.isApproved ? 'Approved' : 'Pending'}\r\n                                  </Badge>\r\n                                  {org.isDeleted && <Badge variant=\"destructive\" className=\"rounded-md font-normal\">Suspended</Badge>}\r\n                                </div>\r\n                              </TableCell>\r\n                              <TableCell className=\"text-right\">\r\n                                <div className=\"flex items-center justify-end gap-2 \">\r\n                                  {!org.isApproved && (\r\n                                    <Button style={{ color: \"darkgreen\", backgroundColor: \"lightgreen\" }} size=\"sm\" className=\"h-8 px-2 bg-green-600 hover:bg-green-700\" onClick={() => handleApproveClick(org)}>Approve</Button>\r\n                                  )}\r\n                                  <Button style={{ color: \"blue\", backgroundColor: \"lightblue\" }} size=\"sm\" className=\"h-8 px-2 bg-blue-600 hover:bg-blue-700\" onClick={() => handleImpersonate(org.id)}>Login</Button>\r\n                                  <Button style={{ color: \"indigo\", backgroundColor: \"lightindigo\" }} size=\"sm\" className=\"h-8 px-2 bg-indigo-500 hover:bg-indigo-600\" onClick={() => handleEditOrg(org)}>Edit</Button>\r\n                                  {org.isApproved && (\r\n                                    <Button size=\"sm\" variant={org.isDeleted ? \"outline\" : \"destructive\"} className=\"h-8 px-2\" onClick={() => handleSuspendOrg(org.id)}>\r\n                                      {org.isDeleted ? \"Recover\" : \"Suspend\"}\r\n                                    </Button>\r\n                                  )}\r\n                                </div>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          ))}\r\n                          {organisations.length === 0 && !isLoading && (\r\n                            <TableRow>\r\n                              <TableCell colSpan={7} className=\"h-24 text-center text-muted-foreground\">\r\n                                No organisations found.\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          )}\r\n                        </TableBody>\r\n                      </Table>\r\n\r\n\r\n              {/* Approval Modal */}\r\n              <Dialog open={approvalModalOpen} onOpenChange={setApprovalModalOpen}>\r\n                <DialogContent className=\"w-1/2\">\r\n                  <DialogHeader>\r\n                    <DialogTitle>Approve Organisation</DialogTitle>\r\n                    <DialogDescription>\r\n                      Create an admin user for this organisation to grant them access.\r\n                    </DialogDescription>\r\n                  </DialogHeader>\r\n                  <form onSubmit={submitApproval} className=\"space-y-4 py-4\">\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"firstName\">First Name</Label>\r\n                            <Input \r\n                                id=\"firstName\" \r\n                                value={approvalData.firstName} \r\n                                onChange={(e) => setApprovalData({...approvalData, firstName: e.target.value})}\r\n                                required \r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"lastName\">Last Name</Label>\r\n                            <Input \r\n                                id=\"lastName\" \r\n                                value={approvalData.lastName} \r\n                                onChange={(e) => setApprovalData({...approvalData, lastName: e.target.value})}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"username\">Username</Label>\r\n                        <Input \r\n                            id=\"username\" \r\n                            value={approvalData.username} \r\n                            onChange={(e) => setApprovalData({...approvalData, username: e.target.value})}\r\n                            required \r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"email\">Email</Label>\r\n                        <Input \r\n                            id=\"email\" \r\n                            type=\"email\"\r\n                            value={approvalData.email} \r\n                            onChange={(e) => setApprovalData({...approvalData, email: e.target.value})}\r\n                            required \r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"password\">Password</Label>\r\n                        <Input \r\n                            id=\"password\" \r\n                            type=\"text\" // Visible so admin can copy/see it\r\n                            value={approvalData.password} \r\n                            onChange={(e) => setApprovalData({...approvalData, password: e.target.value})}\r\n                            placeholder=\"Enter password\"\r\n                            required \r\n                        />\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                            Enter a secure password for the user.\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-end gap-3 pt-4\">\r\n                        <Button type=\"button\" variant=\"outline\" onClick={() => setApprovalModalOpen(false)}>Cancel</Button>\r\n                        <Button type=\"submit\">Approve & Create User</Button>\r\n                    </div>\r\n                  </form>\r\n                </DialogContent>\r\n              </Dialog>\r\n\r\n                      {/* Pagination Controls */}\r\n                      <div className=\"flex items-center justify-between px-4 py-4 border-t  space-y-6\">\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          Showing {organisations.length} of {totalCount} results\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPageNumber(p => Math.max(1, p - 1))}\r\n                            disabled={pageNumber === 1}\r\n                          >\r\n                            <ChevronLeft className=\"h-4 w-4\" />\r\n                            Previous\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => setPageNumber(p => p + 1)}\r\n                            disabled={organisations.length < pageSize} // Simple check, ideally check totalCount\r\n                          >\r\n                            Next\r\n                            <ChevronRight className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n\r\n                    </CardContent>\r\n                  </>\r\n                )}\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            {/* Other Tabs (Enquiry, Platform, System, Logs) - Simplified Placeholders or reusing existing logic */}\r\n            <TabsContent value=\"enquiry\" className=\"m-0 focus-visible:outline-none\">\r\n              <div className=\"mb-6 flex items-center justify-between\">\r\n                <div>\r\n                  <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">Enquiry Management</h2>\r\n                  <p className=\"text-muted-foreground\">Review and convert leads from sign-up enquiries.</p>\r\n                </div>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={exportEnquiriesToCSV}\r\n                  className=\"gap-2\"\r\n                >\r\n                  <Download className=\"size-4\" />\r\n                  Export to CSV\r\n                </Button>\r\n              </div>\r\n              <Card className=\"border shadow-sm\">\r\n                {/* Filter Section */}\r\n                <div className=\"p-4 border-b bg-slate-50/50\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                    <div className=\"md:col-span-2\">\r\n                      <Label htmlFor=\"enquiry-search\" className=\"text-sm font-medium mb-2 block\">\r\n                        Search by Name, Email, or Organisation\r\n                      </Label>\r\n                      <div className=\"relative\">\r\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground\" />\r\n                        <Input\r\n                          id=\"enquiry-search\"\r\n                          placeholder=\"Search enquiries...\"\r\n                          value={enquirySearch}\r\n                          onChange={(e) => setEnquirySearch(e.target.value)}\r\n                          className=\"pl-9\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <Label htmlFor=\"date-from\" className=\"text-sm font-medium mb-2 block\">\r\n                        From Date\r\n                      </Label>\r\n                      <Input\r\n                        id=\"date-from\"\r\n                        type=\"date\"\r\n                        value={dateFrom}\r\n                        onChange={(e) => setDateFrom(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <Label htmlFor=\"date-to\" className=\"text-sm font-medium mb-2 block\">\r\n                        To Date\r\n                      </Label>\r\n                      <Input\r\n                        id=\"date-to\"\r\n                        type=\"date\"\r\n                        value={dateTo}\r\n                        onChange={(e) => setDateTo(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  {(enquirySearch || dateFrom || dateTo) && (\r\n                    <div className=\"mt-3 flex items-center gap-2\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => {\r\n                          setEnquirySearch(\"\");\r\n                          setDateFrom(\"\");\r\n                          setDateTo(\"\");\r\n                        }}\r\n                        className=\"h-8 text-xs\"\r\n                      >\r\n                        Clear Filters\r\n                      </Button>\r\n                      <span className=\"text-xs text-muted-foreground\">\r\n                        Showing {filteredEnquiries.length} of {enquiries.length} enquiries\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <CardContent className=\"p-0\">\r\n                  <Table>\r\n                    <TableHeader className=\"bg-slate-50\">\r\n                      <TableRow>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Business Name</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Name</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Email</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Phone</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Enquiry</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Location</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Created</TableHead>\r\n                        <TableHead className=\"font-semibold text-slate-700\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {filteredEnquiries.length === 0 ? (\r\n                        <TableRow>\r\n                          <TableCell colSpan={8} className=\"h-24 text-center text-muted-foreground\">\r\n                            {enquiries.length === 0 ? \"No enquiries found.\" : \"No enquiries match your filters.\"}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ) : (\r\n                        filteredEnquiries.map((enq) => (\r\n                          <TableRow key={enq.id} className=\"hover:bg-slate-50/50\">\r\n                            <TableCell className=\"font-medium\">{enq.organisationName || 'N/A'}</TableCell>\r\n                            <TableCell>{enq.name || 'N/A'}</TableCell>\r\n                            <TableCell>{enq.email}</TableCell>\r\n                            <TableCell>{enq.phone || enq.mobile || 'N/A'}</TableCell>\r\n                            <TableCell>\r\n                              {enq.enquiryText ? (\r\n                                <Dialog>\r\n                                  <DialogTrigger asChild>\r\n                                    <Button variant=\"outline\" size=\"sm\" className=\"h-8 px-3 bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100 hover:text-blue-800 hover:border-blue-300\">\r\n                                      View Details\r\n                                    </Button>\r\n                                  </DialogTrigger>\r\n                                  <DialogContent className=\"max-w-2xl\">\r\n                                    <DialogHeader>\r\n                                      <DialogTitle>Enquiry Details</DialogTitle>\r\n                                      <DialogDescription>\r\n                                        From: {enq.name || enq.organisationName} ({enq.email})\r\n                                      </DialogDescription>\r\n                                    </DialogHeader>\r\n                                    <div className=\"mt-4 space-y-4\">\r\n                                      <div className=\"rounded-lg border p-4 bg-slate-50\">\r\n                                        <p className=\"text-sm text-slate-600 font-medium mb-2\">Enquiry Message:</p>\r\n                                        <p className=\"text-sm whitespace-pre-wrap\">{enq.enquiryText}</p>\r\n                                      </div>\r\n                                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                                        <div>\r\n                                          <p className=\"text-slate-600 font-medium\">Name:</p>\r\n                                          <p>{enq.name || 'N/A'}</p>\r\n                                        </div>\r\n                                        <div>\r\n                                          <p className=\"text-slate-600 font-medium\">Phone:</p>\r\n                                          <p>{enq.phone || enq.mobile || 'N/A'}</p>\r\n                                        </div>\r\n                                        <div>\r\n                                          <p className=\"text-slate-600 font-medium\">Location:</p>\r\n                                          <p>{enq.city}, {enq.state}, {enq.country}</p>\r\n                                        </div>\r\n                                        <div>\r\n                                          <p className=\"text-slate-600 font-medium\">Tax Number:</p>\r\n                                          <p>{enq.taxNumber || 'N/A'}</p>\r\n                                        </div>\r\n                                      </div>\r\n                                    </div>\r\n                                  </DialogContent>\r\n                                </Dialog>\r\n                              ) : (\r\n                                <span className=\"text-muted-foreground text-sm\">No message</span>\r\n                              )}\r\n                            </TableCell>\r\n                            <TableCell>\r\n                              {enq.city}, {enq.state}, {enq.country}\r\n                            </TableCell>\r\n                            <TableCell className=\"text-muted-foreground text-sm\">\r\n                              {new Date(enq.createdAt).toLocaleDateString()}\r\n                            </TableCell>\r\n                            <TableCell>\r\n                              {enq.isConverted ? (\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"outline\"\r\n                                  className=\"h-8 px-3 bg-green-50 text-green-700 border-green-200 cursor-not-allowed\"\r\n                                  disabled\r\n                                >\r\n                                  <CheckCircle className=\"mr-1 size-3\" />\r\n                                  Organisation Created\r\n                                </Button>\r\n                              ) : (\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"outline\"\r\n                                  className=\"h-8 px-2 hover:bg-primary/10\"\r\n                                  onClick={() => handleConvertToOrg(enq)}\r\n                                >\r\n                                  Create Organisation\r\n                                </Button>\r\n                              )}\r\n                            </TableCell>\r\n                          </TableRow>\r\n                        ))\r\n                      )}\r\n                    </TableBody>\r\n                  </Table>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n {/* 3. Platform Configuration */}\r\n {/* 3. Platform Configuration */}\r\n <TabsContent value=\"platform\" className=\"m-0 focus-visible:outline-none\">\r\n   <div className=\"mb-6\">\r\n     <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">Platform Configuration</h2>\r\n     <p className=\"text-muted-foreground\">Manage global API keys and secrets.</p>\r\n   </div>\r\n   <Card className=\"border shadow-sm\">\r\n     <CardContent className=\"p-6\">\r\n        {!selectedPlatform ? (\r\n            <div className=\"grid grid-cols-4 md:grid-cols-4 lg:grid-cols-4 gap-4\">\r\n                {[\r\n                  { name: \"Facebook\", platform: \"FACEBOOK\", icon: Facebook },\r\n                  { name: \"Instagram\", platform: \"INSTAGRAM\", icon: Instagram },\r\n                  { name: \"LinkedIn\", platform: \"LINKEDIN\", icon: Linkedin },\r\n                  { name: \"YouTube\", platform: \"YOUTUBE\", icon: Youtube },\r\n                  { name: \"Pinterest\", platform: \"PINTEREST\", icon: Settings },\r\n                  { name: \"WhatsApp\", platform: \"WHATSAPP\", icon: MessageSquare },\r\n                  { name: \"SMS\", platform: \"SMS\", icon: Smartphone },\r\n                  { name: \"Email\", platform: \"EMAIL\", icon: Mail }\r\n                ].map((p) => (\r\n                    <Button \r\n                        key={p.platform} \r\n                        variant=\"outline\" \r\n                        className=\"h-24 flex flex-col items-center justify-center gap-2 hover:border-primary hover:bg-primary/5\"\r\n                        onClick={() => setSelectedPlatform(p.platform)}\r\n                    >\r\n                        <p.icon className=\"size-8 text-muted-foreground\" />\r\n                        <span className=\"font-semibold\">{p.name}</span>\r\n                    </Button>\r\n                ))}\r\n            </div>\r\n        ) : (\r\n            <div className=\"space-y-6\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedPlatform(null)}>\r\n                        <ArrowLeft className=\"mr-2 size-4\" /> Back\r\n                    </Button>\r\n                    <h3 className=\"text-lg font-semibold\">\r\n                        {[\r\n                          { name: \"Facebook\", platform: \"FACEBOOK\" },\r\n                          { name: \"Instagram\", platform: \"INSTAGRAM\" },\r\n                          { name: \"LinkedIn\", platform: \"LINKEDIN\" },\r\n                          { name: \"YouTube\", platform: \"YOUTUBE\" },\r\n                          { name: \"Pinterest\", platform: \"PINTEREST\" },\r\n                          { name: \"WhatsApp\", platform: \"WHATSAPP\" },\r\n                          { name: \"SMS\", platform: \"SMS\" },\r\n                          { name: \"Email\", platform: \"EMAIL\" }\r\n                        ].find(p => p.platform === selectedPlatform)?.name}\r\n                    </h3>\r\n                </div>\r\n                \r\n                <div className=\"grid gap-6 max-w-2xl\">\r\n                    {[\r\n                      {\r\n                        platform: \"FACEBOOK\",\r\n                        keys: [\r\n                            { key: \"FACEBOOK_CLIENT_ID\", label: \"App ID\" },\r\n                            { key: \"FACEBOOK_CLIENT_SECRET\", label: \"App Secret\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"INSTAGRAM\",\r\n                        keys: [\r\n                            { key: \"INSTAGRAM_CLIENT_ID\", label: \"App ID\" },\r\n                            { key: \"INSTAGRAM_CLIENT_SECRET\", label: \"App Secret\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"LINKEDIN\",\r\n                        keys: [\r\n                            { key: \"LINKEDIN_CLIENT_ID\", label: \"Client ID\" },\r\n                            { key: \"LINKEDIN_CLIENT_SECRET\", label: \"Client Secret\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"YOUTUBE\",\r\n                        keys: [\r\n                            { key: \"YOUTUBE_CLIENT_ID\", label: \"Client ID\" },\r\n                            { key: \"YOUTUBE_CLIENT_SECRET\", label: \"Client Secret\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"PINTEREST\",\r\n                        keys: [\r\n                            { key: \"PINTEREST_CLIENT_ID\", label: \"App ID\" },\r\n                            { key: \"PINTEREST_CLIENT_SECRET\", label: \"Client Secret\" },\r\n                            { key: \"PINTEREST_AUTH_TOKEN\", label: \"Auth Token\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"WHATSAPP\",\r\n                        keys: [\r\n                            { key: \"WHATSAPP_ACCOUNT_SID\", label: \"Account SID\" },\r\n                            { key: \"WHATSAPP_AUTH_TOKEN\", label: \"Auth Token\" },\r\n                            { key: \"WHATSAPP_NUMBER\", label: \"WhatsApp Number\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"SMS\",\r\n                        keys: [\r\n                            { key: \"SMS_ACCOUNT_SID\", label: \"Account SID\" },\r\n                            { key: \"SMS_AUTH_TOKEN\", label: \"Auth Token\" },\r\n                            { key: \"SMS_NUMBER\", label: \"Twilio Number\" }\r\n                        ]\r\n                      },\r\n                      {\r\n                        platform: \"EMAIL\",\r\n                        keys: [\r\n                            { key: \"MAILGUN_API_KEY\", label: \"Mailgun API Key\" },\r\n                            { key: \"MAILGUN_DOMAIN\", label: \"Mailgun Domain\" },\r\n                            { key: \"MAILGUN_FROM_EMAIL\", label: \"From Email\" }\r\n                        ]\r\n                      },\r\n\r\n                    ].find(p => p.platform === selectedPlatform)?.keys.map((item) => {\r\n                        const config = platformConfigs.find(c => c.key === item.key);\r\n                        return (\r\n                            <div key={item.key} className=\"grid gap-2\">\r\n                                <Label htmlFor={`input-${item.key}`}>{item.label}</Label>\r\n                                <div className=\"relative\">\r\n                                    <SecretInput \r\n                                        defaultValue={config?.value || ''}\r\n                                        placeholder={`Enter ${item.label}`}\r\n                                      \r\n                                        id={`input-${item.key}`}\r\n                                        onBlur={(e) => handleUpdateConfig(item.key, e.target.value, selectedPlatform)}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n        )}\r\n     </CardContent>\r\n   </Card>\r\n </TabsContent>\r\n\r\n            {/* 4. System Administration */}\r\n            <TabsContent value=\"system\" className=\"m-0 space-y-4 focus-visible:outline-none\">\r\n              <div className=\"mb-6\">\r\n                <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">System Settings</h2>\r\n              </div>\r\n              <div className=\"grid gap-6 md:grid-cols-2\">\r\n                <Card className=\"border shadow-sm\">\r\n                  <CardHeader>\r\n                    <CardTitle>Job Settings</CardTitle>\r\n                    <CardDescription>Configure background jobs.</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-4\">\r\n                    {['POST_SCHEDULER', 'ANALYTICS_SYNC', 'BILLING_CYCLE'].map((job) => {\r\n                      const setting = jobSettings.find(j => j.jobName === job);\r\n                      return (\r\n                        <div key={job} className=\"flex items-center justify-between border-b pb-4 last:border-0\">\r\n                          <div>\r\n                            <p className=\"font-medium\">{job}</p>\r\n                            <p className=\"text-sm text-muted-foreground\">Frequency: {setting?.frequency || '5m'}</p>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Switch\r\n                              checked={setting?.isEnabled ?? true}\r\n                              onCheckedChange={(checked) => handleUpdateJob(job, setting?.frequency || '5m', checked)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card className=\"border shadow-sm\">\r\n                  <CardHeader>\r\n                    <CardTitle>Message Center</CardTitle>\r\n                    <CardDescription>Broadcast notifications to all tenants.</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-4\">\r\n                    <Textarea placeholder=\"Type your message here...\" id=\"broadcast-msg\" />\r\n                    <Button className=\"w-full\" onClick={() => {\r\n                      const msg = (document.getElementById('broadcast-msg') as HTMLTextAreaElement).value;\r\n                      handleSendNotification(msg);\r\n                    }}>\r\n                      <MessageSquare className=\"mr-2 size-4\" /> Send Broadcast\r\n                    </Button>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n\r\n            {/* 5. Logs */}\r\n            <TabsContent value=\"logs\" className=\"m-0 focus-visible:outline-none\">\r\n              <div className=\"mb-6\">\r\n                <h2 className=\"text-2xl font-bold tracking-tight text-slate-900\">Audit Logs</h2>\r\n              </div>\r\n              <Card className=\"border shadow-sm\">\r\n                <CardContent className=\"p-0\">\r\n                  <div className=\"max-h-[600px] overflow-y-auto\">\r\n                    <Table>\r\n                      <TableHeader className=\"bg-slate-50 sticky top-0\">\r\n                        <TableRow>\r\n                          <TableHead>Action</TableHead>\r\n                          <TableHead>Description</TableHead>\r\n                          <TableHead>User</TableHead>\r\n                          <TableHead>Tenant</TableHead>\r\n                          <TableHead>Date</TableHead>\r\n                        </TableRow>\r\n                      </TableHeader>\r\n                      <TableBody>\r\n                        {logs.map((log) => (\r\n                          <TableRow key={log.id}>\r\n                            <TableCell className=\"font-medium\">{log.action}</TableCell>\r\n                            <TableCell>{log.description}</TableCell>\r\n                            <TableCell>{log.user?.email || 'System'}</TableCell>\r\n                            <TableCell>{log.tenant?.name || 'System'}</TableCell>\r\n                            <TableCell className=\"text-muted-foreground\">\r\n                              {new Date(log.createdAt).toLocaleString()}\r\n                            </TableCell>\r\n                          </TableRow>\r\n                        ))}\r\n                      </TableBody>\r\n                    </Table>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n          </div>\r\n        </main>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\Organisation\\GetPlatforms\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\convert-enquiry\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\enquiries\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1300,1303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1300,1303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function PATCH(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ isSuccess: false, message: 'User not found in database' }, { status: 403 });\r\n        }\r\n\r\n        if (user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: `Access denied. Your role is: ${user.role}. Admin access required.` }, { status: 403 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { id } = await params;\r\n        const enquiryId = parseInt(id);\r\n\r\n        const updatedEnquiry = await prisma.enquiry.update({\r\n            where: { id: enquiryId },\r\n            data: {\r\n                isConverted: body.isConverted\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, data: updatedEnquiry });\r\n    } catch (error: any) {\r\n        console.error('Error updating enquiry:', error);\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\enquiries\\approve\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[951,954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[951,954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { enquiryId } = await request.json();\r\n\r\n        const updatedEnquiry = await prisma.enquiry.update({\r\n            where: { id: enquiryId },\r\n            data: { isConverted: true }\r\n        });\r\n\r\n\r\n\r\n        return NextResponse.json({ isSuccess: true, data: updatedEnquiry });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\enquiries\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":5,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1268,1271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1268,1271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n\r\n        console.log('Admin Enquiries Access Check:', {\r\n            userExists: !!user,\r\n            userRole: user?.role,\r\n            hasOrganisation: !!user?.organisationId,\r\n            organisationId: user?.organisationId\r\n        });\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ isSuccess: false, message: 'User not found in database' }, { status: 403 });\r\n        }\r\n\r\n        if (user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: `Access denied. Your role is: ${user.role}. Admin access required.` }, { status: 403 });\r\n        }\r\n\r\n        const enquiries = await prisma.enquiry.findMany({\r\n            orderBy: { createdAt: 'desc' }\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, data: enquiries });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\impersonate\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1295,1298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1295,1298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth, clerkClient } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { targetUserId } = await request.json();\r\n\r\n        const targetUser = await prisma.user.findUnique({ where: { id: targetUserId } });\r\n        if (!targetUser || !targetUser.clerkId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Target user not found' }, { status: 404 });\r\n        }\r\n\r\n        const client = await clerkClient();\r\n        const signInToken = await client.signInTokens.createSignInToken({\r\n            userId: targetUser.clerkId,\r\n            expiresInSeconds: 300,\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, data: { url: signInToken.url } });\r\n    } catch (error: any) {\r\n        console.error('Impersonate error:', error);\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\job-settings\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":5,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[790,793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[790,793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2057,2060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2057,2060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const settings = await prisma.jobSetting.findMany();\r\n        return NextResponse.json({ isSuccess: true, data: settings });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { jobId, cronExpression, isEnabled } = await request.json();\r\n\r\n        const existing = await prisma.jobSetting.findFirst({\r\n            where: { jobId }\r\n        });\r\n\r\n        let setting;\r\n        if (existing) {\r\n            setting = await prisma.jobSetting.update({\r\n                where: { id: existing.id },\r\n                data: { cronExpression, isEnabled }\r\n            });\r\n        } else {\r\n            setting = await prisma.jobSetting.create({\r\n                data: { jobId, cronExpression, isEnabled }\r\n            });\r\n        }\r\n\r\n        return NextResponse.json({ isSuccess: true, data: setting });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\logs\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":5,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[864,867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[864,867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const logs = await prisma.logEvents.findMany({\r\n            orderBy: { timeStamp: 'desc' },\r\n            take: 100,\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, data: logs });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\notifications\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[992,995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[992,995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { message } = await request.json();\r\n\r\n        await prisma.notification.create({\r\n            data: {\r\n                message,\r\n                type: 'SYSTEM_BROADCAST',\r\n                isRead: false,\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, message: 'Notification sent' });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\[id]\\approve\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":114,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4659,4662],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4659,4662],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5082,5085],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5082,5085],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { generatePassword, sendOrganisationInvite } from \"@/lib/email\";\r\nimport { createClerkUser } from \"@/lib/clerk-admin\";\r\n\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n       const { id } = await params;\r\n        const organisationId = parseInt(id);\r\n\r\n        if (isNaN(organisationId)) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Invalid organisation ID' }, { status: 400 });\r\n        }\r\n\r\n        const body = await request.json().catch(() => ({}));\r\n        const { firstName, lastName, username, email: bodyEmail, password: bodyPassword } = body;\r\n\r\n        const organisation = await prisma.organisation.findUnique({\r\n            where: { id: organisationId },\r\n        });\r\n\r\n        if (!organisation) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const isApproved = organisation.isApproved;\r\n\r\n        let updatedOrganisation;\r\n        let message;\r\n\r\n        if (isApproved) {\r\n            updatedOrganisation = await prisma.organisation.update({\r\n                where: { id: organisationId },\r\n                data: {\r\n                    isDeleted: false,\r\n                    isApproved: true\r\n                },\r\n            });\r\n            message = `Organisation ${organisation.name} has been recovered`;\r\n        } else {\r\n            updatedOrganisation = await prisma.organisation.update({\r\n                where: { id: organisationId },\r\n                data: {\r\n                    isDeleted: false,\r\n                    isApproved: true\r\n                },\r\n            });\r\n            message = `Organisation ${organisation.name} has been approved`;\r\n\r\n            const existingUser = await prisma.user.findFirst({\r\n                where: { organisationId: organisationId }\r\n            });\r\n\r\n            if (!existingUser) {\r\n                const password = bodyPassword || generatePassword();\r\n                const email = bodyEmail || organisation.email;\r\n\r\n                if (!email) {\r\n                    console.error(\"No email found for organisation, cannot create user\");\r\n                } else {\r\n                    try {\r\n                        let finalFirstName = firstName;\r\n                        let finalLastName = lastName;\r\n\r\n                        if (!finalFirstName) {\r\n                            const nameParts = (organisation.ownerName || \"\").split(\" \");\r\n                            finalFirstName = nameParts[0] || \"Admin\";\r\n                            finalLastName = nameParts.slice(1).join(\" \") || \"\";\r\n                        }\r\n\r\n                        const clerkUser = await createClerkUser({\r\n                            email,\r\n                            password,\r\n                            firstName: finalFirstName,\r\n                            lastName: finalLastName,\r\n                            username: username // Optional\r\n                        });\r\n\r\n                        await prisma.user.create({\r\n                            data: {\r\n                                clerkId: clerkUser.id,\r\n                                email: email,\r\n                                firstName: finalFirstName,\r\n                                lastName: finalLastName,\r\n                                role: \"ORGANISATION_USER\",\r\n                                organisationId: organisationId,\r\n                                isApproved: true,\r\n                                isFirstLogin: true\r\n                            }\r\n                        });\r\n\r\n                        await sendOrganisationInvite({\r\n                            email,\r\n                            password,\r\n                            organisationName: organisation.name,\r\n                            ownerName: `${finalFirstName} ${finalLastName}`.trim() || \"User\"\r\n                        });\r\n\r\n                        message += \". User account created and invitation sent.\";\r\n                    } catch (err: any) {\r\n                        console.error(\"Failed to create user/send invite:\", err);\r\n                        message += \". Warning: Failed to create user account (\" + err.message + \")\";\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({\r\n            isSuccess: true,\r\n            message,\r\n            data: updatedOrganisation\r\n        });\r\n    } catch (error: any) {\r\n        console.error('Suspend/Recover error:', error);\r\n        return NextResponse.json({\r\n            isSuccess: false,\r\n            message: error.message || 'Failed to update organisation status'\r\n        }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\[id]\\impersonate\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1719,1722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1719,1722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth, clerkClient } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        // In Next.js 15, params is a Promise\r\n        const { id } = await params;\r\n\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const targetUser = await prisma.user.findFirst({\r\n            where: {\r\n                organisationId: parseInt(id),\r\n            },\r\n        });\r\n\r\n        if (!targetUser || !targetUser.clerkId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'No user found for this organisation to impersonate' }, { status: 404 });\r\n        }\r\n\r\n        const client = await clerkClient();\r\n        const signInToken = await client.signInTokens.createSignInToken({\r\n            userId: targetUser.clerkId,\r\n            expiresInSeconds: 300,\r\n        });\r\n\r\n        const baseUrl = process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000';\r\n        const redirectUrl = `${baseUrl}/organisation`;\r\n\r\n        const url = new URL(signInToken.url);\r\n        url.searchParams.append('redirect_url', redirectUrl);\r\n\r\n        return NextResponse.json({ isSuccess: true, data: { signInUrl: url.toString() } });\r\n    } catch (error: any) {\r\n        console.error('Impersonate error:', error);\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isFreeTrial' is assigned a value but never used.","line":72,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3028,3031],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3028,3031],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { currentUser, clerkClient } from \"@clerk/nextjs/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport async function GET(\r\n    req: Request,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        const dbUser = await prisma.user.findUnique({ where: { clerkId: user?.id } });\r\n\r\n        if (!user || dbUser?.role !== \"ADMIN_USER\") {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const { id } = await params;\r\n\r\n        const organisation = await prisma.organisation.findUnique({\r\n            where: { id: parseInt(id) },\r\n            include: {\r\n                users: true,\r\n            },\r\n        });\r\n\r\n        if (!organisation) {\r\n            return NextResponse.json({ isSuccess: false, message: \"Organisation not found\" }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json({\r\n            data: organisation,\r\n            isSuccess: true,\r\n            message: null,\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error fetching organisation:\", error);\r\n        return NextResponse.json(\r\n            { isSuccess: false, message: \"Internal server error\", error: error instanceof Error ? error.message : \"Unknown error\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\nexport async function PUT(\r\n    req: Request,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        const dbUser = await prisma.user.findUnique({ where: { clerkId: user?.id } });\r\n\r\n        if (!user || dbUser?.role !== \"ADMIN_USER\") {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const { id } = await params;\r\n        const body = await req.json();\r\n        const {\r\n            name,\r\n            ownerName,\r\n            phone,\r\n            email,\r\n            address,\r\n            city,\r\n            state,\r\n            country,\r\n            postalCode,\r\n            enquiryText,\r\n            taxNumber,\r\n            platforms,\r\n            isFreeTrial,\r\n        } = body;\r\n\r\n        const updatedOrganisation = await prisma.organisation.update({\r\n            where: { id: parseInt(id) },\r\n            data: {\r\n                name,\r\n                phone,\r\n                email,\r\n                address,\r\n                city,\r\n                state,\r\n                country,\r\n                postalCode,\r\n                enquiryText,\r\n                taxNumber,\r\n            },\r\n        });\r\n\r\n        if (platforms && Array.isArray(platforms)) {\r\n            await prisma.organisationPlatform.deleteMany({\r\n                where: { organisationId: parseInt(id) }\r\n            });\r\n            await prisma.organisationPlatform.createMany({\r\n                data: platforms.map((platform: string) => ({\r\n                    organisationId: parseInt(id),\r\n                    platform: platform as any\r\n                }))\r\n            });\r\n        }\r\n\r\n        if (ownerName) {\r\n            const orgUser = await prisma.user.findFirst({\r\n                where: { organisationId: parseInt(id) },\r\n            });\r\n\r\n            if (orgUser) {\r\n                const firstName = ownerName.split(' ')[0];\r\n                const lastName = ownerName.split(' ').slice(1).join(' ');\r\n\r\n                await prisma.user.update({\r\n                    where: { id: orgUser.id },\r\n                    data: {\r\n                        firstName: firstName || null,\r\n                        lastName: lastName || null,\r\n                    },\r\n                });\r\n\r\n                try {\r\n                    const client = await clerkClient();\r\n                    await client.users.updateUser(orgUser.clerkId, {\r\n                        firstName: firstName || undefined,\r\n                        lastName: lastName || undefined,\r\n                    });\r\n                } catch (clerkError) {\r\n                    console.error(\"Error updating Clerk user:\", clerkError);\r\n                }\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({\r\n            data: updatedOrganisation,\r\n            isSuccess: true,\r\n            message: \"Organisation updated successfully.\",\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error updating organisation:\", error);\r\n        return NextResponse.json(\r\n            { isSuccess: false, message: \"Internal server error\", error: error instanceof Error ? error.message : \"Unknown error\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\[id]\\suspend\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2506,2509],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2506,2509],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        // In Next.js 15, params is a Promise\r\n        const { id } = await params;\r\n        const organisationId = parseInt(id);\r\n\r\n        if (isNaN(organisationId)) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Invalid organisation ID' }, { status: 400 });\r\n        }\r\n\r\n        // Get current organisation\r\n        const organisation = await prisma.organisation.findUnique({\r\n            where: { id: organisationId },\r\n        });\r\n\r\n        if (!organisation) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        // Determine action based on current status\r\n        const isSuspended = organisation.isDeleted;\r\n\r\n        let updatedOrganisation;\r\n        let message;\r\n\r\n        if (isSuspended) {\r\n            // RECOVER: Set isDeleted: false, isApproved: true\r\n            updatedOrganisation = await prisma.organisation.update({\r\n                where: { id: organisationId },\r\n                data: {\r\n                    isDeleted: false,\r\n                    isApproved: true\r\n                },\r\n            });\r\n            message = `Organisation ${organisation.name} has been recovered`;\r\n        } else {\r\n            // SUSPEND: Set isDeleted: true, isApproved: false\r\n            updatedOrganisation = await prisma.organisation.update({\r\n                where: { id: organisationId },\r\n                data: {\r\n                    isDeleted: true,\r\n                    isApproved: false\r\n                },\r\n            });\r\n            message = `Organisation ${organisation.name} has been suspended`;\r\n        }\r\n\r\n        return NextResponse.json({\r\n            isSuccess: true,\r\n            message,\r\n            data: updatedOrganisation\r\n        });\r\n    } catch (error: any) {\r\n        console.error('Suspend/Recover error:', error);\r\n        return NextResponse.json({\r\n            isSuccess: false,\r\n            message: error.message || 'Failed to update organisation status'\r\n        }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NextRequest' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'generatePassword' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sendOrganisationInvite' is defined but never used.","line":4,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'createClerkUser' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'sendSms' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1499,1502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1499,1502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":218,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8263,8266],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8263,8266],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { currentUser } from \"@clerk/nextjs/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { generatePassword, sendOrganisationInvite } from \"@/lib/email\";\r\nimport { createClerkUser } from \"@/lib/clerk-admin\";\r\nimport { sendSms } from \"@/lib/twilio\";\r\nimport { PlatformType } from \"@prisma/client\";\r\n\r\n// GET: List Organisations with Pagination, Search, Sorting\r\nexport async function GET(req: Request) {\r\n    try {\r\n        const user = await currentUser();\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({ where: { clerkId: user.id } });\r\n\r\n        if (dbUser?.role !== \"ADMIN_USER\") {\r\n            return NextResponse.json({ error: \"Forbidden\" }, { status: 403 });\r\n        }\r\n\r\n        const { searchParams } = new URL(req.url);\r\n        const pageSize = parseInt(searchParams.get(\"pageSize\") || \"10\");\r\n        const pageNumber = parseInt(searchParams.get(\"pageNumber\") || \"1\");\r\n        const searchText = searchParams.get(\"searchText\") || \"\";\r\n        const isDeletedParam = searchParams.get(\"isDeleted\");\r\n        const sortBy = searchParams.get(\"sortBy\") || \"createdAt\";\r\n        const sortDesc = searchParams.get(\"sortDesc\") === \"true\";\r\n\r\n        const skip = (pageNumber - 1) * pageSize;\r\n        const take = pageSize === 0 ? undefined : pageSize; // 0 means all\r\n\r\n        const whereClause: any = {};\r\n\r\n        // Only add isDeleted filter if parameter is provided\r\n        if (isDeletedParam !== null) {\r\n            whereClause.isDeleted = isDeletedParam === \"true\";\r\n        }\r\n\r\n        if (searchText) {\r\n            whereClause.OR = [\r\n                { name: { contains: searchText, mode: \"insensitive\" } },\r\n                // Search in related Users for email and name\r\n                { users: { some: { email: { contains: searchText, mode: \"insensitive\" } } } },\r\n                { users: { some: { firstName: { contains: searchText, mode: \"insensitive\" } } } },\r\n                { users: { some: { lastName: { contains: searchText, mode: \"insensitive\" } } } },\r\n            ];\r\n        }\r\n\r\n        const [organisations, totalCount] = await Promise.all([\r\n            prisma.organisation.findMany({\r\n                where: whereClause,\r\n                skip,\r\n                take,\r\n                orderBy: {\r\n                    [sortBy]: sortDesc ? \"desc\" : \"asc\",\r\n                },\r\n                include: {\r\n                    users: true, // Include users to show owner details if needed\r\n                    organisationPlatforms: true,\r\n                },\r\n            }),\r\n            prisma.organisation.count({ where: whereClause }),\r\n        ]);\r\n\r\n        const list = organisations.map(org => ({\r\n            ...org,\r\n            platforms: org.organisationPlatforms.map(op => op.platform.toLowerCase())\r\n        }));\r\n\r\n        return NextResponse.json({\r\n            data: {\r\n                list,\r\n                totalCount,\r\n            },\r\n            isSuccess: true,\r\n            message: null,\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error fetching organisations:\", error);\r\n        return NextResponse.json(\r\n            { isSuccess: false, message: \"Internal server error\", error: error instanceof Error ? error.message : \"Unknown error\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\n// POST: Create or Update Organisation\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const user = await currentUser();\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({ where: { clerkId: user.id } });\r\n\r\n        if (dbUser?.role !== \"ADMIN_USER\") {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const body = await req.json();\r\n        const {\r\n            id, // If ID is present, it's an update\r\n            name,\r\n            ownerName,\r\n            phone,\r\n            email,\r\n            address,\r\n            city,\r\n            state,\r\n            country,\r\n            postalCode,\r\n            enquiryText,\r\n            taxNumber,\r\n            organisationPlatform, // Assuming this maps to 'platforms' JSON or separate table\r\n            isFreeTrial,\r\n        } = body;\r\n\r\n        if (!name || !email) {\r\n            return NextResponse.json({ isSuccess: false, message: \"Name and Email are required\" }, { status: 400 });\r\n        }\r\n\r\n        let organisation;\r\n\r\n        if (id && id !== 0 && id !== \"0\") {\r\n            // UPDATE\r\n            await prisma.$transaction(async (tx) => {\r\n                await tx.organisation.update({\r\n                    where: { id: Number(id) },\r\n                    data: {\r\n                        name,\r\n                        phone,\r\n                        email,\r\n                        address,\r\n                        city,\r\n                        state,\r\n                        country,\r\n                        postalCode,\r\n                        enquiryText: enquiryText,\r\n                        taxNumber,\r\n                    },\r\n                });\r\n\r\n                if (organisationPlatform) {\r\n                    await tx.organisationPlatform.deleteMany({\r\n                        where: { organisationId: Number(id) }\r\n                    });\r\n\r\n                    if (organisationPlatform.length > 0) {\r\n                        const validPlatforms = organisationPlatform\r\n                            .map((p: string) => p.toUpperCase())\r\n                            .filter((p: string) => Object.values(PlatformType).includes(p as PlatformType));\r\n\r\n                        if (validPlatforms.length > 0) {\r\n                            await tx.organisationPlatform.createMany({\r\n                                data: validPlatforms.map((p: string) => ({\r\n                                    organisationId: Number(id),\r\n                                    platform: p as PlatformType\r\n                                }))\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            organisation = await prisma.organisation.findUnique({\r\n                where: { id: Number(id) },\r\n                include: { organisationPlatforms: true, users: true }\r\n            });\r\n        } else {\r\n            // CREATE\r\n            const trialStartDate = isFreeTrial ? new Date() : null;\r\n            const trialEndDate = isFreeTrial ? new Date(Date.now() + 14 * 24 * 60 * 60 * 1000) : null;\r\n\r\n            const validPlatforms = organisationPlatform\r\n                ? organisationPlatform\r\n                    .map((p: string) => p.toUpperCase())\r\n                    .filter((p: string) => Object.values(PlatformType).includes(p as PlatformType))\r\n                : [];\r\n\r\n            organisation = await prisma.organisation.create({\r\n                data: {\r\n                    name,\r\n                    phone,\r\n                    email,\r\n                    address,\r\n                    city,\r\n                    state,\r\n                    country,\r\n                    postalCode,\r\n                    enquiryText: enquiryText,\r\n                    taxNumber,\r\n                    isTrial: isFreeTrial,\r\n                    trialStartDate,\r\n                    trialEndDate,\r\n                    isApproved: false, // Requires admin approval\r\n                    ownerName,\r\n                    organisationPlatforms: {\r\n                        create: validPlatforms.map((p: string) => ({\r\n                            platform: p as PlatformType\r\n                        }))\r\n                    }\r\n                },\r\n                include: { organisationPlatforms: true, users: true }\r\n            });\r\n\r\n            console.log(` Organisation created: ${organisation.name} (ID: ${organisation.id})`);\r\n            console.log(` Awaiting approval to create user account and send invitation`);\r\n        }\r\n\r\n        const responseOrg = {\r\n            ...organisation,\r\n            platforms: organisation?.organisationPlatforms.map((op: any) => op.platform.toLowerCase()) || []\r\n        };\r\n\r\n        return NextResponse.json({\r\n            data: {\r\n                list: [responseOrg],\r\n                totalCount: 1\r\n            },\r\n            isSuccess: true,\r\n            message: id ? \"Organisation updated successfully.\" : \"Organisation created successfully. Approve to send invitation.\",\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error saving organisation:\", error);\r\n        return NextResponse.json(\r\n            { isSuccess: false, message: \"Internal server error\", error: error instanceof Error ? error.message : \"Unknown error\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\organisations\\suspend\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'status' is assigned a value but never used.","line":17,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1638,1641],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1638,1641],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER' || user.organisationId) {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { organisationId, action } = await request.json();\r\n\r\n        const status = action === 'SUSPEND' ? 'CANCELED' : 'ACTIVE'; \r\n\r\n        const updatedOrganisation = await prisma.organisation.update({\r\n            where: { id: parseInt(organisationId) },\r\n            data: { isDeleted: action === 'SUSPEND' }\r\n        });\r\n\r\n        await prisma.logEvents.create({\r\n            data: {\r\n                message: `Organisation ${updatedOrganisation.name} ${action.toLowerCase()}ed by ${user.email}`,\r\n                level: 'Info',\r\n                timeStamp: new Date(),\r\n                properties: JSON.stringify({\r\n                    action: `${action}_ORGANISATION`,\r\n                    organisationId: updatedOrganisation.id,\r\n                    userId: user.id,\r\n                })\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({ isSuccess: true, data: updatedOrganisation, message: `Organisation ${action.toLowerCase()}ed successfully` });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\platform-config\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":5,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[781,784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[781,784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2703,2706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2703,2706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const configs = await prisma.adminPlatformConfiguration.findMany();\r\n        return NextResponse.json({ isSuccess: true, data: configs });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) return NextResponse.json({ isSuccess: false, message: 'Unauthorized' }, { status: 401 });\r\n\r\n        const user = await prisma.user.findUnique({ where: { clerkId: userId } });\r\n        if (!user || user.role !== 'ADMIN_USER') {\r\n            return NextResponse.json({ isSuccess: false, message: 'Forbidden' }, { status: 403 });\r\n        }\r\n\r\n        const { key, value, platform } = await request.json();\r\n\r\n        // We need to handle the upsert logic carefully since 'key' is not unique in the schema\r\n        // The schema has: id (PK), key, value, platform\r\n        // We probably want to find by key AND platform, or just key if key is unique enough.\r\n        // Looking at schema: key String?, value String?, platform PlatformType\r\n        // No unique constraint on key.\r\n        // But usually config is key-value.\r\n        // Let's assume for now we want to update if exists by key, or create.\r\n        // Since there is no unique constraint, upsert won't work with 'key' alone if it's not @unique.\r\n        // We should check if it exists first.\r\n\r\n        const existingConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key }\r\n        });\r\n\r\n        let config;\r\n        if (existingConfig) {\r\n            config = await prisma.adminPlatformConfiguration.update({\r\n                where: { id: existingConfig.id },\r\n                data: { value, platform }\r\n            });\r\n        } else {\r\n            config = await prisma.adminPlatformConfiguration.create({\r\n                data: { key, value, platform }\r\n            });\r\n        }\r\n\r\n        return NextResponse.json({ isSuccess: true, data: config });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ isSuccess: false, message: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\seed\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\admin\\users\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\campaigns\\[id]\\posts\\[postId]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3931,3934],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3931,3934],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\n\r\n// GET - Fetch a single post\r\nexport async function GET(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string; postId: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const { id, postId } = await params;\r\n        const campaignId = parseInt(id);\r\n        const postIdNum = parseInt(postId);\r\n\r\n        // Verify campaign belongs to organisation\r\n        const campaign = await prisma.campaign.findFirst({\r\n            where: {\r\n                id: campaignId,\r\n                organisationId: dbUser.organisationId,\r\n                isDeleted: false,\r\n            },\r\n        });\r\n\r\n        if (!campaign) {\r\n            return NextResponse.json({ error: 'Campaign not found' }, { status: 404 });\r\n        }\r\n\r\n        // Fetch post\r\n        const post = await prisma.campaignPost.findFirst({\r\n            where: {\r\n                id: postIdNum,\r\n                campaignId,\r\n            },\r\n        });\r\n\r\n        if (!post) {\r\n            return NextResponse.json({ error: 'Post not found' }, { status: 404 });\r\n        }\r\n\r\n        return NextResponse.json({ post });\r\n    } catch (error) {\r\n        console.error('Error fetching post:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch post' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// PUT - Update a post\r\nexport async function PUT(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string; postId: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const { id, postId } = await params;\r\n        const campaignId = parseInt(id);\r\n        const postIdNum = parseInt(postId);\r\n\r\n        // Verify campaign belongs to organisation\r\n        const campaign = await prisma.campaign.findFirst({\r\n            where: {\r\n                id: campaignId,\r\n                organisationId: dbUser.organisationId,\r\n                isDeleted: false,\r\n            },\r\n        });\r\n\r\n        if (!campaign) {\r\n            return NextResponse.json({ error: 'Campaign not found' }, { status: 404 });\r\n        }\r\n\r\n        // Check if post exists\r\n        const existingPost = await prisma.campaignPost.findFirst({\r\n            where: {\r\n                id: postIdNum,\r\n                campaignId,\r\n            },\r\n        });\r\n\r\n        if (!existingPost) {\r\n            return NextResponse.json({ error: 'Post not found' }, { status: 404 });\r\n        }\r\n\r\n        // Don't allow editing sent posts\r\n        if (existingPost.isPostSent) {\r\n            return NextResponse.json({ error: 'Cannot edit a sent post' }, { status: 400 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { subject, message, type, scheduledPostTime, senderEmail, videoUrl, pinterestBoardId, pinterestLink } = body;\r\n\r\n        // Construct metadata\r\n        let metadata: any = existingPost.metadata || {};\r\n\r\n        if (type === 'PINTEREST') {\r\n            metadata = {\r\n                ...metadata,\r\n                boardId: pinterestBoardId,\r\n                link: pinterestLink\r\n            };\r\n        }\r\n\r\n        // Update post\r\n        const post = await prisma.campaignPost.update({\r\n            where: { id: postIdNum },\r\n            data: {\r\n                subject,\r\n                message,\r\n                type,\r\n                senderEmail,\r\n                scheduledPostTime: scheduledPostTime ? new Date(scheduledPostTime) : null,\r\n                videoUrl: videoUrl || null,\r\n                metadata: metadata,\r\n            },\r\n        });\r\n\r\n        return NextResponse.json({ post });\r\n    } catch (error) {\r\n        console.error('Error updating post:', error);\r\n        return NextResponse.json({ error: 'Failed to update post' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// DELETE - Delete a post\r\nexport async function DELETE(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string; postId: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const { id, postId } = await params;\r\n        const campaignId = parseInt(id);\r\n        const postIdNum = parseInt(postId);\r\n\r\n        // Verify campaign belongs to organisation\r\n        const campaign = await prisma.campaign.findFirst({\r\n            where: {\r\n                id: campaignId,\r\n                organisationId: dbUser.organisationId,\r\n                isDeleted: false,\r\n            },\r\n        });\r\n\r\n        if (!campaign) {\r\n            return NextResponse.json({ error: 'Campaign not found' }, { status: 404 });\r\n        }\r\n\r\n        // Check if post exists\r\n        const existingPost = await prisma.campaignPost.findFirst({\r\n            where: {\r\n                id: postIdNum,\r\n                campaignId,\r\n            },\r\n        });\r\n\r\n        if (!existingPost) {\r\n            return NextResponse.json({ error: 'Post not found' }, { status: 404 });\r\n        }\r\n\r\n        // Don't allow deleting sent posts\r\n        if (existingPost.isPostSent) {\r\n            return NextResponse.json({ error: 'Cannot delete a sent post' }, { status: 400 });\r\n        }\r\n\r\n        // Delete post\r\n        await prisma.campaignPost.delete({\r\n            where: { id: postIdNum },\r\n        });\r\n\r\n        return NextResponse.json({ message: 'Post deleted successfully' });\r\n    } catch (error) {\r\n        console.error('Error deleting post:', error);\r\n        return NextResponse.json({ error: 'Failed to delete post' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\campaigns\\[id]\\posts\\[postId]\\send\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6255,6258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6255,6258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":160,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6967,6970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6967,6970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":187,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8198,8201],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8198,8201],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":205,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":205,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8977,8980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8977,8980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":224,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9740,9743],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9740,9743],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":279,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12175,12178],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12175,12178],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { sendCampaignEmail } from '@/lib/email';\r\nimport { postToLinkedIn } from '@/lib/linkedin';\r\nimport { postToFacebook } from '@/lib/facebook';\r\nimport { postToInstagram } from '@/lib/instagram';\r\nimport { postToYouTube, postYouTubeCommunity } from '@/lib/youtube';\r\nimport { postToPinterest } from '@/lib/pinterest';\r\nimport { sendSms, sendWhatsapp } from '@/lib/twilio';\r\n\r\nexport async function POST(\r\n    req: Request,\r\n    { params }: { params: Promise<{ id: string; postId: string }> }\r\n) {\r\n    console.log(\"POST /api/campaigns/[id]/posts/[postId]/send hit\");\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Await params before accessing properties\r\n        const resolvedParams = await params;\r\n        const id = resolvedParams.id;\r\n        const postId = resolvedParams.postId;\r\n\r\n        console.log(\"Params resolved:\", { id, postId });\r\n\r\n        const { contactIds } = await req.json();\r\n\r\n        // Fetch post and campaign\r\n        const post = await prisma.campaignPost.findUnique({\r\n            where: {\r\n                id: parseInt(postId),\r\n                campaignId: parseInt(id),\r\n            },\r\n            include: {\r\n                campaign: {\r\n                    include: {\r\n                        organisation: true\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (!post) {\r\n            return NextResponse.json({ error: 'Post not found' }, { status: 404 });\r\n        }\r\n\r\n        const isSocialPlatform = ['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST'].includes(post.type);\r\n\r\n        if (!isSocialPlatform && (!contactIds || !Array.isArray(contactIds) || contactIds.length === 0)) {\r\n            return NextResponse.json({ error: 'No contacts selected' }, { status: 400 });\r\n        }\r\n\r\n        // Handle Social Media Posting\r\n        if (isSocialPlatform) {\r\n            // Get user credentials\r\n            const dbUser = await prisma.user.findUnique({\r\n                where: { clerkId: userId },\r\n                select: {\r\n                    linkedInAccessToken: true,\r\n                    linkedInAuthUrn: true,\r\n                    facebookAccessToken: true,\r\n                    facebookPageAccessToken: true,\r\n                    facebookPageId: true,\r\n                    instagramAccessToken: true,\r\n                    instagramUserId: true,\r\n                    youtubeAccessToken: true,\r\n                    pinterestAccessToken: true,\r\n                }\r\n            });\r\n\r\n            if (!dbUser) {\r\n                return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n            }\r\n\r\n            if (post.type === 'LINKEDIN') {\r\n                if (!dbUser.linkedInAccessToken || !dbUser.linkedInAuthUrn) {\r\n                    return NextResponse.json({ error: 'LinkedIn credentials not found. Please connect your account.' }, { status: 400 });\r\n                }\r\n\r\n                try {\r\n                    const linkedInResponse = await postToLinkedIn(\r\n                        {\r\n                            accessToken: dbUser.linkedInAccessToken,\r\n                            authorUrn: dbUser.linkedInAuthUrn,\r\n                        },\r\n                        post.message || post.subject || \"\",\r\n                        post.mediaUrls.length > 0 ? post.mediaUrls : post.videoUrl\r\n                    );\r\n\r\n                    // Update post status\r\n                    await prisma.campaignPost.update({\r\n                        where: { id: post.id },\r\n                        data: { isPostSent: true }\r\n                    });\r\n\r\n                    // Create Transaction Record\r\n                    await prisma.postTransaction.create({\r\n                        data: {\r\n                            refId: post.id,\r\n                            platform: 'LINKEDIN',\r\n                            postId: linkedInResponse.id,\r\n                            accountId: dbUser.linkedInAuthUrn,\r\n                            message: post.message || post.subject || \"\",\r\n                            mediaUrls: post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl, // Store first URL or videoUrl\r\n                            postType: (post.mediaUrls.length > 0 || post.videoUrl) ?\r\n                                ((post.mediaUrls[0] || post.videoUrl || '').match(/\\.(mp4|mov|webm)$/i) ? 'VIDEO' : 'IMAGE')\r\n                                : 'TEXT',\r\n                            accessToken: dbUser.linkedInAccessToken,\r\n                            published: true,\r\n                            publishedAt: new Date(),\r\n                        }\r\n                    });\r\n\r\n                    return NextResponse.json({\r\n                        success: true,\r\n                        sent: 1,\r\n                        failed: 0,\r\n                        postData: linkedInResponse // Return LinkedIn response details\r\n                    });\r\n\r\n                } catch (error) {\r\n                    console.error('LinkedIn post error:', error);\r\n                    return NextResponse.json({ error: 'Failed to post to LinkedIn' }, { status: 500 });\r\n                }\r\n            } else if (post.type === 'FACEBOOK') {\r\n                // Use Page access token if available, otherwise fallback to user token\r\n                const fbToken = dbUser.facebookPageAccessToken || dbUser.facebookAccessToken;\r\n\r\n                if (!fbToken || !dbUser.facebookPageId) {\r\n                    return NextResponse.json({ error: 'Facebook credentials not found. Please reconnect your Facebook Page.' }, { status: 400 });\r\n                }\r\n\r\n                const platformResponse = await postToFacebook(\r\n                    {\r\n                        accessToken: fbToken,\r\n                        pageId: dbUser.facebookPageId,\r\n                    },\r\n                    post.message || post.subject || \"\",\r\n                    post.mediaUrls.length > 0 ? post.mediaUrls : post.videoUrl,\r\n                    { isReel: (post.metadata as any)?.isReel }\r\n                );\r\n\r\n                await prisma.campaignPost.update({\r\n                    where: { id: post.id },\r\n                    data: { isPostSent: true }\r\n                });\r\n\r\n                await prisma.postTransaction.create({\r\n                    data: {\r\n                        refId: post.id,\r\n                        platform: 'FACEBOOK',\r\n                        postId: platformResponse.id,\r\n                        accountId: dbUser.facebookPageId,\r\n                        message: post.message || post.subject || \"\",\r\n                        mediaUrls: post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl,\r\n                        postType: (post.metadata as any)?.isReel ? 'REEL' : ((post.mediaUrls.length > 0 || post.videoUrl) ? 'IMAGE' : 'TEXT'),\r\n                        accessToken: fbToken,\r\n                        published: true,\r\n                        publishedAt: new Date(),\r\n                    }\r\n                });\r\n\r\n                return NextResponse.json({\r\n                    success: true,\r\n                    sent: 1,\r\n                    failed: 0,\r\n                    postData: platformResponse\r\n                });\r\n\r\n            } else if (post.type === 'INSTAGRAM') {\r\n                if (!dbUser.instagramAccessToken || !dbUser.instagramUserId) {\r\n                    return NextResponse.json({ error: 'Instagram credentials not found. Please connect your account.' }, { status: 400 });\r\n                }\r\n\r\n                const platformResponse = await postToInstagram(\r\n                    {\r\n                        accessToken: dbUser.instagramAccessToken,\r\n                        userId: dbUser.instagramUserId,\r\n                    },\r\n                    post.message || post.subject || \"\",\r\n                    post.mediaUrls.length > 0 ? post.mediaUrls : post.videoUrl,\r\n                    {\r\n                        isReel: (post.metadata as any)?.isReel,\r\n                        shareToFeed: true\r\n                    }\r\n                );\r\n\r\n                await prisma.campaignPost.update({\r\n                    where: { id: post.id },\r\n                    data: { isPostSent: true }\r\n                });\r\n\r\n                await prisma.postTransaction.create({\r\n                    data: {\r\n                        refId: post.id,\r\n                        platform: 'INSTAGRAM',\r\n                        postId: platformResponse.id,\r\n                        accountId: dbUser.instagramUserId,\r\n                        message: post.message || post.subject || \"\",\r\n                        mediaUrls: post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl,\r\n                        postType: (post.metadata as any)?.isReel ? 'REEL' : 'IMAGE',\r\n                        accessToken: dbUser.instagramAccessToken,\r\n                        published: true,\r\n                        publishedAt: new Date(),\r\n                    }\r\n                });\r\n\r\n                return NextResponse.json({\r\n                    success: true,\r\n                    sent: 1,\r\n                    failed: 0,\r\n                    postData: platformResponse\r\n                });\r\n\r\n            } else if (post.type === 'YOUTUBE') {\r\n                if (!dbUser.youtubeAccessToken) {\r\n                    return NextResponse.json({ error: 'YouTube credentials not found. Please connect your account.' }, { status: 400 });\r\n                }\r\n\r\n                const metadata = post.metadata as any;\r\n                const media = post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl;\r\n                let platformResponse;\r\n\r\n                if (media && media.match(/\\.(mp4|mov|webm)$/i)) {\r\n                    platformResponse = await postToYouTube(\r\n                        { accessToken: dbUser.youtubeAccessToken },\r\n                        post.subject || 'Video Post',\r\n                        post.message || \"\",\r\n                        media,\r\n                        {\r\n                            tags: metadata?.tags || [],\r\n                            privacy: metadata?.privacy || 'public',\r\n                        }\r\n                    );\r\n                } else {\r\n                    platformResponse = await postYouTubeCommunity(\r\n                        { accessToken: dbUser.youtubeAccessToken },\r\n                        post.message || post.subject || \"\",\r\n                        media || undefined\r\n                    );\r\n                }\r\n\r\n                await prisma.campaignPost.update({\r\n                    where: { id: post.id },\r\n                    data: { isPostSent: true }\r\n                });\r\n\r\n                await prisma.postTransaction.create({\r\n                    data: {\r\n                        refId: post.id,\r\n                        platform: 'YOUTUBE',\r\n                        postId: platformResponse.id,\r\n                        accountId: 'youtube-channel',\r\n                        message: post.message || post.subject || \"\",\r\n                        mediaUrls: post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl,\r\n                        postType: media && media.match(/\\.(mp4|mov|webm)$/i) ? 'VIDEO' : 'TEXT',\r\n                        accessToken: dbUser.youtubeAccessToken,\r\n                        published: true,\r\n                        publishedAt: new Date(),\r\n                    }\r\n                });\r\n\r\n                return NextResponse.json({\r\n                    success: true,\r\n                    sent: 1,\r\n                    failed: 0,\r\n                    postData: platformResponse\r\n                });\r\n\r\n            } else if (post.type === 'PINTEREST') {\r\n                if (!dbUser.pinterestAccessToken) {\r\n                    return NextResponse.json({ error: 'Pinterest credentials not found. Please connect your account.' }, { status: 400 });\r\n                }\r\n\r\n                const metadata = post.metadata as any;\r\n                const imageUrl = post.mediaUrls.length > 0 ? post.mediaUrls[0] : post.videoUrl;\r\n\r\n                if (!imageUrl) {\r\n                    return NextResponse.json({ error: 'Pinterest requires an image' }, { status: 400 });\r\n                }\r\n\r\n                if (!metadata?.boardId) {\r\n                    return NextResponse.json({ error: 'Pinterest requires a Board ID. Please edit the post to select a board.' }, { status: 400 });\r\n                }\r\n\r\n                const platformResponse = await postToPinterest(\r\n                    { accessToken: dbUser.pinterestAccessToken },\r\n                    post.subject || 'Pin',\r\n                    post.message || \"\",\r\n                    imageUrl,\r\n                    {\r\n                        boardId: metadata?.boardId,\r\n                        link: metadata?.link,\r\n                    }\r\n                );\r\n\r\n                await prisma.campaignPost.update({\r\n                    where: { id: post.id },\r\n                    data: { isPostSent: true }\r\n                });\r\n\r\n                await prisma.postTransaction.create({\r\n                    data: {\r\n                        refId: post.id,\r\n                        platform: 'PINTEREST',\r\n                        postId: platformResponse.id,\r\n                        accountId: 'pinterest-user',\r\n                        message: post.message || post.subject || \"\",\r\n                        mediaUrls: imageUrl,\r\n                        postType: 'IMAGE',\r\n                        accessToken: dbUser.pinterestAccessToken,\r\n                        published: true,\r\n                        publishedAt: new Date(),\r\n                    }\r\n                });\r\n\r\n                return NextResponse.json({\r\n                    success: true,\r\n                    sent: 1,\r\n                    failed: 0,\r\n                    postData: platformResponse\r\n                });\r\n\r\n            } else {\r\n                return NextResponse.json({ error: `Platform ${post.type} not yet supported` }, { status: 501 });\r\n            }\r\n        }\r\n\r\n        // Handle Email/SMS Sending (Existing Logic)\r\n\r\n        // Fetch contacts\r\n        const contacts = await prisma.contact.findMany({\r\n            where: {\r\n                id: { in: contactIds.map((id: string) => parseInt(id)) },\r\n                organisationId: post.campaign?.organisationId\r\n            }\r\n        });\r\n\r\n        if (contacts.length === 0) {\r\n            return NextResponse.json({ error: 'No valid contacts found' }, { status: 404 });\r\n        }\r\n\r\n        // Send emails\r\n        let successCount = 0;\r\n        let failCount = 0;\r\n\r\n        // Only handle EMAIL type for now as requested\r\n        if (post.type === 'EMAIL') {\r\n            for (const contact of contacts) {\r\n                if (!contact.contactEmail) {\r\n                    failCount++;\r\n                    continue;\r\n                }\r\n\r\n                // Variable substitution\r\n                let subject = post.subject || '';\r\n                let message = post.message || '';\r\n\r\n                const replacements: Record<string, string> = {\r\n                    '{{name}}': contact.contactName || '',\r\n                    '{{email}}': contact.contactEmail || '',\r\n                    '{{phone}}': contact.contactMobile || '',\r\n                    '{{company}}': post.campaign?.organisation.name || '',\r\n                };\r\n\r\n                Object.entries(replacements).forEach(([key, value]) => {\r\n                    subject = subject.replace(new RegExp(key, 'g'), value);\r\n                    message = message.replace(new RegExp(key, 'g'), value);\r\n                });\r\n\r\n                const sent = await sendCampaignEmail({\r\n                    to: contact.contactEmail,\r\n                    subject: subject,\r\n                    html: message, // Assuming message is HTML or plain text\r\n                    replyTo: post.senderEmail || undefined\r\n                });\r\n\r\n                if (sent) successCount++;\r\n                else failCount++;\r\n            }\r\n        } else if (post.type === 'SMS') {\r\n            for (const contact of contacts) {\r\n                if (!contact.contactMobile) {\r\n                    failCount++;\r\n                    continue;\r\n                }\r\n\r\n                let message = post.message || '';\r\n                const replacements: Record<string, string> = {\r\n                    '{{name}}': contact.contactName || '',\r\n                    '{{email}}': contact.contactEmail || '',\r\n                    '{{phone}}': contact.contactMobile || '',\r\n                    '{{company}}': post.campaign?.organisation.name || '',\r\n                };\r\n\r\n                Object.entries(replacements).forEach(([key, value]) => {\r\n                    message = message.replace(new RegExp(key, 'g'), value);\r\n                });\r\n\r\n                const sent = await sendSms(contact.contactMobile, message);\r\n                if (sent) successCount++;\r\n                else failCount++;\r\n            }\r\n        } else if (post.type === 'WHATSAPP') {\r\n            for (const contact of contacts) {\r\n                const number = contact.contactWhatsApp || contact.contactMobile;\r\n                if (!number) {\r\n                    failCount++;\r\n                    continue;\r\n                }\r\n\r\n                let message = post.message || '';\r\n                const replacements: Record<string, string> = {\r\n                    '{{name}}': contact.contactName || '',\r\n                    '{{email}}': contact.contactEmail || '',\r\n                    '{{phone}}': number || '',\r\n                    '{{company}}': post.campaign?.organisation.name || '',\r\n                };\r\n\r\n                Object.entries(replacements).forEach(([key, value]) => {\r\n                    message = message.replace(new RegExp(key, 'g'), value);\r\n                });\r\n\r\n                const sent = await sendWhatsapp(number, message);\r\n                if (sent) successCount++;\r\n                else failCount++;\r\n            }\r\n        } else {\r\n            // TODO: Implement other providers if any\r\n            // For now, just mock success for non-email to avoid breaking the UI flow\r\n            successCount = contacts.length;\r\n        }\r\n\r\n        // Update post status if sent to at least one person\r\n        if (successCount > 0) {\r\n            await prisma.campaignPost.update({\r\n                where: { id: post.id },\r\n                data: { isPostSent: true }\r\n            });\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            sent: successCount,\r\n            failed: failCount\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[POST_SHARE]', error);\r\n        return NextResponse.json({ error: 'Internal Error' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\campaigns\\[id]\\posts\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4003,4006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4003,4006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\nimport { postToLinkedIn } from '@/lib/linkedin';\r\n\r\n// GET - Fetch all posts for a campaign\r\nexport async function GET(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const { id } = await params;\r\n        const campaignId = parseInt(id);\r\n\r\n        // Verify campaign belongs to organisation\r\n        const campaign = await prisma.campaign.findFirst({\r\n            where: {\r\n                id: campaignId,\r\n                organisationId: dbUser.organisationId,\r\n                isDeleted: false,\r\n            },\r\n        });\r\n\r\n        if (!campaign) {\r\n            return NextResponse.json({ error: 'Campaign not found' }, { status: 404 });\r\n        }\r\n\r\n        // Fetch posts\r\n        const posts = await prisma.campaignPost.findMany({\r\n            where: {\r\n                campaignId,\r\n                isAttachedToCampaign: true,\r\n            },\r\n            orderBy: {\r\n                createdAt: 'desc',\r\n            },\r\n        });\r\n\r\n        return NextResponse.json({ posts });\r\n    } catch (error) {\r\n        console.error('Error fetching campaign posts:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch posts' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// POST - Create a new post for a campaign\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation and credentials\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: {\r\n                organisationId: true,\r\n                linkedInAccessToken: true,\r\n                linkedInAuthUrn: true\r\n            }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const { id } = await params;\r\n        const campaignId = parseInt(id);\r\n\r\n        // Verify campaign belongs to organisation\r\n        const campaign = await prisma.campaign.findFirst({\r\n            where: {\r\n                id: campaignId,\r\n                organisationId: dbUser.organisationId,\r\n                isDeleted: false,\r\n            },\r\n        });\r\n\r\n        if (!campaign) {\r\n            return NextResponse.json({ error: 'Campaign not found' }, { status: 404 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const {\r\n            subject,\r\n            message,\r\n            type, // Reverted to single type\r\n            scheduledPostTime,\r\n            senderEmail,\r\n            mediaUrls,\r\n            youtubeTags,\r\n            youtubePrivacy,\r\n            pinterestBoardId,\r\n            pinterestLink,\r\n            isReel\r\n        } = body;\r\n\r\n        // Validation\r\n        if (!type) {\r\n            return NextResponse.json({ error: 'Platform type is required' }, { status: 400 });\r\n        }\r\n\r\n        if (!message && !subject && !mediaUrls?.length) {\r\n            return NextResponse.json({ error: 'Message, subject or media is required' }, { status: 400 });\r\n        }\r\n\r\n        // Prepare metadata\r\n        let metadata: any = {};\r\n        if (type === 'YOUTUBE') {\r\n            metadata = { tags: youtubeTags, privacy: youtubePrivacy };\r\n        } else if (type === 'PINTEREST') {\r\n            metadata = { boardId: pinterestBoardId, link: pinterestLink };\r\n        } else if (type === 'FACEBOOK' || type === 'INSTAGRAM') {\r\n            metadata = { isReel: !!isReel };\r\n        }\r\n\r\n        // Create post\r\n        const post = await prisma.campaignPost.create({\r\n            data: {\r\n                campaignId,\r\n                subject,\r\n                message,\r\n                type,\r\n                senderEmail: type === 'EMAIL' ? senderEmail : null,\r\n                scheduledPostTime: scheduledPostTime ? new Date(scheduledPostTime) : null,\r\n                isAttachedToCampaign: true,\r\n                videoUrl: mediaUrls && mediaUrls.length > 0 ? mediaUrls[0] : null, // Legacy support\r\n                mediaUrls: mediaUrls || [],\r\n                metadata,\r\n            },\r\n        });\r\n\r\n        // If it's a LinkedIn post and not scheduled, send it immediately\r\n        if (type === 'LINKEDIN' && !scheduledPostTime) {\r\n            if (!dbUser.linkedInAccessToken || !dbUser.linkedInAuthUrn) {\r\n                console.warn(\"Missing LinkedIn credentials for user\", user.id);\r\n            } else {\r\n                try {\r\n                    const linkedInResponse = await postToLinkedIn(\r\n                        {\r\n                            accessToken: dbUser.linkedInAccessToken,\r\n                            authorUrn: dbUser.linkedInAuthUrn,\r\n                        },\r\n                        message || subject || \"\",\r\n                        mediaUrls\r\n                    );\r\n\r\n                    // Update post status\r\n                    await prisma.campaignPost.update({\r\n                        where: { id: post.id },\r\n                        data: { isPostSent: true }\r\n                    });\r\n\r\n                    // Create Transaction Record\r\n                    await prisma.postTransaction.create({\r\n                        data: {\r\n                            refId: post.id,\r\n                            platform: 'LINKEDIN',\r\n                            postId: linkedInResponse.id,\r\n                            accountId: dbUser.linkedInAuthUrn,\r\n                            message: message || subject || \"\",\r\n                            mediaUrls: mediaUrls && mediaUrls.length > 0 ? mediaUrls[0] : null,\r\n                            postType: mediaUrls && mediaUrls.length > 0 ? (mediaUrls[0].match(/\\.(mp4|mov|webm)$/i) ? 'VIDEO' : 'IMAGE') : 'TEXT',\r\n                            accessToken: dbUser.linkedInAccessToken,\r\n                            published: true,\r\n                            publishedAt: new Date(),\r\n                        }\r\n                    });\r\n\r\n                } catch (postError) {\r\n                    console.error(\"Failed to post to LinkedIn:\", postError);\r\n                }\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({ post }, { status: 201 });\r\n    } catch (error) {\r\n        console.error('Error creating campaign post:', error);\r\n        return NextResponse.json({ error: 'Failed to create post' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\campaigns\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\campaigns\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1190,1193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1190,1193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\n\r\n// GET - Fetch campaigns for the organisation with pagination\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true, role: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        // Get query parameters\r\n        const { searchParams } = new URL(request.url);\r\n        const page = parseInt(searchParams.get('page') || '1');\r\n        const limit = parseInt(searchParams.get('limit') || '10');\r\n        const search = searchParams.get('search') || '';\r\n\r\n        const skip = (page - 1) * limit;\r\n\r\n        // Build where clause\r\n        const where: any = {\r\n            organisationId: dbUser.organisationId,\r\n            isDeleted: false,\r\n        };\r\n\r\n        if (search) {\r\n            where.OR = [\r\n                { name: { contains: search, mode: 'insensitive' } },\r\n                { description: { contains: search, mode: 'insensitive' } },\r\n            ];\r\n        }\r\n\r\n        // Fetch campaigns with pagination\r\n        const [campaigns, total] = await Promise.all([\r\n            prisma.campaign.findMany({\r\n                where,\r\n                select: {\r\n                    id: true,\r\n                    name: true,\r\n                    description: true,\r\n                    startDate: true,\r\n                    endDate: true,\r\n                    createdAt: true,\r\n                    _count: {\r\n                        select: {\r\n                            posts: true,\r\n                            contacts: true,\r\n                        },\r\n                    },\r\n                },\r\n                orderBy: {\r\n                    createdAt: 'desc'\r\n                },\r\n                skip,\r\n                take: limit,\r\n            }),\r\n            prisma.campaign.count({ where }),\r\n        ]);\r\n\r\n        return NextResponse.json({\r\n            campaigns,\r\n            pagination: {\r\n                total,\r\n                page,\r\n                limit,\r\n                totalPages: Math.ceil(total / limit),\r\n            },\r\n        });\r\n    } catch (error) {\r\n        console.error('Error fetching campaigns:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch campaigns' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// POST - Create a new campaign\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true, role: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { name, description, startDate, endDate, contactIds } = body;\r\n\r\n        // Validation\r\n        if (!name || !startDate || !endDate) {\r\n            return NextResponse.json(\r\n                { error: 'Name, start date, and end date are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Create campaign with contacts\r\n        const campaign = await prisma.campaign.create({\r\n            data: {\r\n                name,\r\n                description,\r\n                startDate: new Date(startDate),\r\n                endDate: new Date(endDate),\r\n                organisationId: dbUser.organisationId,\r\n                contacts: contactIds && contactIds.length > 0 ? {\r\n                    connect: contactIds.map((id: number) => ({ id })),\r\n                } : undefined,\r\n            },\r\n            include: {\r\n                contacts: true,\r\n                _count: {\r\n                    select: {\r\n                        posts: true,\r\n                        contacts: true,\r\n                    },\r\n                },\r\n            },\r\n        });\r\n\r\n        return NextResponse.json({ campaign }, { status: 201 });\r\n    } catch (error) {\r\n        console.error('Error creating campaign:', error);\r\n        return NextResponse.json({ error: 'Failed to create campaign' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\contacts\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\contacts\\export\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1040,1043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1040,1043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\n\r\n// GET - Export contacts to CSV\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const searchParams = request.nextUrl.searchParams;\r\n        const search = searchParams.get('search') || '';\r\n        const campaignId = searchParams.get('campaignId');\r\n        const contactIds = searchParams.get('contactIds'); // For exporting selected contacts\r\n\r\n        // Build where clause\r\n        const where: any = {\r\n            organisationId: dbUser.organisationId,\r\n        };\r\n\r\n        // Export specific contacts if IDs provided\r\n        if (contactIds) {\r\n            const ids = contactIds.split(',').map(id => parseInt(id));\r\n            where.id = { in: ids };\r\n        } else {\r\n            // Apply filters for full export\r\n            if (search) {\r\n                where.OR = [\r\n                    { contactName: { contains: search, mode: 'insensitive' } },\r\n                    { contactEmail: { contains: search, mode: 'insensitive' } },\r\n                    { contactMobile: { contains: search, mode: 'insensitive' } },\r\n                ];\r\n            }\r\n\r\n            if (campaignId) {\r\n                where.campaigns = {\r\n                    some: {\r\n                        id: parseInt(campaignId)\r\n                    }\r\n                };\r\n            }\r\n        }\r\n\r\n        // Fetch all matching contacts\r\n        const contacts = await prisma.contact.findMany({\r\n            where,\r\n            include: {\r\n                campaigns: {\r\n                    select: {\r\n                        name: true,\r\n                    }\r\n                }\r\n            },\r\n            orderBy: {\r\n                createdAt: 'desc'\r\n            }\r\n        });\r\n\r\n        // Generate CSV content\r\n        const csvHeaders = ['ID', 'Name', 'Email', 'Mobile', 'WhatsApp', 'Campaigns', 'Created At'];\r\n        const csvRows = contacts.map(contact => [\r\n            contact.id,\r\n            contact.contactName || '',\r\n            contact.contactEmail || '',\r\n            contact.contactMobile || '',\r\n            contact.contactWhatsApp || '',\r\n            contact.campaigns.map(c => c.name).join('; ') || '',\r\n            new Date(contact.createdAt).toLocaleString()\r\n        ]);\r\n\r\n        // Create CSV string\r\n        const csvContent = [\r\n            csvHeaders.join(','),\r\n            ...csvRows.map(row =>\r\n                row.map(cell => {\r\n                    // Escape cells containing commas, quotes, or newlines\r\n                    const cellStr = String(cell);\r\n                    if (cellStr.includes(',') || cellStr.includes('\"') || cellStr.includes('\\n')) {\r\n                        return `\"${cellStr.replace(/\"/g, '\"\"')}\"`;\r\n                    }\r\n                    return cellStr;\r\n                }).join(',')\r\n            )\r\n        ].join('\\n');\r\n\r\n        // Return CSV file\r\n        return new NextResponse(csvContent, {\r\n            status: 200,\r\n            headers: {\r\n                'Content-Type': 'text/csv',\r\n                'Content-Disposition': `attachment; filename=\"contacts-${new Date().toISOString().split('T')[0]}.csv\"`,\r\n            },\r\n        });\r\n    } catch (error) {\r\n        console.error('Error exporting contacts:', error);\r\n        return NextResponse.json({ error: 'Failed to export contacts' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\contacts\\import\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\contacts\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1354,1357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1354,1357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5229,5232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5229,5232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\n\r\n// GET - Fetch contacts with search, filter, and pagination\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get user from database to check organisation\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true, role: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const searchParams = request.nextUrl.searchParams;\r\n        const page = parseInt(searchParams.get('page') || '1');\r\n        const limit = parseInt(searchParams.get('limit') || '10');\r\n        const search = searchParams.get('search') || '';\r\n        const campaignId = searchParams.get('campaignId');\r\n        const sortBy = searchParams.get('sortBy') || 'createdAt';\r\n        const sortOrder = searchParams.get('sortOrder') || 'desc';\r\n\r\n        const skip = (page - 1) * limit;\r\n\r\n        // Build where clause\r\n        const where: any = {\r\n            organisationId: dbUser.organisationId,\r\n        };\r\n\r\n        // Add search filter\r\n        if (search) {\r\n            where.OR = [\r\n                { contactName: { contains: search, mode: 'insensitive' } },\r\n                { contactEmail: { contains: search, mode: 'insensitive' } },\r\n                { contactMobile: { contains: search, mode: 'insensitive' } },\r\n            ];\r\n        }\r\n\r\n        // Add campaign filter\r\n        if (campaignId) {\r\n            where.campaigns = {\r\n                some: {\r\n                    id: parseInt(campaignId)\r\n                }\r\n            };\r\n        }\r\n\r\n        // Get total count\r\n        const total = await prisma.contact.count({ where });\r\n\r\n        // Fetch contacts with pagination\r\n        const contacts = await prisma.contact.findMany({\r\n            where,\r\n            include: {\r\n                campaigns: {\r\n                    select: {\r\n                        id: true,\r\n                        name: true,\r\n                    }\r\n                }\r\n            },\r\n            skip,\r\n            take: limit,\r\n            orderBy: {\r\n                [sortBy]: sortOrder\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({\r\n            contacts,\r\n            pagination: {\r\n                total,\r\n                page,\r\n                limit,\r\n                totalPages: Math.ceil(total / limit)\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error('Error fetching contacts:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch contacts' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// POST - Create new contact\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { contactName, contactEmail, contactMobile, contactWhatsApp, campaignIds } = body;\r\n\r\n        // Validation: At least one field required\r\n        if (!contactName && !contactEmail && !contactMobile) {\r\n            return NextResponse.json(\r\n                { error: 'At least one of name, email, or mobile is required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Email format validation\r\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n        if (contactEmail && !emailRegex.test(contactEmail)) {\r\n            return NextResponse.json(\r\n                { error: 'Invalid email format' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Phone validation (basic)\r\n        const phoneRegex = /^\\+?[\\d\\s\\-()]+$/;\r\n        if (contactMobile && (!phoneRegex.test(contactMobile) || contactMobile.replace(/\\D/g, '').length < 10)) {\r\n            return NextResponse.json(\r\n                { error: 'Invalid mobile number format' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        if (contactWhatsApp && (!phoneRegex.test(contactWhatsApp) || contactWhatsApp.replace(/\\D/g, '').length < 10)) {\r\n            return NextResponse.json(\r\n                { error: 'Invalid WhatsApp number format' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Check for duplicates\r\n        const existingContact = await prisma.contact.findFirst({\r\n            where: {\r\n                organisationId: dbUser.organisationId,\r\n                OR: [\r\n                    ...(contactEmail ? [{ contactEmail: { equals: contactEmail, mode: 'insensitive' as any } }] : []),\r\n                    ...(contactMobile ? [{ contactMobile }] : [])\r\n                ]\r\n            }\r\n        });\r\n\r\n        if (existingContact) {\r\n            const duplicateField = existingContact.contactEmail?.toLowerCase() === contactEmail?.toLowerCase()\r\n                ? 'email'\r\n                : 'mobile';\r\n            return NextResponse.json(\r\n                {\r\n                    error: `A contact with this ${duplicateField} already exists`,\r\n                    duplicate: true,\r\n                    field: duplicateField\r\n                },\r\n                { status: 409 }\r\n            );\r\n        }\r\n\r\n        // Create contact\r\n        const contact = await prisma.contact.create({\r\n            data: {\r\n                contactName,\r\n                contactEmail,\r\n                contactMobile,\r\n                contactWhatsApp,\r\n                organisationId: dbUser.organisationId,\r\n                ...(campaignIds && campaignIds.length > 0 ? {\r\n                    campaigns: {\r\n                        connect: campaignIds.map((id: number) => ({ id }))\r\n                    }\r\n                } : {})\r\n            },\r\n            include: {\r\n                campaigns: {\r\n                    select: {\r\n                        id: true,\r\n                        name: true,\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return NextResponse.json(contact, { status: 201 });\r\n    } catch (error) {\r\n        console.error('Error creating contact:', error);\r\n        return NextResponse.json({ error: 'Failed to create contact' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// DELETE - Bulk delete contacts\r\nexport async function DELETE(request: NextRequest) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            select: { organisationId: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: 'Organisation not found' }, { status: 404 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { contactIds } = body;\r\n\r\n        if (!Array.isArray(contactIds) || contactIds.length === 0) {\r\n            return NextResponse.json({ error: 'Invalid contact IDs' }, { status: 400 });\r\n        }\r\n\r\n        // Delete contacts (only ones belonging to the organisation)\r\n        const result = await prisma.contact.deleteMany({\r\n            where: {\r\n                id: { in: contactIds },\r\n                organisationId: dbUser.organisationId\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({\r\n            message: `Successfully deleted ${result.count} contact(s)`,\r\n            count: result.count\r\n        });\r\n    } catch (error) {\r\n        console.error('Error deleting contacts:', error);\r\n        return NextResponse.json({ error: 'Failed to delete contacts' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\contacts\\template\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\enquiries\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\organisations\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\payments\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\razorpay\\create-order\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1520,1523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1520,1523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { currentUser } from \"@clerk/nextjs/server\";\r\nimport { NextResponse } from \"next/server\";\r\nimport { createRazorpayOrder } from \"@/lib/razorpay\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { getPlanById } from \"@/lib/plans\";\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const user = await currentUser();\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const { plan, organizationName, isSignup } = await req.json();\r\n\r\n        if (!plan) {\r\n            return NextResponse.json({ error: \"Plan is required\" }, { status: 400 });\r\n        }\r\n\r\n        // Get plan details\r\n        const planDetails = getPlanById(plan);\r\n\r\n        if (!planDetails) {\r\n            return NextResponse.json({ error: \"Invalid plan\" }, { status: 400 });\r\n        }\r\n\r\n        // Free trial doesn't require payment\r\n        if (plan === \"FREE_TRIAL\") {\r\n            return NextResponse.json({ error: \"Free trial doesn't require payment\" }, { status: 400 });\r\n        }\r\n\r\n        // Get user from database\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            include: { organisation: true },\r\n        });\r\n\r\n        if (!dbUser) {\r\n            return NextResponse.json({ error: \"User not found\" }, { status: 404 });\r\n        }\r\n\r\n        // Handle signup flow (no organisation yet) vs upgrade flow (organisation exists)\r\n        let receipt: string;\r\n        let orderNotes: any;\r\n\r\n        if (isSignup || !dbUser.organisationId) {\r\n            // Signup flow - organisation doesn't exist yet\r\n            if (!organizationName) {\r\n                return NextResponse.json({ error: \"Organization name is required for signup\" }, { status: 400 });\r\n            }\r\n            receipt = `signup_${dbUser.id}_${Date.now()}`;\r\n            orderNotes = {\r\n                userId: dbUser.id,\r\n                plan: plan,\r\n                organizationName: organizationName,\r\n                isSignup: \"true\",\r\n            };\r\n        } else {\r\n            // Upgrade flow - organisation exists\r\n            receipt = `order_${dbUser.organisationId}_${Date.now()}`;\r\n            orderNotes = {\r\n                organisationId: dbUser.organisationId,\r\n                plan: plan,\r\n                userId: dbUser.id,\r\n                isSignup: \"false\",\r\n            };\r\n        }\r\n\r\n        // Create Razorpay order\r\n        const order = await createRazorpayOrder(\r\n            planDetails.price,\r\n            planDetails.currency,\r\n            receipt,\r\n            orderNotes\r\n        );\r\n\r\n        // Store order info temporarily for signup flow\r\n        // We'll create the payment record after organisation is created\r\n        if (isSignup || !dbUser.organisationId) {\r\n            // For signup, we'll store the order details in the order notes\r\n            // The payment record will be created when the organisation is created\r\n            return NextResponse.json({\r\n                orderId: order.id,\r\n                amount: order.amount,\r\n                currency: order.currency,\r\n                keyId: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID,\r\n                isSignup: true,\r\n            });\r\n        } else {\r\n            // For upgrade, create payment record immediately\r\n            await prisma.payment.create({\r\n                data: {\r\n                    organisationId: dbUser.organisationId,\r\n                    razorpayOrderId: order.id,\r\n                    amount: planDetails.price,\r\n                    currency: planDetails.currency,\r\n                    status: \"PENDING\",\r\n                    plan: plan,\r\n                    receipt: receipt,\r\n                    notes: orderNotes,\r\n                    razorpayPaymentId: order.id,\r\n                    razorpaySignature: order.id\r\n                }\r\n            });\r\n\r\n            return NextResponse.json({\r\n                orderId: order.id,\r\n                amount: order.amount,\r\n                currency: order.currency,\r\n                keyId: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID,\r\n                isSignup: false,\r\n            });\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error creating Razorpay order:\", error);\r\n        return NextResponse.json(\r\n            { error: \"Failed to create order\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\razorpay\\verify-payment\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\razorpay\\webhook\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1865,1868],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1865,1868],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2434,2437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2434,2437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from \"next/server\";\r\nimport { verifyWebhookSignature } from \"@/lib/razorpay\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const body = await req.text();\r\n        const signature = req.headers.get(\"x-razorpay-signature\");\r\n\r\n        if (!signature) {\r\n            return NextResponse.json({ error: \"No signature found\" }, { status: 400 });\r\n        }\r\n\r\n        // Verify webhook signature\r\n        const webhookSecret = process.env.RAZORPAY_WEBHOOK_SECRET || \"\";\r\n        const isValid = verifyWebhookSignature(body, signature, webhookSecret);\r\n\r\n        if (!isValid) {\r\n            console.error(\"Invalid webhook signature\");\r\n            return NextResponse.json({ error: \"Invalid signature\" }, { status: 400 });\r\n        }\r\n\r\n        const event = JSON.parse(body);\r\n        console.log(\"Razorpay webhook event:\", event.event);\r\n\r\n        // Handle different webhook events\r\n        switch (event.event) {\r\n            case \"payment.authorized\":\r\n            case \"payment.captured\":\r\n                await handlePaymentSuccess(event.payload.payment.entity);\r\n                break;\r\n\r\n            case \"payment.failed\":\r\n                await handlePaymentFailed(event.payload.payment.entity);\r\n                break;\r\n\r\n            case \"order.paid\":\r\n                console.log(\"Order paid:\", event.payload.order.entity);\r\n                break;\r\n\r\n            default:\r\n                console.log(\"Unhandled event:\", event.event);\r\n        }\r\n\r\n        return NextResponse.json({ received: true });\r\n    } catch (error) {\r\n        console.error(\"Error processing webhook:\", error);\r\n        return NextResponse.json(\r\n            { error: \"Webhook processing failed\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\nasync function handlePaymentSuccess(payment: any) {\r\n    try {\r\n        console.log(\"Processing successful payment:\", payment.id);\r\n\r\n        // Update payment record\r\n        await prisma.payment.updateMany({\r\n            where: { razorpayOrderId: payment.order_id },\r\n            data: {\r\n                razorpayPaymentId: payment.id,\r\n                status: \"COMPLETED\",\r\n            },\r\n        });\r\n\r\n        console.log(\"Payment record updated successfully\");\r\n    } catch (error) {\r\n        console.error(\"Error handling payment success:\", error);\r\n    }\r\n}\r\n\r\nasync function handlePaymentFailed(payment: any) {\r\n    try {\r\n        console.log(\"Processing failed payment:\", payment.id);\r\n\r\n        // Update payment record\r\n        await prisma.payment.updateMany({\r\n            where: { razorpayOrderId: payment.order_id },\r\n            data: {\r\n                razorpayPaymentId: payment.id,\r\n                status: \"FAILED\",\r\n            },\r\n        });\r\n\r\n        console.log(\"Payment failure recorded\");\r\n    } catch (error) {\r\n        console.error(\"Error handling payment failure:\", error);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\auth-url\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\callback\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'createError' is defined but never used.","line":49,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1928,1931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1928,1931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6380,6383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6380,6383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const searchParams = request.nextUrl.searchParams;\r\n        const code = searchParams.get(\"code\");\r\n        const state = searchParams.get(\"state\");\r\n        const error = searchParams.get(\"error\");\r\n\r\n        if (error) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=\" + error, request.url));\r\n        }\r\n\r\n        if (!code || !state) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=missing_params\", request.url));\r\n        }\r\n\r\n        const platform = state.split(\"_\")[0];\r\n        const stateUserId = state.substring(platform.length + 1);\r\n\r\n        if (!stateUserId) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=invalid_state\", request.url));\r\n        }\r\n\r\n        let user = await prisma.user.findUnique({\r\n            where: { clerkId: stateUserId }\r\n        });\r\n\r\n        if (!user) {\r\n            try {\r\n                const { clerkClient } = await import(\"@clerk/nextjs/server\");\r\n                const client = await clerkClient();\r\n                const clerkUser = await client.users.getUser(stateUserId);\r\n\r\n                if (!clerkUser) {\r\n                    return NextResponse.redirect(new URL(\"/organisation/settings?error=user_not_found\", request.url));\r\n                }\r\n\r\n                user = await prisma.user.create({\r\n                    data: {\r\n                        clerkId: stateUserId,\r\n                        email: clerkUser.emailAddresses[0]?.emailAddress || \"\",\r\n                        firstName: clerkUser.firstName,\r\n                        lastName: clerkUser.lastName,\r\n                        role: \"ORGANISATION_USER\",\r\n                    },\r\n                });\r\n            } catch (createError: any) {\r\n                return NextResponse.redirect(new URL(\"/organisation/settings?error=user_creation_failed\", request.url));\r\n            }\r\n        }\r\n\r\n        const clientIdConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_CLIENT_ID` }\r\n        });\r\n        const clientSecretConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_CLIENT_SECRET` }\r\n        });\r\n        const redirectUriConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_REDIRECT_URI` }\r\n        });\r\n\r\n        const redirectUri = redirectUriConfig?.value || `${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/auth-callback`;\r\n\r\n        if (!clientIdConfig?.value || !clientSecretConfig?.value) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=config_missing\", request.url));\r\n        }\r\n\r\n        let accessToken = \"\";\r\n        let refreshToken = \"\";\r\n        let expiresIn = 0;\r\n\r\n        if (platform === \"FACEBOOK\" || platform === \"INSTAGRAM\") {\r\n            const tokenUrl = `https://graph.facebook.com/v18.0/oauth/access_token?client_id=${clientIdConfig.value}&redirect_uri=${encodeURIComponent(redirectUri)}&client_secret=${clientSecretConfig.value}&code=${code}`;\r\n            const res = await fetch(tokenUrl);\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.error.message);\r\n            accessToken = data.access_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"LINKEDIN\") {\r\n            const tokenUrl = \"https://www.linkedin.com/oauth/v2/accessToken\";\r\n            const params = new URLSearchParams();\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n            params.append(\"code\", code);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n            params.append(\"client_id\", clientIdConfig.value);\r\n            params.append(\"client_secret\", clientSecretConfig.value);\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.error_description);\r\n            accessToken = data.access_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"YOUTUBE\") {\r\n            const tokenUrl = \"https://oauth2.googleapis.com/token\";\r\n            const params = new URLSearchParams();\r\n            params.append(\"code\", code);\r\n            params.append(\"client_id\", clientIdConfig.value);\r\n            params.append(\"client_secret\", clientSecretConfig.value);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.error_description);\r\n            accessToken = data.access_token;\r\n            refreshToken = data.refresh_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"PINTEREST\") {\r\n            const tokenUrl = \"https://api.pinterest.com/v5/oauth/token\";\r\n            const authHeader = Buffer.from(`${clientIdConfig.value}:${clientSecretConfig.value}`).toString('base64');\r\n            const params = new URLSearchParams();\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n            params.append(\"code\", code);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Authorization\": `Basic ${authHeader}`,\r\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n                },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.message);\r\n            accessToken = data.access_token;\r\n            refreshToken = data.refresh_token;\r\n            expiresIn = data.expires_in;\r\n        }\r\n\r\n        const updateData: any = {};\r\n        if (platform === \"FACEBOOK\") {\r\n            updateData.facebookAccessToken = accessToken;\r\n            updateData.facebookTokenExpiresIn = expiresIn;\r\n            updateData.facebookTokenCreatedAt = new Date();\r\n\r\n            try {\r\n                const meRes = await fetch(`https://graph.facebook.com/me?access_token=${accessToken}`);\r\n                const meData = await meRes.json();\r\n                if (meData.id) {\r\n                    updateData.facebookUserId = meData.id;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch Facebook User ID\", e);\r\n            }\r\n        } else if (platform === \"INSTAGRAM\") {\r\n            updateData.instagramAccessToken = accessToken;\r\n            updateData.instagramTokenExpiresIn = expiresIn;\r\n            updateData.instagramTokenCreatedAt = new Date();\r\n\r\n            try {\r\n                const meRes = await fetch(`https://graph.facebook.com/me?access_token=${accessToken}`);\r\n                const meData = await meRes.json();\r\n                if (meData.id) {\r\n                    updateData.instagramUserId = meData.id;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch Instagram User ID\", e);\r\n            }\r\n        } else if (platform === \"LINKEDIN\") {\r\n            updateData.linkedInAccessToken = accessToken;\r\n            try {\r\n                const profileRes = await fetch(\"https://api.linkedin.com/v2/me\", {\r\n                    headers: { Authorization: `Bearer ${accessToken}` },\r\n                });\r\n                const profileData = await profileRes.json();\r\n                if (profileData.id) {\r\n                    updateData.linkedInAuthUrn = profileData.id;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch LinkedIn Profile\", e);\r\n            }\r\n        } else if (platform === \"YOUTUBE\") {\r\n            updateData.youtubeAccessToken = accessToken;\r\n            if (refreshToken) {\r\n                updateData.youtubeAuthUrn = refreshToken;\r\n            }\r\n        } else if (platform === \"PINTEREST\") {\r\n            updateData.pinterestAccessToken = accessToken;\r\n            if (refreshToken) {\r\n                updateData.pinterestAuthUrn = refreshToken;\r\n            }\r\n        }\r\n\r\n        await prisma.user.update({\r\n            where: { clerkId: stateUserId },\r\n            data: updateData,\r\n        });\r\n\r\n        return NextResponse.redirect(new URL(\"/organisation/settings?success=connected\", request.url));\r\n    } catch (error) {\r\n        console.error(\"Error in callback:\", error);\r\n        return NextResponse.redirect(new URL(\"/organisation/settings?error=connection_failed\", request.url));\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\disconnect\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[609,612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[609,612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { userId } = await auth();\r\n        if (!userId) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { platform } = body;\r\n\r\n        if (!platform) {\r\n            return NextResponse.json({ error: \"Platform is required\" }, { status: 400 });\r\n        }\r\n\r\n        const updateData: any = {};\r\n        if (platform === \"FACEBOOK\") {\r\n            updateData.facebookAccessToken = null;\r\n            updateData.facebookPageAccessToken = null;\r\n            updateData.facebookPageId = null;\r\n            updateData.facebookUserId = null;\r\n        } else if (platform === \"INSTAGRAM\") {\r\n            updateData.instagramAccessToken = null;\r\n            updateData.instagramUserId = null;\r\n        } else if (platform === \"LINKEDIN\") {\r\n            updateData.linkedInAccessToken = null;\r\n            updateData.linkedInAuthUrn = null;\r\n        } else if (platform === \"YOUTUBE\") {\r\n            updateData.youtubeAccessToken = null;\r\n            updateData.youtubeAuthUrn = null;\r\n        } else if (platform === \"PINTEREST\") {\r\n            updateData.pinterestAccessToken = null;\r\n            updateData.pinterestAuthUrn = null;\r\n        }\r\n\r\n        await prisma.user.update({\r\n            where: { clerkId: userId },\r\n            data: updateData\r\n        });\r\n\r\n        return NextResponse.json({ success: true });\r\n    } catch (error) {\r\n        console.error(\"Error disconnecting platform:\", error);\r\n        return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\linkedin\\pages\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\pinterest\\boards\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\socialmedia\\upload-media-file\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":73,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\r\nimport { put } from '@vercel/blob';\r\nimport { writeFile, mkdir } from \"fs/promises\";\r\nimport path from \"path\";\r\nimport crypto from \"crypto\";\r\n\r\n// File size limits (in bytes)\r\nconst MAX_IMAGE_SIZE = 10 * 1024 * 1024; // 10MB for images\r\nconst MAX_VIDEO_SIZE = 100 * 1024 * 1024; // 100MB for videos\r\n\r\n// Allowed file types\r\nconst ALLOWED_IMAGE_TYPES = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];\r\nconst ALLOWED_VIDEO_TYPES = ['video/mp4', 'video/quicktime', 'video/webm', 'video/x-msvideo'];\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const formData = await request.formData();\r\n        const file = formData.get(\"file\") as File;\r\n\r\n        if (!file) {\r\n            return NextResponse.json({ error: \"No file uploaded\" }, { status: 400 });\r\n        }\r\n\r\n        // Validate file type\r\n        const isImage = ALLOWED_IMAGE_TYPES.includes(file.type);\r\n        const isVideo = ALLOWED_VIDEO_TYPES.includes(file.type);\r\n\r\n        if (!isImage && !isVideo) {\r\n            return NextResponse.json({\r\n                error: \"Invalid file type. Allowed: JPG, PNG, GIF, WebP, MP4, MOV, WebM\"\r\n            }, { status: 400 });\r\n        }\r\n\r\n        // Validate file size\r\n        const maxSize = isVideo ? MAX_VIDEO_SIZE : MAX_IMAGE_SIZE;\r\n        if (file.size > maxSize) {\r\n            const maxSizeMB = maxSize / (1024 * 1024);\r\n            return NextResponse.json({\r\n                error: `File too large. Maximum size: ${maxSizeMB}MB`\r\n            }, { status: 400 });\r\n        }\r\n\r\n        // Generate unique filename\r\n        const fileExtension = file.name.split('.').pop();\r\n        const filename = `${crypto.randomUUID()}.${fileExtension}`;\r\n\r\n        // Check if we're in production (Vercel) or development (localhost)\r\n        const isProduction = process.env.VERCEL === '1' || process.env.BLOB_READ_WRITE_TOKEN;\r\n\r\n        let url: string;\r\n\r\n        if (isProduction && process.env.BLOB_READ_WRITE_TOKEN) {\r\n            // Production: Use Vercel Blob\r\n            console.log('[Upload] Using Vercel Blob storage');\r\n\r\n            const blob = await put(filename, file, {\r\n                access: 'public',\r\n                addRandomSuffix: false,\r\n            });\r\n\r\n            url = blob.url;\r\n            console.log('[Upload] File uploaded to Vercel Blob:', url);\r\n\r\n        } else {\r\n            // Development: Use local filesystem\r\n            console.log('[Upload] Using local filesystem storage');\r\n\r\n            const buffer = Buffer.from(await file.arrayBuffer());\r\n            const uploadDir = path.join(process.cwd(), \"public\", \"uploads\");\r\n\r\n            try {\r\n                await mkdir(uploadDir, { recursive: true });\r\n            } catch (e) {\r\n                // Directory already exists\r\n            }\r\n\r\n            const filepath = path.join(uploadDir, filename);\r\n            await writeFile(filepath, buffer);\r\n\r\n            // Return relative URL for localhost\r\n            url = `/uploads/${filename}`;\r\n            console.log('[Upload] File uploaded to local storage:', url);\r\n        }\r\n\r\n        return NextResponse.json({\r\n            url,\r\n            filename,\r\n            size: file.size,\r\n            type: file.type,\r\n            isImage,\r\n            isVideo\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error uploading file:\", error);\r\n        return NextResponse.json({\r\n            error: error instanceof Error ? error.message : \"Upload failed\"\r\n        }, { status: 500 });\r\n    }\r\n}\r\n\r\n// Optional: Add GET endpoint to retrieve upload info\r\nexport async function GET() {\r\n    return NextResponse.json({\r\n        maxImageSize: MAX_IMAGE_SIZE,\r\n        maxVideoSize: MAX_VIDEO_SIZE,\r\n        allowedImageTypes: ALLOWED_IMAGE_TYPES,\r\n        allowedVideoTypes: ALLOWED_VIDEO_TYPES,\r\n        storage: process.env.BLOB_READ_WRITE_TOKEN ? 'vercel-blob' : 'local-filesystem'\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\templates\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\templates\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1007,1010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1007,1010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { currentUser } from \"@clerk/nextjs/server\";\r\nimport { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\n// GET: List all templates for the organization\r\nexport async function GET(req: Request) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n            include: { organisation: true }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: \"No organization found\" }, { status: 404 });\r\n        }\r\n\r\n        const { searchParams } = new URL(req.url);\r\n        const platform = searchParams.get(\"platform\");\r\n        const category = searchParams.get(\"category\");\r\n        const search = searchParams.get(\"search\");\r\n        const isActive = searchParams.get(\"isActive\");\r\n\r\n        const whereClause: any = {\r\n            organisationId: dbUser.organisationId\r\n        };\r\n\r\n        if (platform) {\r\n            whereClause.platform = platform;\r\n        }\r\n\r\n        if (category) {\r\n            whereClause.category = category;\r\n        }\r\n\r\n        if (search) {\r\n            whereClause.OR = [\r\n                { name: { contains: search, mode: \"insensitive\" } },\r\n                { description: { contains: search, mode: \"insensitive\" } },\r\n                { content: { contains: search, mode: \"insensitive\" } }\r\n            ];\r\n        }\r\n\r\n        if (isActive !== null && isActive !== undefined) {\r\n            whereClause.isActive = isActive === \"true\";\r\n        }\r\n\r\n        const templates = await prisma.messageTemplate.findMany({\r\n            where: whereClause,\r\n            orderBy: { createdAt: \"desc\" }\r\n        });\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            data: templates\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error fetching templates:\", error);\r\n        return NextResponse.json(\r\n            { error: \"Failed to fetch templates\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\n// POST: Create a new template\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id }\r\n        });\r\n\r\n        if (!dbUser?.organisationId) {\r\n            return NextResponse.json({ error: \"No organization found\" }, { status: 404 });\r\n        }\r\n\r\n        const body = await req.json();\r\n        const { name, description, content, subject, platform, category, variables, isActive } = body;\r\n\r\n        if (!name || !content || !platform) {\r\n            return NextResponse.json(\r\n                { error: \"Name, content, and platform are required\" },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const template = await prisma.messageTemplate.create({\r\n            data: {\r\n                name,\r\n                description,\r\n                content,\r\n                subject,\r\n                platform,\r\n                category: category || \"CUSTOM\",\r\n                variables: variables || {},\r\n                isActive: isActive !== undefined ? isActive : true,\r\n                organisationId: dbUser.organisationId,\r\n                createdBy: user.id\r\n            }\r\n        });\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            data: template,\r\n            message: \"Template created successfully\"\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error creating template:\", error);\r\n        return NextResponse.json(\r\n            { error: \"Failed to create template\" },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\test\\clerk\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\user\\linkedin-page\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\user\\me\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\user\\social-status\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[599,602],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[599,602],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[715,718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[715,718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":46,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":63,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":118,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":118,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":138,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":138,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":157,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":157,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from \"next/server\";\r\nimport { currentUser } from \"@clerk/nextjs/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function GET() {\r\n    try {\r\n        const user = await currentUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const dbUser = await prisma.user.findUnique({\r\n            where: { clerkId: user.id },\r\n        });\r\n\r\n        if (!dbUser) {\r\n            return NextResponse.json({ error: \"User not found\" }, { status: 404 });\r\n        }\r\n\r\n        const status: any = {};\r\n\r\n        // Helper to fetch with timeout\r\n        const fetchWithTimeout = async (url: string, options: any = {}, timeout = 3000) => {\r\n            const controller = new AbortController();\r\n            const id = setTimeout(() => controller.abort(), timeout);\r\n            try {\r\n                const response = await fetch(url, { ...options, signal: controller.signal });\r\n                clearTimeout(id);\r\n                return response;\r\n            } catch (error) {\r\n                clearTimeout(id);\r\n                throw error;\r\n            }\r\n        };\r\n\r\n        // Facebook\r\n        if (dbUser.facebookAccessToken) {\r\n            try {\r\n                const res = await fetchWithTimeout(`https://graph.facebook.com/me?fields=name&access_token=${dbUser.facebookAccessToken}`);\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    status.facebook = { connected: true, name: data.name };\r\n                } else {\r\n                    status.facebook = { connected: true, name: \"Connected (Error fetching name)\" };\r\n                }\r\n            } catch (e) {\r\n                status.facebook = { connected: true, name: \"Connected\" };\r\n            }\r\n        } else {\r\n            status.facebook = { connected: false };\r\n        }\r\n\r\n        // Instagram\r\n        if (dbUser.instagramAccessToken) {\r\n            try {\r\n                const res = await fetchWithTimeout(`https://graph.instagram.com/me?fields=username&access_token=${dbUser.instagramAccessToken}`);\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    status.instagram = { connected: true, name: data.username };\r\n                } else {\r\n                    status.instagram = { connected: true, name: \"Connected\" };\r\n                }\r\n            } catch (e) {\r\n                status.instagram = { connected: true, name: \"Connected\" };\r\n            }\r\n        } else {\r\n            status.instagram = { connected: false };\r\n        }\r\n\r\n        // LinkedIn\r\n        if (dbUser.linkedInAccessToken) {\r\n            try {\r\n                let name = \"Connected\";\r\n                let followerCount: number | null = null;\r\n                const urn = dbUser.linkedInAuthUrn;\r\n\r\n                if (urn && urn.startsWith(\"urn:li:organization:\")) {\r\n                    const orgId = urn.split(\":\").pop();\r\n                    const res = await fetchWithTimeout(`https://api.linkedin.com/v2/organizations/${orgId}`, {\r\n                        headers: {\r\n                            Authorization: `Bearer ${dbUser.linkedInAccessToken}`,\r\n                            \"X-Restli-Protocol-Version\": \"2.0.0\"\r\n                        }\r\n                    });\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        name = data.localizedName;\r\n                    }\r\n\r\n                    // Fetch followers\r\n                    try {\r\n                        const followersRes = await fetchWithTimeout(`https://api.linkedin.com/v2/networkSizes/${urn}?edgeType=CompanyFollowedByMember`, {\r\n                            headers: {\r\n                                Authorization: `Bearer ${dbUser.linkedInAccessToken}`,\r\n                                \"X-Restli-Protocol-Version\": \"2.0.0\"\r\n                            }\r\n                        });\r\n                        if (followersRes.ok) {\r\n                            const followersData = await followersRes.json();\r\n                            followerCount = followersData.firstDegreeSize;\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(\"Error fetching followers\", e);\r\n                    }\r\n                } else {\r\n                    // Default to profile\r\n                    const res = await fetchWithTimeout(`https://api.linkedin.com/v2/me`, {\r\n                        headers: { Authorization: `Bearer ${dbUser.linkedInAccessToken}` }\r\n                    });\r\n                    if (res.ok) {\r\n                        const data = await res.json();\r\n                        const firstName = data.localizedFirstName;\r\n                        const lastName = data.localizedLastName;\r\n                        name = `${firstName} ${lastName}`;\r\n                    }\r\n                }\r\n                status.linkedin = { connected: true, name, followerCount };\r\n            } catch (e) {\r\n                status.linkedin = { connected: true, name: \"Connected\" };\r\n            }\r\n        } else {\r\n            status.linkedin = { connected: false };\r\n        }\r\n\r\n        // YouTube\r\n        if (dbUser.youtubeAccessToken) {\r\n            try {\r\n                const res = await fetchWithTimeout(`https://www.googleapis.com/youtube/v3/channels?part=snippet&mine=true`, {\r\n                    headers: { Authorization: `Bearer ${dbUser.youtubeAccessToken}` }\r\n                });\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    const title = data.items?.[0]?.snippet?.title;\r\n                    status.youtube = { connected: true, name: title || \"Connected\" };\r\n                } else {\r\n                    status.youtube = { connected: true, name: \"Connected\" };\r\n                }\r\n            } catch (e) {\r\n                status.youtube = { connected: true, name: \"Connected\" };\r\n            }\r\n        } else {\r\n            status.youtube = { connected: false };\r\n        }\r\n\r\n        // Pinterest\r\n        if (dbUser.pinterestAccessToken) {\r\n            try {\r\n                const res = await fetchWithTimeout(`https://api.pinterest.com/v5/user_account`, {\r\n                    headers: { Authorization: `Bearer ${dbUser.pinterestAccessToken}` }\r\n                });\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    status.pinterest = { connected: true, name: data.username };\r\n                } else {\r\n                    status.pinterest = { connected: true, name: \"Connected\" };\r\n                }\r\n            } catch (e) {\r\n                status.pinterest = { connected: true, name: \"Connected\" };\r\n            }\r\n        } else {\r\n            status.pinterest = { connected: false };\r\n        }\r\n\r\n        return NextResponse.json(status);\r\n    } catch (error) {\r\n        console.error(\"Error fetching social status:\", error);\r\n        return NextResponse.json({ error: \"Internal server error\" }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\user\\sync\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\webhooks\\clerk\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'image_url' is assigned a value but never used.","line":49,"column":61,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'image_url' is assigned a value but never used.","line":120,"column":61,"nodeType":null,"messageId":"unusedVar","endLine":120,"endColumn":70}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\r\nimport { Webhook } from 'svix'\r\nimport { headers } from 'next/headers'\r\nimport { WebhookEvent } from '@clerk/nextjs/server'\r\nimport { prisma } from '@/lib/prisma'\r\n\r\nexport async function POST(req: Request) {\r\n    const WEBHOOK_SECRET = process.env.CLERK_WEBHOOK_SECRET\r\n\r\n    if (!WEBHOOK_SECRET) {\r\n        throw new Error('Please add CLERK_WEBHOOK_SECRET to .env')\r\n    }\r\n\r\n    const headerPayload = headers()\r\n    const svix_id = (await headerPayload).get(\"svix-id\")\r\n    const svix_timestamp = (await headerPayload).get(\"svix-timestamp\")\r\n    const svix_signature = (await headerPayload).get(\"svix-signature\")\r\n\r\n    if (!svix_id || !svix_timestamp || !svix_signature) {\r\n        return new Response('Error: Missing svix headers', {\r\n            status: 400\r\n        })\r\n    }\r\n\r\n    const payload = await req.json()\r\n    const body = JSON.stringify(payload)\r\n\r\n    const wh = new Webhook(WEBHOOK_SECRET)\r\n\r\n    let evt: WebhookEvent\r\n\r\n    try {\r\n        evt = wh.verify(body, {\r\n            \"svix-id\": svix_id,\r\n            \"svix-timestamp\": svix_timestamp,\r\n            \"svix-signature\": svix_signature,\r\n        }) as WebhookEvent\r\n    } catch (err) {\r\n        console.error('Error verifying webhook:', err)\r\n        return new Response('Error: Verification failed', {\r\n            status: 400\r\n        })\r\n    }\r\n\r\n    const eventType = evt.type\r\n\r\n    if (eventType === 'user.created') {\r\n        const { id, email_addresses, first_name, last_name, image_url } = evt.data\r\n\r\n        if (!email_addresses || email_addresses.length === 0) {\r\n            return new Response('Error: No email address found', { status: 400 })\r\n        }\r\n\r\n        const email = email_addresses[0].email_address\r\n\r\n        try {\r\n            const existingUser = await prisma.user.findUnique({\r\n                where: { email }\r\n            })\r\n\r\n            if (existingUser) {\r\n                const updatedUser = await prisma.user.update({\r\n                    where: { email },\r\n                    data: {\r\n                        clerkId: id,\r\n                        firstName: first_name || existingUser.firstName,\r\n                        lastName: last_name || existingUser.lastName,\r\n                    }\r\n                })\r\n                console.log('User linked:', updatedUser.email)\r\n\r\n                await prisma.logEvents.create({\r\n                    data: {\r\n                        message: `User linked via Clerk: ${updatedUser.email}`,\r\n                        level: 'Info',\r\n                        timeStamp: new Date(),\r\n                        properties: JSON.stringify({\r\n                            action: 'user_linked',\r\n                            userId: updatedUser.id,\r\n                        })\r\n                    }\r\n                })\r\n\r\n                return new Response('User linked successfully', { status: 200 })\r\n            }\r\n\r\n            const user = await prisma.user.create({\r\n                data: {\r\n                    clerkId: id,\r\n                    email: email,\r\n                    firstName: first_name || null,\r\n                    lastName: last_name || null,\r\n                    role: 'ORGANISATION_USER', \r\n                }\r\n            })\r\n\r\n            console.log('User created:', user.email)\r\n\r\n            await prisma.logEvents.create({\r\n                data: {\r\n                    message: `New user signed up: ${user.email}`,\r\n                    level: 'Info',\r\n                    timeStamp: new Date(),\r\n                    properties: JSON.stringify({\r\n                        action: 'user_signup',\r\n                        userId: user.id,\r\n                    })\r\n                }\r\n            })\r\n\r\n            return new Response('User created successfully', { status: 200 })\r\n        } catch (error) {\r\n            console.error('Failed to create/link user:', error)\r\n            return new Response('Error creating/linking user', { status: 500 })\r\n        }\r\n    }\r\n\r\n    if (eventType === 'user.updated') {\r\n        const { id, email_addresses, first_name, last_name, image_url } = evt.data\r\n\r\n        try {\r\n            const user = await prisma.user.update({\r\n                where: { clerkId: id },\r\n                data: {\r\n                    email: email_addresses[0].email_address,\r\n                    firstName: first_name || null,\r\n                    lastName: last_name || null,\r\n                }\r\n            })\r\n\r\n            console.log('User updated:', user.email)\r\n\r\n            return new Response('User updated successfully', { status: 200 })\r\n        } catch (error) {\r\n            console.error('Failed to update user:', error)\r\n            return new Response('Error updating user', { status: 500 })\r\n        }\r\n    }\r\n\r\n    if (eventType === 'user.deleted') {\r\n        const { id } = evt.data\r\n\r\n        try {\r\n         \r\n            await prisma.user.delete({\r\n                where: { clerkId: id as string }\r\n            })\r\n\r\n            console.log('User deleted:', id)\r\n\r\n            return new Response('User deleted successfully', { status: 200 })\r\n        } catch (error) {\r\n            console.error('Failed to delete user:', error)\r\n            return new Response('Error deleting user', { status: 500 })\r\n        }\r\n    }\r\n\r\n    return new Response('Webhook received', { status: 200 })\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\webhooks\\mailgun\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\api\\webhooks\\twilio\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\auth-callback\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2452,2455],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2452,2455],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":177,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7881,7884],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7881,7884],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const searchParams = request.nextUrl.searchParams;\r\n        const code = searchParams.get(\"code\");\r\n        const state = searchParams.get(\"state\");\r\n        const error = searchParams.get(\"error\");\r\n\r\n        if (error) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=\" + error, request.url));\r\n        }\r\n\r\n        if (!code || !state) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=missing_params\", request.url));\r\n        }\r\n\r\n        const platform = state.split(\"_\")[0];\r\n        const stateUserId = state.substring(platform.length + 1);\r\n\r\n        console.log(\" OAuth Callback Received:\", {\r\n            platform,\r\n            stateUserId: stateUserId?.substring(0, 10) + \"...\",\r\n            hasCode: !!code,\r\n        });\r\n\r\n        if (!stateUserId) {\r\n            console.error(\" No user ID in state parameter\");\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=invalid_state\", request.url));\r\n        }\r\n\r\n        let user = await prisma.user.findUnique({\r\n            where: { clerkId: stateUserId }\r\n        });\r\n\r\n        if (!user) {\r\n            console.log(\"  User not found in database, fetching from Clerk and creating...\");\r\n\r\n            try {\r\n                const { clerkClient } = await import(\"@clerk/nextjs/server\");\r\n                const client = await clerkClient();\r\n                const clerkUser = await client.users.getUser(stateUserId);\r\n\r\n                if (!clerkUser) {\r\n                    console.error(\" User not found in Clerk either:\", { stateUserId });\r\n                    return NextResponse.redirect(new URL(\"/organisation/settings?error=user_not_found\", request.url));\r\n                }\r\n\r\n                user = await prisma.user.create({\r\n                    data: {\r\n                        clerkId: stateUserId,\r\n                        email: clerkUser.emailAddresses[0]?.emailAddress || \"\",\r\n                        firstName: clerkUser.firstName,\r\n                        lastName: clerkUser.lastName,\r\n                        role: \"ORGANISATION_USER\",\r\n                    },\r\n                });\r\n\r\n                console.log(\" User created in database:\", { email: user.email });\r\n            } catch (createError: any) {\r\n                console.error(\" Failed to create user:\", createError);\r\n                return NextResponse.redirect(new URL(\"/organisation/settings?error=user_creation_failed\", request.url));\r\n            }\r\n        }\r\n\r\n        console.log(\" User verified:\", { email: user.email });\r\n\r\n        // Get config\r\n        const clientIdConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_CLIENT_ID` }\r\n        });\r\n        const clientSecretConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_CLIENT_SECRET` }\r\n        });\r\n        const redirectUriConfig = await prisma.adminPlatformConfiguration.findFirst({\r\n            where: { key: `${platform}_REDIRECT_URI` }\r\n        });\r\n\r\n        const redirectUri = redirectUriConfig?.value || `${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/auth-callback`;\r\n\r\n        if (!clientIdConfig?.value || !clientSecretConfig?.value) {\r\n            return NextResponse.redirect(new URL(\"/organisation/settings?error=config_missing\", request.url));\r\n        }\r\n\r\n        let accessToken = \"\";\r\n        let refreshToken = \"\";\r\n        let expiresIn = 0;\r\n\r\n        // Exchange code for token\r\n        if (platform === \"FACEBOOK\" || platform === \"INSTAGRAM\") {\r\n            const tokenUrl = `https://graph.facebook.com/v18.0/oauth/access_token?client_id=${clientIdConfig.value}&redirect_uri=${encodeURIComponent(redirectUri)}&client_secret=${clientSecretConfig.value}&code=${code}`;\r\n            const res = await fetch(tokenUrl);\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.error.message);\r\n            accessToken = data.access_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"LINKEDIN\") {\r\n            const tokenUrl = \"https://www.linkedin.com/oauth/v2/accessToken\";\r\n            const params = new URLSearchParams();\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n            params.append(\"code\", code);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n            params.append(\"client_id\", clientIdConfig.value);\r\n            params.append(\"client_secret\", clientSecretConfig.value);\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.error_description);\r\n            accessToken = data.access_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"YOUTUBE\") {\r\n            const tokenUrl = \"https://oauth2.googleapis.com/token\";\r\n            const params = new URLSearchParams();\r\n            params.append(\"code\", code);\r\n            params.append(\"client_id\", clientIdConfig.value);\r\n            params.append(\"client_secret\", clientSecretConfig.value);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n\r\n            console.log(\" YouTube Token Exchange - Request:\", {\r\n                tokenUrl,\r\n                redirectUri,\r\n                clientId: clientIdConfig.value.substring(0, 10) + \"...\",\r\n            });\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n\r\n            console.log(\" YouTube Token Exchange - Response:\", {\r\n                hasAccessToken: !!data.access_token,\r\n                hasRefreshToken: !!data.refresh_token,\r\n                expiresIn: data.expires_in,\r\n                error: data.error,\r\n            });\r\n\r\n            if (data.error) throw new Error(data.error_description || data.error);\r\n            accessToken = data.access_token;\r\n            refreshToken = data.refresh_token;\r\n            expiresIn = data.expires_in;\r\n        } else if (platform === \"PINTEREST\") {\r\n            // Pinterest token exchange\r\n            // POST https://api.pinterest.com/v5/oauth/token\r\n            // Authorization: Basic <base64(client_id:client_secret)>\r\n            // grant_type=authorization_code&code=...&redirect_uri=...\r\n            const tokenUrl = \"https://api.pinterest.com/v5/oauth/token\";\r\n            const authHeader = Buffer.from(`${clientIdConfig.value}:${clientSecretConfig.value}`).toString('base64');\r\n            const params = new URLSearchParams();\r\n            params.append(\"grant_type\", \"authorization_code\");\r\n            params.append(\"code\", code);\r\n            params.append(\"redirect_uri\", redirectUri);\r\n\r\n            const res = await fetch(tokenUrl, {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Authorization\": `Basic ${authHeader}`,\r\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n                },\r\n                body: params,\r\n            });\r\n            const data = await res.json();\r\n            if (data.error) throw new Error(data.message);\r\n            accessToken = data.access_token;\r\n            refreshToken = data.refresh_token;\r\n            expiresIn = data.expires_in;\r\n        }\r\n\r\n        // Save to DB\r\n        const updateData: any = {};\r\n        if (platform === \"FACEBOOK\") {\r\n            updateData.facebookAccessToken = accessToken;\r\n            updateData.facebookTokenExpiresIn = expiresIn;\r\n            updateData.facebookTokenCreatedAt = new Date();\r\n\r\n            // Fetch Facebook Pages and Page Access Token\r\n            try {\r\n                // First, get user's pages\r\n                const pagesRes = await fetch(`https://graph.facebook.com/me/accounts?access_token=${accessToken}`);\r\n                const pagesData = await pagesRes.json();\r\n\r\n                console.log(\" Facebook Pages Response:\", pagesData);\r\n\r\n                if (pagesData.data && pagesData.data.length > 0) {\r\n                    // Use the first page (you can later let users select which page)\r\n                    const firstPage = pagesData.data[0];\r\n\r\n                    updateData.facebookPageId = firstPage.id;\r\n                    updateData.facebookPageAccessToken = firstPage.access_token; // Page-specific token\r\n                    updateData.facebookUserId = firstPage.id; // Store page ID here too\r\n\r\n                    console.log(\" Facebook Page Connected:\", {\r\n                        pageId: firstPage.id,\r\n                        pageName: firstPage.name,\r\n                        hasPageToken: !!firstPage.access_token\r\n                    });\r\n                } else {\r\n                    console.warn(\"  No Facebook Pages found for this user\");\r\n                    // Still save the user token, but warn that no pages are available\r\n                    updateData.facebookUserId = \"no-pages\";\r\n                }\r\n            } catch (e) {\r\n                console.error(\" Failed to fetch Facebook Pages:\", e);\r\n            }\r\n        } else if (platform === \"INSTAGRAM\") {\r\n            // For Instagram Business/Creator accounts (via Facebook Graph API)\r\n            // We need to find the Instagram Business Account connected to a Facebook Page\r\n\r\n            try {\r\n                // Fetch user's pages with connected Instagram accounts\r\n                const pagesRes = await fetch(`https://graph.facebook.com/v18.0/me/accounts?fields=id,name,access_token,instagram_business_account&access_token=${accessToken}`);\r\n                const pagesData = await pagesRes.json();\r\n\r\n                console.log(\" Instagram/Facebook Pages Response:\", JSON.stringify(pagesData));\r\n\r\n                let instagramAccountFound = false;\r\n\r\n                if (pagesData.data && pagesData.data.length > 0) {\r\n                    // Find the first page with a connected Instagram Business Account\r\n                    for (const page of pagesData.data) {\r\n                        if (page.instagram_business_account) {\r\n                            updateData.instagramUserId = page.instagram_business_account.id;\r\n                            updateData.instagramAccessToken = page.access_token; // Use Page Token for Instagram API\r\n                            updateData.instagramTokenExpiresIn = expiresIn; // This is from user token, but page tokens are long-lived usually\r\n                            updateData.instagramTokenCreatedAt = new Date();\r\n\r\n                            console.log(\" Instagram Business Account Connected:\", {\r\n                                instagramId: page.instagram_business_account.id,\r\n                                pageId: page.id,\r\n                                pageName: page.name\r\n                            });\r\n\r\n                            instagramAccountFound = true;\r\n                            break; // Stop after finding the first one\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (!instagramAccountFound) {\r\n                    console.warn(\"  No Instagram Business Account found connected to any Facebook Page\");\r\n                    // Fallback: Just save the user token, but posting will likely fail\r\n                    updateData.instagramAccessToken = accessToken;\r\n                    updateData.instagramUserId = \"no-business-account\";\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error(\" Failed to fetch Instagram Business Account:\", e);\r\n                // Fallback\r\n                updateData.instagramAccessToken = accessToken;\r\n            }\r\n        } else if (platform === \"LINKEDIN\") {\r\n            updateData.linkedInAccessToken = accessToken;\r\n            // LinkedIn tokens are usually 60 days\r\n\r\n            // Fetch LinkedIn Member ID (URN)\r\n            try {\r\n                const profileRes = await fetch(\"https://api.linkedin.com/v2/me\", {\r\n                    headers: { Authorization: `Bearer ${accessToken}` },\r\n                });\r\n                const profileData = await profileRes.json();\r\n                if (profileData.id) {\r\n                    updateData.linkedInAuthUrn = profileData.id;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch LinkedIn Profile\", e);\r\n            }\r\n        } else if (platform === \"YOUTUBE\") {\r\n            updateData.youtubeAccessToken = accessToken;\r\n            // Store refresh token in youtubeAuthUrn field for token refresh capability\r\n            if (refreshToken) {\r\n                updateData.youtubeAuthUrn = refreshToken;\r\n            }\r\n            console.log(\" YouTube Update Data:\", {\r\n                hasAccessToken: !!updateData.youtubeAccessToken,\r\n                hasRefreshToken: !!updateData.youtubeAuthUrn,\r\n                accessTokenLength: updateData.youtubeAccessToken?.length,\r\n            });\r\n        } else if (platform === \"PINTEREST\") {\r\n            updateData.pinterestAccessToken = accessToken;\r\n            // Store refresh token if available\r\n            if (refreshToken) {\r\n                updateData.pinterestAuthUrn = refreshToken;\r\n            }\r\n        }\r\n\r\n\r\n        console.log(\" Updating user:\", {\r\n            clerkId: stateUserId,\r\n            platform,\r\n            updateFields: Object.keys(updateData),\r\n        });\r\n\r\n        const updatedUser = await prisma.user.update({\r\n            where: { clerkId: stateUserId },\r\n            data: updateData,\r\n        });\r\n\r\n        console.log(\" User updated successfully:\", {\r\n            platform,\r\n            youtubeAccessToken: updatedUser.youtubeAccessToken ? \"SET\" : \"NULL\",\r\n            youtubeAuthUrn: updatedUser.youtubeAuthUrn ? \"SET\" : \"NULL\",\r\n        });\r\n\r\n        return NextResponse.redirect(new URL(\"/organisation/settings?success=connected\", request.url));\r\n    } catch (error) {\r\n        console.error(\" Error in callback:\", error);\r\n        return NextResponse.redirect(new URL(\"/organisation/settings?error=connection_failed\", request.url));\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\auth\\after-signin\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\contacts\\[id]\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\contacts\\import\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleFileSelect'. Either include it or remove the dependency array.","line":82,"column":8,"nodeType":"ArrayExpression","endLine":82,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [handleFileSelect]","fix":{"range":[2540,2542],"text":"[handleFileSelect]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":397,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[17351,17438],"text":"\r\n                            Here&apos;s a summary of your import\r\n                        "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[17351,17438],"text":"\r\n                            Here&lsquo;s a summary of your import\r\n                        "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[17351,17438],"text":"\r\n                            Here&#39;s a summary of your import\r\n                        "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[17351,17438],"text":"\r\n                            Here&rsquo;s a summary of your import\r\n                        "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport { Upload, Download, FileText, CheckCircle, XCircle, AlertCircle, ArrowLeft, Loader2 } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { Header } from '@/components/Header';\r\nimport { Sidebar } from '@/components/Sidebar';\r\n\r\ninterface CSVRow {\r\n    contactName?: string;\r\n    contactEmail?: string;\r\n    contactMobile?: string;\r\n    contactWhatsApp?: string;\r\n    campaigns?: string;\r\n}\r\n\r\ninterface ValidationError {\r\n    row: number;\r\n    field: string;\r\n    message: string;\r\n    data: CSVRow;\r\n}\r\n\r\ninterface ImportResult {\r\n    success: number;\r\n    failed: number;\r\n    duplicates: number;\r\n    errors: ValidationError[];\r\n}\r\n\r\nexport default function ImportContactsPage() {\r\n    const router = useRouter();\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [preview, setPreview] = useState<CSVRow[]>([]);\r\n    const [importing, setImporting] = useState(false);\r\n    const [importProgress, setImportProgress] = useState(0);\r\n    const [importResult, setImportResult] = useState<ImportResult | null>(null);\r\n    const [showResultDialog, setShowResultDialog] = useState(false);\r\n    const [dragActive, setDragActive] = useState(false);\r\n\r\n    const handleDrag = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (e.type === 'dragenter' || e.type === 'dragover') {\r\n            setDragActive(true);\r\n        } else if (e.type === 'dragleave') {\r\n            setDragActive(false);\r\n        }\r\n    }, []);\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setDragActive(false);\r\n\r\n        if (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n            handleFileSelect(e.dataTransfer.files[0]);\r\n        }\r\n    }, []);\r\n\r\n    const handleFileSelect = async (selectedFile: File) => {\r\n        if (!selectedFile.name.endsWith('.csv')) {\r\n            toast.error('Please select a CSV file');\r\n            return;\r\n        }\r\n\r\n        setFile(selectedFile);\r\n\r\n        // Parse and preview first 10 rows\r\n        try {\r\n            const text = await selectedFile.text();\r\n            const rows = parseCSV(text);\r\n            setPreview(rows.slice(0, 10));\r\n            toast.success('File loaded successfully');\r\n        } catch (error) {\r\n            console.error('Error parsing CSV:', error);\r\n            toast.error('Failed to parse CSV file');\r\n        }\r\n    };\r\n\r\n    const parseCSV = (csvText: string): CSVRow[] => {\r\n        const lines = csvText.split('\\n').filter(line => line.trim());\r\n        if (lines.length === 0) return [];\r\n\r\n        const headers = lines[0].split(',').map(h => h.trim().toLowerCase());\r\n        const rows: CSVRow[] = [];\r\n\r\n        for (let i = 1; i < lines.length; i++) {\r\n            const values = lines[i].split(',').map(v => v.trim());\r\n            const row: CSVRow = {};\r\n\r\n            headers.forEach((header, index) => {\r\n                const value = values[index] || '';\r\n\r\n                if (header.includes('name')) {\r\n                    row.contactName = value;\r\n                } else if (header.includes('email')) {\r\n                    row.contactEmail = value;\r\n                } else if (header.includes('mobile') || header.includes('phone')) {\r\n                    row.contactMobile = value;\r\n                } else if (header.includes('whatsapp')) {\r\n                    row.contactWhatsApp = value;\r\n                } else if (header.includes('campaign')) {\r\n                    row.campaigns = value;\r\n                }\r\n            });\r\n\r\n            rows.push(row);\r\n        }\r\n\r\n        return rows;\r\n    };\r\n\r\n    const handleImport = async () => {\r\n        if (!file) {\r\n            toast.error('Please select a file first');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setImporting(true);\r\n            setImportProgress(0);\r\n\r\n            const formData = new FormData();\r\n            formData.append('file', file);\r\n\r\n            // Simulate progress\r\n            const progressInterval = setInterval(() => {\r\n                setImportProgress(prev => Math.min(prev + 10, 90));\r\n            }, 200);\r\n\r\n            const response = await fetch('/api/contacts/import', {\r\n                method: 'POST',\r\n                body: formData,\r\n            });\r\n\r\n            clearInterval(progressInterval);\r\n            setImportProgress(100);\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Import failed');\r\n            }\r\n\r\n            const result: ImportResult = await response.json();\r\n            setImportResult(result);\r\n            setShowResultDialog(true);\r\n\r\n            if (result.success > 0) {\r\n                toast.success(`Successfully imported ${result.success} contacts`);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error importing contacts:', error);\r\n            toast.error('Failed to import contacts');\r\n        } finally {\r\n            setImporting(false);\r\n            setImportProgress(0);\r\n        }\r\n    };\r\n\r\n    const handleDownloadTemplate = async () => {\r\n        try {\r\n            const response = await fetch('/api/contacts/template');\r\n            const blob = await response.blob();\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = 'contacts_template.csv';\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n            document.body.removeChild(a);\r\n            toast.success('Template downloaded');\r\n        } catch (error) {\r\n            console.error('Error downloading template:', error);\r\n            toast.error('Failed to download template');\r\n        }\r\n    };\r\n\r\n    const handleDownloadErrors = () => {\r\n        if (!importResult || importResult.errors.length === 0) return;\r\n\r\n        const csvContent = [\r\n            'Row,Field,Error,Name,Email,Mobile,WhatsApp,Campaigns',\r\n            ...importResult.errors.map(err =>\r\n                `${err.row},\"${err.field}\",\"${err.message}\",\"${err.data.contactName || ''}\",\"${err.data.contactEmail || ''}\",\"${err.data.contactMobile || ''}\",\"${err.data.contactWhatsApp || ''}\",\"${err.data.campaigns || ''}\"`\r\n            )\r\n        ].join('\\n');\r\n\r\n        const blob = new Blob([csvContent], { type: 'text/csv' });\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = 'import_errors.csv';\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n        toast.success('Error report downloaded');\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-5xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"icon\"\r\n                                onClick={() => router.push('/contacts')}\r\n                            >\r\n                                <ArrowLeft className=\"size-4\" />\r\n                            </Button>\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">Import Contacts</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    Upload a CSV file to bulk import contacts\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Download Template */}\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle>Step 1: Download Template</CardTitle>\r\n                                <CardDescription>\r\n                                    Download our CSV template to ensure your data is formatted correctly\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                <Button onClick={handleDownloadTemplate} variant=\"outline\">\r\n                                    <Download className=\"size-4 mr-2\" />\r\n                                    Download CSV Template\r\n                                </Button>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* File Upload */}\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle>Step 2: Upload CSV File</CardTitle>\r\n                                <CardDescription>\r\n                                    Drag and drop your CSV file or click to browse\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                <div\r\n                                    className={`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${dragActive\r\n                                            ? 'border-primary bg-primary/5'\r\n                                            : 'border-muted-foreground/25'\r\n                                        }`}\r\n                                    onDragEnter={handleDrag}\r\n                                    onDragLeave={handleDrag}\r\n                                    onDragOver={handleDrag}\r\n                                    onDrop={handleDrop}\r\n                                >\r\n                                    <Upload className=\"size-12 mx-auto mb-4 text-muted-foreground\" />\r\n                                    <p className=\"text-lg font-medium mb-2\">\r\n                                        {file ? file.name : 'Drop your CSV file here'}\r\n                                    </p>\r\n                                    <p className=\"text-sm text-muted-foreground mb-4\">\r\n                                        or click to browse\r\n                                    </p>\r\n                                    <input\r\n                                        type=\"file\"\r\n                                        accept=\".csv\"\r\n                                        onChange={(e) => e.target.files?.[0] && handleFileSelect(e.target.files[0])}\r\n                                        className=\"hidden\"\r\n                                        id=\"file-upload\"\r\n                                    />\r\n                                    <label htmlFor=\"file-upload\">\r\n                                        <Button variant=\"outline\" asChild>\r\n                                            <span>\r\n                                                <FileText className=\"size-4 mr-2\" />\r\n                                                Browse Files\r\n                                            </span>\r\n                                        </Button>\r\n                                    </label>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Preview */}\r\n                        {preview.length > 0 && (\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Step 3: Preview Data</CardTitle>\r\n                                    <CardDescription>\r\n                                        Review the first 10 rows of your CSV file\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent>\r\n                                    <div className=\"rounded-md border overflow-x-auto\">\r\n                                        <Table>\r\n                                            <TableHeader>\r\n                                                <TableRow>\r\n                                                    <TableHead>Name</TableHead>\r\n                                                    <TableHead>Email</TableHead>\r\n                                                    <TableHead>Mobile</TableHead>\r\n                                                    <TableHead>WhatsApp</TableHead>\r\n                                                    <TableHead>Campaigns</TableHead>\r\n                                                </TableRow>\r\n                                            </TableHeader>\r\n                                            <TableBody>\r\n                                                {preview.map((row, index) => (\r\n                                                    <TableRow key={index}>\r\n                                                        <TableCell>{row.contactName || '-'}</TableCell>\r\n                                                        <TableCell>{row.contactEmail || '-'}</TableCell>\r\n                                                        <TableCell>{row.contactMobile || '-'}</TableCell>\r\n                                                        <TableCell>{row.contactWhatsApp || '-'}</TableCell>\r\n                                                        <TableCell>{row.campaigns || '-'}</TableCell>\r\n                                                    </TableRow>\r\n                                                ))}\r\n                                            </TableBody>\r\n                                        </Table>\r\n                                    </div>\r\n                                </CardContent>\r\n                            </Card>\r\n                        )}\r\n\r\n                        {/* Import Button */}\r\n                        {file && (\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Step 4: Import Contacts</CardTitle>\r\n                                    <CardDescription>\r\n                                        Click the button below to start importing your contacts\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent className=\"space-y-4\">\r\n                                    {importing && (\r\n                                        <div className=\"space-y-2\">\r\n                                            <div className=\"flex items-center justify-between text-sm\">\r\n                                                <span>Importing contacts...</span>\r\n                                                <span>{importProgress}%</span>\r\n                                            </div>\r\n                                            <Progress value={importProgress} />\r\n                                        </div>\r\n                                    )}\r\n                                    <Button\r\n                                        onClick={handleImport}\r\n                                        disabled={importing}\r\n                                        size=\"lg\"\r\n                                        className=\"w-full\"\r\n                                    >\r\n                                        {importing ? (\r\n                                            <>\r\n                                                <Loader2 className=\"size-4 mr-2 animate-spin\" />\r\n                                                Importing...\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                <Upload className=\"size-4 mr-2\" />\r\n                                                Import Contacts\r\n                                            </>\r\n                                        )}\r\n                                    </Button>\r\n                                </CardContent>\r\n                            </Card>\r\n                        )}\r\n                    </div>\r\n                </main>\r\n            </div>\r\n\r\n            {/* Import Result Dialog */}\r\n            <AlertDialog open={showResultDialog} onOpenChange={setShowResultDialog}>\r\n                <AlertDialogContent className=\"max-w-2xl\">\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Import Complete</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            Here's a summary of your import\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n\r\n                    {importResult && (\r\n                        <div className=\"space-y-4\">\r\n                            {/* Summary Cards */}\r\n                            <div className=\"grid grid-cols-3 gap-4\">\r\n                                <Card>\r\n                                    <CardContent className=\"pt-6\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <CheckCircle className=\"size-8 text-green-500\" />\r\n                                            <div>\r\n                                                <p className=\"text-2xl font-bold\">{importResult.success}</p>\r\n                                                <p className=\"text-sm text-muted-foreground\">Successful</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                                <Card>\r\n                                    <CardContent className=\"pt-6\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <XCircle className=\"size-8 text-red-500\" />\r\n                                            <div>\r\n                                                <p className=\"text-2xl font-bold\">{importResult.failed}</p>\r\n                                                <p className=\"text-sm text-muted-foreground\">Failed</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                                <Card>\r\n                                    <CardContent className=\"pt-6\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <AlertCircle className=\"size-8 text-yellow-500\" />\r\n                                            <div>\r\n                                                <p className=\"text-2xl font-bold\">{importResult.duplicates}</p>\r\n                                                <p className=\"text-sm text-muted-foreground\">Duplicates</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            </div>\r\n\r\n                            {/* Error Details */}\r\n                            {importResult.errors.length > 0 && (\r\n                                <div className=\"space-y-2\">\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <h4 className=\"font-medium\">Error Details</h4>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"outline\"\r\n                                            onClick={handleDownloadErrors}\r\n                                        >\r\n                                            <Download className=\"size-4 mr-2\" />\r\n                                            Download Error Report\r\n                                        </Button>\r\n                                    </div>\r\n                                    <div className=\"max-h-64 overflow-y-auto border rounded-lg\">\r\n                                        <Table>\r\n                                            <TableHeader>\r\n                                                <TableRow>\r\n                                                    <TableHead>Row</TableHead>\r\n                                                    <TableHead>Field</TableHead>\r\n                                                    <TableHead>Error</TableHead>\r\n                                                </TableRow>\r\n                                            </TableHeader>\r\n                                            <TableBody>\r\n                                                {importResult.errors.slice(0, 10).map((error, index) => (\r\n                                                    <TableRow key={index}>\r\n                                                        <TableCell>{error.row}</TableCell>\r\n                                                        <TableCell>\r\n                                                            <Badge variant=\"outline\">{error.field}</Badge>\r\n                                                        </TableCell>\r\n                                                        <TableCell className=\"text-sm\">{error.message}</TableCell>\r\n                                                    </TableRow>\r\n                                                ))}\r\n                                            </TableBody>\r\n                                        </Table>\r\n                                        {importResult.errors.length > 10 && (\r\n                                            <p className=\"text-sm text-muted-foreground text-center py-2\">\r\n                                                And {importResult.errors.length - 10} more errors...\r\n                                            </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => {\r\n                            setShowResultDialog(false);\r\n                            setFile(null);\r\n                            setPreview([]);\r\n                            setImportResult(null);\r\n                        }}>\r\n                            Import Another File\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction onClick={() => router.push('/contacts')}>\r\n                            View Contacts\r\n                        </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\contacts\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\contacts\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used.","line":53,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchContacts'. Either include it or remove the dependency array.","line":146,"column":8,"nodeType":"ArrayExpression","endLine":146,"endColumn":66,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, fetchContacts, itemsPerPage, searchQuery, selectedCampaign]","fix":{"range":[4423,4481],"text":"[currentPage, fetchContacts, itemsPerPage, searchQuery, selectedCampaign]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n    Search,\r\n    Download,\r\n    Trash2,\r\n    Edit,\r\n    Eye,\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    Plus,\r\n    Loader2,\r\n    Mail,\r\n    Phone,\r\n    MessageSquare,\r\n    Upload,\r\n} from 'lucide-react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\n\r\ninterface Contact {\r\n    id: number;\r\n    contactName: string | null;\r\n    contactEmail: string | null;\r\n    contactMobile: string | null;\r\n    contactWhatsApp: string | null;\r\n    createdAt: string;\r\n    updatedAt: string;\r\n    campaigns: {\r\n        id: number;\r\n        name: string;\r\n    }[];\r\n}\r\n\r\ninterface Campaign {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\nexport default function ContactListPage() {\r\n    const router = useRouter();\r\n\r\n    // State\r\n    const [contacts, setContacts] = useState<Contact[]>([]);\r\n    const [campaigns, setCampaigns] = useState<Campaign[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [selectedCampaign, setSelectedCampaign] = useState<string>('all');\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [itemsPerPage, setItemsPerPage] = useState(10);\r\n    const [totalPages, setTotalPages] = useState(1);\r\n    const [totalContacts, setTotalContacts] = useState(0);\r\n    const [selectedContacts, setSelectedContacts] = useState<number[]>([]);\r\n    const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n    const [deleteContactId, setDeleteContactId] = useState<number | null>(null);\r\n    const [showQuickView, setShowQuickView] = useState(false);\r\n    const [quickViewContact, setQuickViewContact] = useState<Contact | null>(null);\r\n    const [exporting, setExporting] = useState(false);\r\n\r\n    // Fetch contacts\r\n    const fetchContacts = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const params = new URLSearchParams({\r\n                page: currentPage.toString(),\r\n                limit: itemsPerPage.toString(),\r\n                ...(searchQuery && { search: searchQuery }),\r\n                ...(selectedCampaign !== 'all' && { campaignId: selectedCampaign }),\r\n            });\r\n\r\n            const response = await fetch(`/api/contacts?${params}`);\r\n            if (!response.ok) throw new Error('Failed to fetch contacts');\r\n\r\n            const data = await response.json();\r\n            setContacts(data.contacts);\r\n            setTotalPages(data.pagination.totalPages);\r\n            setTotalContacts(data.pagination.total);\r\n        } catch (error) {\r\n            console.error('Error fetching contacts:', error);\r\n            toast.error('Failed to fetch contacts');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Fetch campaigns for filter\r\n    const fetchCampaigns = async () => {\r\n        try {\r\n            const response = await fetch('/api/campaigns');\r\n            if (!response.ok) throw new Error('Failed to fetch campaigns');\r\n\r\n            const data = await response.json();\r\n            setCampaigns(data.campaigns || []);\r\n        } catch (error) {\r\n            console.error('Error fetching campaigns:', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchCampaigns();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchContacts();\r\n        setSelectedContacts([]);\r\n    }, [currentPage, itemsPerPage, searchQuery, selectedCampaign]);\r\n\r\n    // Handle select all\r\n    const handleSelectAll = (checked: boolean) => {\r\n        if (checked) {\r\n            setSelectedContacts(contacts.map(c => c.id));\r\n        } else {\r\n            setSelectedContacts([]);\r\n        }\r\n    };\r\n\r\n    // Handle individual select\r\n    const handleSelectContact = (contactId: number, checked: boolean) => {\r\n        if (checked) {\r\n            setSelectedContacts([...selectedContacts, contactId]);\r\n        } else {\r\n            setSelectedContacts(selectedContacts.filter(id => id !== contactId));\r\n        }\r\n    };\r\n\r\n    // Handle delete single contact\r\n    const handleDeleteContact = async (contactId: number) => {\r\n        try {\r\n            const response = await fetch(`/api/contacts/${contactId}`, {\r\n                method: 'DELETE',\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to delete contact');\r\n\r\n            toast.success('Contact deleted successfully');\r\n            fetchContacts();\r\n            setShowDeleteDialog(false);\r\n            setDeleteContactId(null);\r\n        } catch (error) {\r\n            console.error('Error deleting contact:', error);\r\n            toast.error('Failed to delete contact');\r\n        }\r\n    };\r\n\r\n    // Handle bulk delete\r\n    const handleBulkDelete = async () => {\r\n        try {\r\n            const response = await fetch('/api/contacts', {\r\n                method: 'DELETE',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ contactIds: selectedContacts }),\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to delete contacts');\r\n\r\n            const data = await response.json();\r\n            toast.success(data.message);\r\n            fetchContacts();\r\n            setSelectedContacts([]);\r\n            setShowDeleteDialog(false);\r\n        } catch (error) {\r\n            console.error('Error deleting contacts:', error);\r\n            toast.error('Failed to delete contacts');\r\n        }\r\n    };\r\n\r\n    // Handle export\r\n    const handleExport = async (exportSelected = false) => {\r\n        try {\r\n            setExporting(true);\r\n            const params = new URLSearchParams({\r\n                ...(searchQuery && { search: searchQuery }),\r\n                ...(selectedCampaign !== 'all' && { campaignId: selectedCampaign }),\r\n                ...(exportSelected && selectedContacts.length > 0 && {\r\n                    contactIds: selectedContacts.join(',')\r\n                }),\r\n            });\r\n\r\n            const response = await fetch(`/api/contacts/export?${params}`);\r\n            if (!response.ok) throw new Error('Failed to export contacts');\r\n\r\n            const blob = await response.blob();\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `contacts-${new Date().toISOString().split('T')[0]}.csv`;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n            document.body.removeChild(a);\r\n\r\n            toast.success('Contacts exported successfully');\r\n        } catch (error) {\r\n            console.error('Error exporting contacts:', error);\r\n            toast.error('Failed to export contacts');\r\n        } finally {\r\n            setExporting(false);\r\n        }\r\n    };\r\n\r\n    // Handle quick view\r\n    const handleQuickView = (contact: Contact) => {\r\n        setQuickViewContact(contact);\r\n        setShowQuickView(true);\r\n    };\r\n\r\n    const allSelected = contacts.length > 0 && selectedContacts.length === contacts.length;\r\n    const someSelected = selectedContacts.length > 0 && selectedContacts.length < contacts.length;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-7xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">Contacts</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    Manage your contact list and campaign associations\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"flex gap-2\">\r\n                                <Button onClick={() => router.push('/contacts/import')} variant=\"outline\">\r\n                                    <Upload className=\"size-4 mr-2\" />\r\n                                    Import Contacts\r\n                                </Button>\r\n                                <Button onClick={() => router.push('/contacts/new')}>\r\n                                    <Plus className=\"size-4 mr-2\" />\r\n                                    Add Contact\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Filters and Actions */}\r\n                        <Card>\r\n                            <CardContent className=\"pt-6\">\r\n                                <div className=\"flex flex-col md:flex-row gap-4\">\r\n                                    {/* Search */}\r\n                                    <div className=\"relative flex-1\">\r\n                                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground\" />\r\n                                        <Input\r\n                                            placeholder=\"Search by name, email, or mobile...\"\r\n                                            value={searchQuery}\r\n                                            onChange={(e) => {\r\n                                                setSearchQuery(e.target.value);\r\n                                                setCurrentPage(1);\r\n                                            }}\r\n                                            className=\"pl-9\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    {/* Campaign Filter */}\r\n                                    <Select\r\n                                        value={selectedCampaign}\r\n                                        onValueChange={(value) => {\r\n                                            setSelectedCampaign(value);\r\n                                            setCurrentPage(1);\r\n                                        }}\r\n                                    >\r\n                                        <SelectTrigger className=\"w-[200px]\">\r\n                                            <SelectValue placeholder=\"Filter by campaign\" />\r\n                                        </SelectTrigger>\r\n                                        <SelectContent>\r\n                                            <SelectItem value=\"all\">All Campaigns</SelectItem>\r\n                                            {campaigns.map((campaign) => (\r\n                                                <SelectItem key={campaign.id} value={campaign.id.toString()}>\r\n                                                    {campaign.name}\r\n                                                </SelectItem>\r\n                                            ))}\r\n                                        </SelectContent>\r\n                                    </Select>\r\n\r\n                                    {/* Export */}\r\n                                    <Button\r\n                                        variant=\"outline\"\r\n                                        onClick={() => handleExport(false)}\r\n                                        disabled={exporting}\r\n                                    >\r\n                                        {exporting ? (\r\n                                            <Loader2 className=\"size-4 mr-2 animate-spin\" />\r\n                                        ) : (\r\n                                            <Download className=\"size-4 mr-2\" />\r\n                                        )}\r\n                                        Export All\r\n                                    </Button>\r\n                                </div>\r\n\r\n                                {/* Bulk Actions */}\r\n                                {selectedContacts.length > 0 && (\r\n                                    <div className=\"mt-4 flex items-center gap-3 p-3 bg-muted rounded-lg\">\r\n                                        <span className=\"text-sm font-medium\">\r\n                                            {selectedContacts.length} contact{selectedContacts.length !== 1 ? 's' : ''} selected\r\n                                        </span>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"outline\"\r\n                                            onClick={() => handleExport(true)}\r\n                                            disabled={exporting}\r\n                                        >\r\n                                            <Download className=\"size-4 mr-2\" />\r\n                                            Export Selected\r\n                                        </Button>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant=\"destructive\"\r\n                                            onClick={() => setShowDeleteDialog(true)}\r\n                                        >\r\n                                            <Trash2 className=\"size-4 mr-2\" />\r\n                                            Delete Selected\r\n                                        </Button>\r\n                                    </div>\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Table */}\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle>Contact List</CardTitle>\r\n                                <CardDescription>\r\n                                    Showing {contacts.length} of {totalContacts} contacts\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                {loading ? (\r\n                                    <div className=\"flex items-center justify-center py-12\">\r\n                                        <Loader2 className=\"size-8 animate-spin text-muted-foreground\" />\r\n                                    </div>\r\n                                ) : contacts.length === 0 ? (\r\n                                    <div className=\"text-center py-12\">\r\n                                        <p className=\"text-muted-foreground\">No contacts found</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <div className=\"rounded-md border\">\r\n                                            <Table>\r\n                                                <TableHeader>\r\n                                                    <TableRow>\r\n                                                        <TableHead className=\"w-[50px]\">\r\n                                                            <Checkbox\r\n                                                                checked={allSelected}\r\n                                                                onCheckedChange={handleSelectAll}\r\n                                                                aria-label=\"Select all\"\r\n                                                                className={someSelected ? 'data-[state=checked]:bg-muted' : ''}\r\n                                                            />\r\n                                                        </TableHead>\r\n                                                        <TableHead>Name</TableHead>\r\n                                                        <TableHead>Email</TableHead>\r\n                                                        <TableHead>Mobile</TableHead>\r\n                                                        <TableHead>Campaigns</TableHead>\r\n                                                        <TableHead>Created</TableHead>\r\n                                                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                                                    </TableRow>\r\n                                                </TableHeader>\r\n                                                <TableBody>\r\n                                                    {contacts.map((contact) => (\r\n                                                        <TableRow key={contact.id}>\r\n                                                            <TableCell>\r\n                                                                <Checkbox\r\n                                                                    checked={selectedContacts.includes(contact.id)}\r\n                                                                    onCheckedChange={(checked) =>\r\n                                                                        handleSelectContact(contact.id, checked as boolean)\r\n                                                                    }\r\n                                                                    aria-label={`Select ${contact.contactName}`}\r\n                                                                />\r\n                                                            </TableCell>\r\n                                                            <TableCell className=\"font-medium\">\r\n                                                                {contact.contactName || '-'}\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                {contact.contactEmail ? (\r\n                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                        <Mail className=\"size-4 text-muted-foreground\" />\r\n                                                                        <span className=\"text-sm\">{contact.contactEmail}</span>\r\n                                                                    </div>\r\n                                                                ) : (\r\n                                                                    '-'\r\n                                                                )}\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                {contact.contactMobile ? (\r\n                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                        <Phone className=\"size-4 text-muted-foreground\" />\r\n                                                                        <span className=\"text-sm\">{contact.contactMobile}</span>\r\n                                                                    </div>\r\n                                                                ) : (\r\n                                                                    '-'\r\n                                                                )}\r\n                                                            </TableCell>\r\n                                                            <TableCell>\r\n                                                                <div className=\"flex flex-wrap gap-1\">\r\n                                                                    {contact.campaigns.length > 0 ? (\r\n                                                                        contact.campaigns.slice(0, 2).map((campaign) => (\r\n                                                                            <Badge key={campaign.id} variant=\"secondary\" className=\"text-xs\">\r\n                                                                                {campaign.name}\r\n                                                                            </Badge>\r\n                                                                        ))\r\n                                                                    ) : (\r\n                                                                        <span className=\"text-sm text-muted-foreground\">No campaigns</span>\r\n                                                                    )}\r\n                                                                    {contact.campaigns.length > 2 && (\r\n                                                                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                                            +{contact.campaigns.length - 2}\r\n                                                                        </Badge>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </TableCell>\r\n                                                            <TableCell className=\"text-sm text-muted-foreground\">\r\n                                                                {new Date(contact.createdAt).toLocaleDateString()}\r\n                                                            </TableCell>\r\n                                                            <TableCell className=\"text-right\">\r\n                                                                <div className=\"flex items-center justify-end gap-2\">\r\n                                                                    <Button\r\n                                                                        size=\"sm\"\r\n                                                                        variant=\"ghost\"\r\n                                                                        onClick={() => handleQuickView(contact)}\r\n                                                                    >\r\n                                                                        <Eye className=\"size-4\" />\r\n                                                                    </Button>\r\n                                                                    <Button\r\n                                                                        size=\"sm\"\r\n                                                                        variant=\"ghost\"\r\n                                                                        onClick={() => router.push(`/contacts/${contact.id}/edit`)}\r\n                                                                    >\r\n                                                                        <Edit className=\"size-4\" />\r\n                                                                    </Button>\r\n                                                                    <Button\r\n                                                                        size=\"sm\"\r\n                                                                        variant=\"ghost\"\r\n                                                                        onClick={() => {\r\n                                                                            setDeleteContactId(contact.id);\r\n                                                                            setShowDeleteDialog(true);\r\n                                                                        }}\r\n                                                                    >\r\n                                                                        <Trash2 className=\"size-4 text-destructive\" />\r\n                                                                    </Button>\r\n                                                                </div>\r\n                                                            </TableCell>\r\n                                                        </TableRow>\r\n                                                    ))}\r\n                                                </TableBody>\r\n                                            </Table>\r\n                                        </div>\r\n\r\n                                        {/* Pagination */}\r\n                                        <div className=\"flex items-center justify-between mt-4\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span className=\"text-sm text-muted-foreground\">Rows per page:</span>\r\n                                                <Select\r\n                                                    value={itemsPerPage.toString()}\r\n                                                    onValueChange={(value) => {\r\n                                                        setItemsPerPage(parseInt(value));\r\n                                                        setCurrentPage(1);\r\n                                                    }}\r\n                                                >\r\n                                                    <SelectTrigger className=\"w-[80px]\">\r\n                                                        <SelectValue />\r\n                                                    </SelectTrigger>\r\n                                                    <SelectContent>\r\n                                                        <SelectItem value=\"5\">5</SelectItem>\r\n                                                        <SelectItem value=\"10\">10</SelectItem>\r\n                                                        <SelectItem value=\"20\">20</SelectItem>\r\n                                                        <SelectItem value=\"50\">50</SelectItem>\r\n                                                    </SelectContent>\r\n                                                </Select>\r\n                                            </div>\r\n\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span className=\"text-sm text-muted-foreground\">\r\n                                                    Page {currentPage} of {totalPages}\r\n                                                </span>\r\n                                                <div className=\"flex gap-1\">\r\n                                                    <Button\r\n                                                        size=\"sm\"\r\n                                                        variant=\"outline\"\r\n                                                        onClick={() => setCurrentPage((p) => Math.max(1, p - 1))}\r\n                                                        disabled={currentPage === 1}\r\n                                                    >\r\n                                                        <ChevronLeft className=\"size-4\" />\r\n                                                    </Button>\r\n                                                    <Button\r\n                                                        size=\"sm\"\r\n                                                        variant=\"outline\"\r\n                                                        onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))}\r\n                                                        disabled={currentPage === totalPages}\r\n                                                    >\r\n                                                        <ChevronRight className=\"size-4\" />\r\n                                                    </Button>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </>\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n\r\n            {/* Delete Confirmation Dialog */}\r\n            <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n                <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            {selectedContacts.length > 1\r\n                                ? `This will permanently delete ${selectedContacts.length} contacts. This action cannot be undone.`\r\n                                : 'This will permanently delete this contact. This action cannot be undone.'}\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => setDeleteContactId(null)}>\r\n                            Cancel\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction\r\n                            onClick={() => {\r\n                                if (selectedContacts.length > 1) {\r\n                                    handleBulkDelete();\r\n                                } else if (deleteContactId) {\r\n                                    handleDeleteContact(deleteContactId);\r\n                                }\r\n                            }}\r\n                            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                        >\r\n                            Delete\r\n                        </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n\r\n            {/* Quick View Modal */}\r\n            <Dialog open={showQuickView} onOpenChange={setShowQuickView}>\r\n                <DialogContent className=\"max-w-2xl\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>Contact Details</DialogTitle>\r\n                        <DialogDescription>View contact information and associations</DialogDescription>\r\n                    </DialogHeader>\r\n                    {quickViewContact && (\r\n                        <div className=\"space-y-6\">\r\n                            {/* Basic Info */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">Name</label>\r\n                                    <p className=\"mt-1 text-sm font-medium\">\r\n                                        {quickViewContact.contactName || 'Not provided'}\r\n                                    </p>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">Email</label>\r\n                                    <p className=\"mt-1 text-sm\">\r\n                                        {quickViewContact.contactEmail || 'Not provided'}\r\n                                    </p>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">Mobile</label>\r\n                                    <p className=\"mt-1 text-sm\">\r\n                                        {quickViewContact.contactMobile || 'Not provided'}\r\n                                    </p>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">WhatsApp</label>\r\n                                    <p className=\"mt-1 text-sm\">\r\n                                        {quickViewContact.contactWhatsApp || 'Not provided'}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Campaigns */}\r\n                            <div>\r\n                                <label className=\"text-sm font-medium text-muted-foreground\">\r\n                                    Associated Campaigns\r\n                                </label>\r\n                                <div className=\"mt-2 flex flex-wrap gap-2\">\r\n                                    {quickViewContact.campaigns.length > 0 ? (\r\n                                        quickViewContact.campaigns.map((campaign) => (\r\n                                            <Badge key={campaign.id} variant=\"secondary\">\r\n                                                {campaign.name}\r\n                                            </Badge>\r\n                                        ))\r\n                                    ) : (\r\n                                        <p className=\"text-sm text-muted-foreground\">No campaigns associated</p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Metadata */}\r\n                            <div className=\"grid grid-cols-2 gap-4 pt-4 border-t\">\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">Created</label>\r\n                                    <p className=\"mt-1 text-sm\">\r\n                                        {new Date(quickViewContact.createdAt).toLocaleString()}\r\n                                    </p>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"text-sm font-medium text-muted-foreground\">Last Updated</label>\r\n                                    <p className=\"mt-1 text-sm\">\r\n                                        {new Date(quickViewContact.updatedAt).toLocaleString()}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex gap-2 pt-4 border-t\">\r\n                                <Button\r\n                                    onClick={() => {\r\n                                        router.push(`/contacts/${quickViewContact.id}/edit`);\r\n                                        setShowQuickView(false);\r\n                                    }}\r\n                                >\r\n                                    <Edit className=\"size-4 mr-2\" />\r\n                                    Edit Contact\r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    onClick={() => setShowQuickView(false)}\r\n                                >\r\n                                    Close\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\onboarding\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\onboarding\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Textarea' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'formData.email'. Either include it or remove the dependency array.","line":113,"column":6,"nodeType":"ArrayExpression","endLine":113,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [user, router, formData.email]","fix":{"range":[4064,4078],"text":"[user, router, formData.email]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4308,4311],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4308,4311],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7093,7096],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7093,7096],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":259,"column":18,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8957,9028],"text":"\r\n              You&apos;re almost there! Complete payment to activate your "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8957,9028],"text":"\r\n              You&lsquo;re almost there! Complete payment to activate your "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8957,9028],"text":"\r\n              You&#39;re almost there! Complete payment to activate your "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8957,9028],"text":"\r\n              You&rsquo;re almost there! Complete payment to activate your "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":290,"column":54,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[10542,10558],"text":"What&apos;s Included:"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[10542,10558],"text":"What&lsquo;s Included:"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[10542,10558],"text":"What&#39;s Included:"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[10542,10558],"text":"What&rsquo;s Included:"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useUser } from \"@clerk/nextjs\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Building2, Check, Sparkles } from \"lucide-react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { RazorpayButton } from \"@/components/razorpay-button\";\r\nimport { PLANS, formatPrice, type PlanType } from \"@/lib/plans\";\r\nimport { toast } from \"sonner\";\r\n\r\nexport default function OnboardingPage() {\r\n  const { user } = useUser();\r\n  const router = useRouter();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSyncing, setIsSyncing] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [selectedPlan, setSelectedPlan] = useState<PlanType>(\"FREE_TRIAL\");\r\n  const [showPayment, setShowPayment] = useState(false);\r\n\r\n  // Form State\r\n  const [formData, setFormData] = useState({\r\n    organizationName: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    address: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    country: \"\",\r\n    postalCode: \"\",\r\n    taxNumber: \"\"\r\n  });\r\n\r\n  // Sync user on mount\r\n  useEffect(() => {\r\n    const syncUser = async () => {\r\n      debugger;\r\n      try {\r\n        const response = await fetch(\"/api/user/sync\");\r\n        const data = await response.json();\r\n        console.log(\"=== ONBOARDING PAGE - User Sync ===\");\r\n        console.log(\"User sync result:\", data);\r\n        console.log(\"====================================\");\r\n\r\n        if (!data.user) {\r\n          setIsSyncing(false);\r\n          return;\r\n        }\r\n\r\n        const { user: syncedUser } = data;\r\n\r\n        if (syncedUser.isAdmin) {\r\n          console.log(\" Admin user detected - Redirecting to /admin\");\r\n          router.push(\"/admin\");\r\n          return;\r\n        }\r\n\r\n        if (syncedUser.hasOrganisation && syncedUser.isTrialOrPremium) {\r\n          console.log(\"User has organization with active subscription - Redirecting to /organisation\");\r\n          router.push(\"/organisation\");\r\n          return;\r\n        }\r\n\r\n        if (syncedUser.needsOnboarding && \r\n            syncedUser.organisation && \r\n            syncedUser.organisationId && \r\n            !syncedUser.hasActiveSubscription &&\r\n            !syncedUser.subscription) {\r\n          \r\n          console.log(\" User from enquiry - Prefilling onboarding form\");\r\n          console.log(\"Organization ID:\", syncedUser.organisationId);\r\n          console.log(\"Organization Name:\", syncedUser.organisation.name);\r\n          console.log(\"Has Subscription:\", syncedUser.hasActiveSubscription);\r\n          console.log(\"Subscription Object:\", syncedUser.subscription);\r\n          \r\n          setFormData({\r\n            organizationName: syncedUser.organisation.name || \"\",\r\n            email: syncedUser.organisation.email || user?.primaryEmailAddress?.emailAddress || \"\",\r\n            phone: syncedUser.organisation.phone || \"\",\r\n            address: syncedUser.organisation.address || \"\",\r\n            city: syncedUser.organisation.city || \"\",\r\n            state: syncedUser.organisation.state || \"\",\r\n            country: syncedUser.organisation.country || \"\",\r\n            postalCode: syncedUser.organisation.postalCode || \"\",\r\n            taxNumber: syncedUser.organisation.taxNumber || \"\"\r\n          });\r\n          setIsSyncing(false);\r\n          return;\r\n        }\r\n\r\n        console.log(\" New user - Showing onboarding form\");\r\n\r\n      } catch (err) {\r\n        console.error(\"Error syncing user:\", err);\r\n      } finally {\r\n        setIsSyncing(false);\r\n      }\r\n    };\r\n\r\n    if (user) {\r\n      debugger;\r\n      if (!formData.email) {\r\n        setFormData(prev => ({ ...prev, email: user.primaryEmailAddress?.emailAddress || \"\" }));\r\n      }\r\n      syncUser();\r\n    } else {\r\n      setIsSyncing(false);\r\n    }\r\n  }, [user, router]);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { id, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [id]: value }));\r\n  };\r\n\r\n  const createOrganisation = async (paymentData?: any) => {\r\n    try {\r\n      const response = await fetch(\"/api/organisations\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          ...formData,\r\n          plan: selectedPlan,\r\n          paymentData\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(data.error || \"Failed to create organisation\");\r\n      }\r\n\r\n      console.log(\"Organisation created:\", data);\r\n      toast.success(\"Welcome! Your account is ready.\");\r\n\r\n      // Redirect based on role\r\n      console.log(\"=== REDIRECT DECISION ===\");\r\n      console.log(\"API Response User Role:\", data.user?.role);\r\n      console.log(\"Clerk Metadata Role:\", user?.publicMetadata?.role);\r\n      console.log(\"Is Admin (DB):\", data.user?.role === \"ADMIN_USER\");\r\n      console.log(\"Is Admin (Clerk):\", user?.publicMetadata?.role === \"admin\");\r\n      console.log(\"========================\");\r\n\r\n      if (data.user?.role === \"ADMIN_USER\" || user?.publicMetadata?.role === \"admin\") {\r\n        console.log(\" Redirecting to /admin\");\r\n        router.push(\"/admin\");\r\n      } else {\r\n        console.log(\" Redirecting to /organisation\");\r\n        router.push(\"/organisation\");\r\n      }\r\n\r\n    } catch (err) {\r\n      console.error(\"Error creating organisation:\", err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(\"\");\r\n\r\n    try {\r\n      // Validation\r\n      if (!formData.organizationName || !formData.email || !formData.phone || !formData.address || !formData.city || !formData.state || !formData.country || !formData.postalCode) {\r\n        toast.error(\"Please fill in all required fields\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Email validation\r\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n      if (!emailRegex.test(formData.email)) {\r\n        toast.error(\"Please enter a valid email address\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Phone validation\r\n      if (formData.phone.length < 10) {\r\n        toast.error(\"Please enter a valid phone number\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (selectedPlan === \"FREE_TRIAL\") {\r\n        // Free trial - create organisation directly\r\n        await createOrganisation();\r\n      } else {\r\n        // Paid plan - show payment step\r\n        setShowPayment(true);\r\n        setIsLoading(false);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error:\", err);\r\n      setError(err instanceof Error ? err.message : \"Failed to complete setup\");\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = async (paymentData?: any) => {\r\n    try {\r\n      setIsLoading(true);\r\n      toast.info(\"Payment successful! Creating your organization...\");\r\n      \r\n      // Store payment info to pass to organisation creation\r\n      if (paymentData?.payment) {\r\n        // Create organisation with payment information\r\n        await createOrganisation(paymentData.payment);\r\n      } else {\r\n        await createOrganisation();\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error after payment:\", err);\r\n      setError(err instanceof Error ? err.message : \"Failed to complete setup\");\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePaymentError = (error: string) => {\r\n    setError(error);\r\n    setShowPayment(false);\r\n  };\r\n\r\n  if (isSyncing) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-muted/30\">\r\n        <Card className=\"w-full max-w-md\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"text-center\">\r\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\r\n              <p className=\"text-muted-foreground\">Setting up your account...</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Payment step\r\n  if (showPayment) {\r\n    const plan = PLANS[selectedPlan];\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-muted/30 p-4\">\r\n        <Card className=\"w-full max-w-2xl\">\r\n          <CardHeader className=\"text-center\">\r\n            <div className=\"flex justify-center mb-4\">\r\n              <div className=\"size-16 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                <Sparkles className=\"size-8 text-primary\" />\r\n              </div>\r\n            </div>\r\n            <CardTitle>Complete Your Payment</CardTitle>\r\n            <CardDescription>\r\n              You're almost there! Complete payment to activate your {plan.name} plan\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-6\">\r\n            {/* Order Summary */}\r\n            <div className=\"border rounded-lg p-4 space-y-3\">\r\n              <h3 className=\"font-semibold\">Order Summary</h3>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-muted-foreground\">Organization:</span>\r\n                  <span className=\"font-medium\">{formData.organizationName}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-muted-foreground\">Plan:</span>\r\n                  <span className=\"font-medium\">{plan.name}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-muted-foreground\">Billing:</span>\r\n                  <span className=\"font-medium\">Monthly</span>\r\n                </div>\r\n                <div className=\"border-t pt-2 flex justify-between text-lg\">\r\n                  <span className=\"font-semibold\">Total:</span>\r\n                  <span className=\"font-bold text-primary\">\r\n                    {formatPrice(plan.price, plan.currency)}/month\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Plan Features */}\r\n            <div className=\"border rounded-lg p-4\">\r\n              <h3 className=\"font-semibold mb-3\">What's Included:</h3>\r\n              <ul className=\"space-y-2\">\r\n                {plan.features.map((feature, index) => (\r\n                  <li key={index} className=\"flex items-start gap-2\">\r\n                    <Check className=\"size-5 text-primary shrink-0 mt-0.5\" />\r\n                    <span className=\"text-sm\">{feature}</span>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {/* Payment Buttons */}\r\n            <div className=\"flex gap-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                className=\"flex-1\"\r\n                onClick={() => setShowPayment(false)}\r\n                disabled={isLoading}\r\n              >\r\n                Back\r\n              </Button>\r\n              <RazorpayButton\r\n                plan={selectedPlan}\r\n                amount={plan.price}\r\n                onSuccess={handlePaymentSuccess}\r\n                onError={handlePaymentError}\r\n                className=\"flex-1\"\r\n                organizationName={formData.organizationName}\r\n                isSignup={true}\r\n              >\r\n                Pay {formatPrice(plan.price, plan.currency)}\r\n              </RazorpayButton>\r\n            </div>\r\n\r\n            <p className=\"text-xs text-center text-muted-foreground\">\r\n              Secure payment powered by Razorpay. Your payment information is encrypted and secure.\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Onboarding form\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30 p-4\">\r\n      <Card className=\"w-full max-w-4xl\">\r\n        <CardHeader className=\"text-center\">\r\n          <div className=\"flex justify-center mb-4\">\r\n            <div className=\"size-16 rounded-full bg-primary/10 flex items-center justify-center\">\r\n              <Building2 className=\"size-8 text-primary\" />\r\n            </div>\r\n          </div>\r\n          <CardTitle className=\"text-3xl\">Welcome to CampZeo!</CardTitle>\r\n          <CardDescription>\r\n            Choose your plan and set up your organization to get started\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n              {/* Organization Name */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"organizationName\">Organization Name *</Label>\r\n                <Input\r\n                  id=\"organizationName\"\r\n                  placeholder=\"Acme Corp\"\r\n                  value={formData.organizationName}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Email */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"email\">Email *</Label>\r\n                <Input\r\n                  id=\"email\"\r\n                  type=\"email\"\r\n                  value={formData.email}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Phone */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"phone\">Phone *</Label>\r\n                <Input\r\n                  id=\"phone\"\r\n                  type=\"tel\"\r\n                  placeholder=\"+91 9999999999\"\r\n                  value={formData.phone}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Tax Number */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"taxNumber\">Tax Number (GST/VAT)</Label>\r\n                <Input\r\n                  id=\"taxNumber\"\r\n                  placeholder=\"GSTIN...\"\r\n                  value={formData.taxNumber}\r\n                  onChange={handleInputChange}\r\n                />\r\n              </div>\r\n\r\n              {/* Address */}\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"address\">Address *</Label>\r\n                <Input\r\n                  id=\"address\"\r\n                  placeholder=\"123 Business St\"\r\n                  value={formData.address}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* City */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"city\">City *</Label>\r\n                <Input\r\n                  id=\"city\"\r\n                  placeholder=\"Mumbai\"\r\n                  value={formData.city}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* State */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"state\">State *</Label>\r\n                <Input\r\n                  id=\"state\"\r\n                  placeholder=\"Maharashtra\"\r\n                  value={formData.state}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Country */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"country\">Country *</Label>\r\n                <Input\r\n                  id=\"country\"\r\n                  placeholder=\"India\"\r\n                  value={formData.country}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Postal Code */}\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"postalCode\">Postal Code *</Label>\r\n                <Input\r\n                  id=\"postalCode\"\r\n                  placeholder=\"400001\"\r\n                  value={formData.postalCode}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Plan Selection */}\r\n            <div className=\"space-y-3 pt-4 border-t\">\r\n              <Label className=\"text-lg\">Select Your Plan *</Label>\r\n              <div className=\"grid gap-4 md:grid-cols-3\">\r\n                {Object.values(PLANS).map((plan) => (\r\n                  <Card\r\n                    key={plan.id}\r\n                    className={`cursor-pointer transition-all ${selectedPlan === plan.id\r\n                      ? \"border-primary shadow-md ring-2 ring-primary\"\r\n                      : \"hover:border-primary/50\"\r\n                      } ${plan.popular ? \"relative\" : \"\"}`}\r\n                    onClick={() => setSelectedPlan(plan.id)}\r\n                  >\r\n                    {plan.popular && (\r\n                      <div className=\"absolute -top-3 left-1/2 -translate-x-1/2\">\r\n                        <Badge className=\"bg-primary\">Most Popular</Badge>\r\n                      </div>\r\n                    )}\r\n                    <CardHeader className=\"pb-3\">\r\n                      <CardTitle className=\"text-lg\">{plan.name}</CardTitle>\r\n                      <div className=\"mt-2\">\r\n                        <span className=\"text-3xl font-bold\">\r\n                          {formatPrice(plan.price, plan.currency)}\r\n                        </span>\r\n                        {plan.price > 0 && (\r\n                          <span className=\"text-muted-foreground text-sm\">/{plan.interval}</span>\r\n                        )}\r\n                      </div>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                      <ul className=\"space-y-2\">\r\n                        {plan.features.slice(0, 4).map((feature, index) => (\r\n                          <li key={index} className=\"flex items-start gap-2 text-sm\">\r\n                            <Check className=\"size-4 text-primary shrink-0 mt-0.5\" />\r\n                            <span>{feature}</span>\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <Button type=\"submit\" className=\"w-full\" size=\"lg\" disabled={isLoading}>\r\n              {isLoading ? \"Setting up...\" : selectedPlan === \"FREE_TRIAL\" ? \"Start Free Trial\" : \"Continue to Payment\"}\r\n            </Button>\r\n\r\n            <p className=\"text-xs text-center text-muted-foreground\">\r\n              By continuing, you agree to our Terms of Service and Privacy Policy\r\n            </p>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\_components\\organisation-layout-wrapper.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Home' is defined but never used.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":6},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Menu' is defined but never used.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SignedIn' is defined but never used.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserButton' is defined but never used.","line":16,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sheet' is defined but never used.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SheetContent' is defined but never used.","line":18,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SheetTrigger' is defined but never used.","line":18,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SheetTitle' is defined but never used.","line":18,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'VisuallyHidden' is defined but never used.","line":19,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  LayoutDashboard,\r\n  FileText,\r\n  Users,\r\n  BarChart3,\r\n  CreditCard,\r\n  Settings,\r\n  Home,\r\n  Bell,\r\n  Zap,\r\n  Menu,\r\n} from \"lucide-react\";\r\nimport { SignedIn, UserButton } from \"@clerk/nextjs\";\r\nimport Link from \"next/link\";\r\nimport { Sheet, SheetContent, SheetTrigger, SheetTitle } from \"@/components/ui/sheet\";\r\nimport { VisuallyHidden } from \"@radix-ui/react-visually-hidden\";\r\n\r\nconst SidebarContent = () => (\r\n  <nav className=\"space-y-2\">\r\n    <Link href=\"/organisation\">\r\n      <Button variant=\"secondary\" className=\"w-full justify-start\">\r\n        <LayoutDashboard className=\"size-4 mr-2\" />\r\n        Dashboard\r\n      </Button>\r\n    </Link>\r\n    <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n      <FileText className=\"size-4 mr-2\" />\r\n      Documents\r\n    </Button>\r\n    <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n      <Users className=\"size-4 mr-2\" />\r\n      Team\r\n    </Button>\r\n    <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n      <BarChart3 className=\"size-4 mr-2\" />\r\n      Analytics\r\n    </Button>\r\n    <Link href=\"/organisation/billing\">\r\n      <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n        <CreditCard className=\"size-4 mr-2\" />\r\n        Billing\r\n      </Button>\r\n    </Link>\r\n    <Link href=\"/organisation/settings\">\r\n      <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n        <Settings className=\"size-4 mr-2\" />\r\n        Settings\r\n      </Button>\r\n    </Link>\r\n  </nav>\r\n);\r\n\r\nexport function OrganisationLayoutWrapper({ children, isImpersonating }: { children: React.ReactNode; isImpersonating?: boolean }) {\r\n  const handleExitImpersonation = () => {\r\n    // Clear the cookie\r\n    document.cookie = \"admin_impersonation=; path=/; max-age=0\";\r\n    // Redirect to admin\r\n    window.location.href = \"/admin\";\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-muted/30\">\r\n      {/* Header */}\r\n      <header className=\"sticky top-0 z-40 border-b bg-background\">\r\n        {isImpersonating && (\r\n            <div className=\"bg-amber-100 text-amber-900 px-4 py-1 text-xs font-medium text-center border-b border-amber-200 flex items-center justify-center gap-2\">\r\n                <span>You are impersonating an organisation.</span>\r\n                <button onClick={handleExitImpersonation} className=\"underline hover:text-amber-700 font-bold\">\r\n                    Back to Admin\r\n                </button>\r\n            </div>\r\n        )}\r\n        \r\n      </header>\r\n\r\n      <div className=\"flex\">\r\n        {/* Sidebar (Desktop) */}\r\n        <aside className=\"w-64 border-r bg-background min-h-[calc(100vh-4rem)] p-4 hidden md:block\">\r\n          <SidebarContent />\r\n        </aside>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1\">\r\n          {children}\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\billing\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\[id]\\edit\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\[id]\\posts\\[postId]\\edit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1859,1862],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1859,1862],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3043,3046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3043,3046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from '@/components/ui/select';\r\nimport { ArrowLeft, Loader2, Save, Upload, X, Youtube } from 'lucide-react';\r\nimport { useRouter, useParams } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\nimport Image from 'next/image';\r\n\r\ninterface Post {\r\n    id: number;\r\n    subject: string | null;\r\n    message: string | null;\r\n    type: string;\r\n    senderEmail: string | null;\r\n    scheduledPostTime: string | null;\r\n    isPostSent: boolean;\r\n    videoUrl: string | null;\r\n}\r\n\r\nexport default function EditPostPage() {\r\n    const router = useRouter();\r\n    const params = useParams();\r\n    const campaignId = params.id as string;\r\n    const postId = params.postId as string;\r\n\r\n    // Form state\r\n    const [subject, setSubject] = useState('');\r\n    const [message, setMessage] = useState('');\r\n    const [type, setType] = useState('');\r\n    const [senderEmail, setSenderEmail] = useState('');\r\n    const [scheduledPostTime, setScheduledPostTime] = useState('');\r\n    const [mediaUrl, setMediaUrl] = useState('');\r\n    const [pinterestBoardId, setPinterestBoardId] = useState('');\r\n    const [pinterestLink, setPinterestLink] = useState('');\r\n    const [uploadingMedia, setUploadingMedia] = useState(false);\r\n    \r\n    // Pinterest Boards\r\n    const [pinterestBoards, setPinterestBoards] = useState<any[]>([]);\r\n    const [loadingPinterestBoards, setLoadingPinterestBoards] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    // Fetch post data\r\n    useEffect(() => {\r\n        const fetchPost = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const response = await fetch(`/api/campaigns/${campaignId}/posts/${postId}`);\r\n                if (!response.ok) throw new Error('Failed to fetch post');\r\n\r\n                const data = await response.json();\r\n                const post: Post = data.post;\r\n\r\n                if (post.isPostSent) {\r\n                    toast.error('Cannot edit a sent post');\r\n                    router.push(`/organisation/campaigns/${campaignId}/posts`);\r\n                    return;\r\n                }\r\n\r\n                setSubject(post.subject || '');\r\n                setMessage(post.message || '');\r\n                setType(post.type);\r\n                setSenderEmail(post.senderEmail || '');\r\n                setMediaUrl(post.videoUrl || '');\r\n                \r\n                // Load metadata\r\n                const metadata = (post as any).metadata || {};\r\n                setPinterestBoardId(metadata.boardId || '');\r\n                setPinterestLink(metadata.link || '');\r\n                \r\n                if (post.scheduledPostTime) {\r\n                    const date = new Date(post.scheduledPostTime);\r\n                    const year = date.getFullYear();\r\n                    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n                    const day = String(date.getDate()).padStart(2, '0');\r\n                    const hours = String(date.getHours()).padStart(2, '0');\r\n                    const minutes = String(date.getMinutes()).padStart(2, '0');\r\n                    setScheduledPostTime(`${year}-${month}-${day}T${hours}:${minutes}`);\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching post:', error);\r\n                toast.error('Failed to load post');\r\n                router.push(`/organisation/campaigns/${campaignId}/posts`);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchPost();\r\n    }, [campaignId, postId, router]);\r\n\r\n    // Fetch Pinterest boards\r\n    useEffect(() => {\r\n        if (type === 'PINTEREST') {\r\n            const fetchBoards = async () => {\r\n                try {\r\n                    setLoadingPinterestBoards(true);\r\n                    const response = await fetch('/api/socialmedia/pinterest/boards');\r\n                    if (response.ok) {\r\n                        const data = await response.json();\r\n                        setPinterestBoards(data.boards || []);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error fetching Pinterest boards:', error);\r\n                    toast.error('Failed to fetch Pinterest boards');\r\n                } finally {\r\n                    setLoadingPinterestBoards(false);\r\n                }\r\n            };\r\n            fetchBoards();\r\n        }\r\n    }, [type]);\r\n\r\n    // Handle file upload\r\n    const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        try {\r\n            setUploadingMedia(true);\r\n            const formData = new FormData();\r\n            formData.append('file', file);\r\n\r\n            const response = await fetch('/api/socialmedia/upload-media-file', {\r\n                method: 'POST',\r\n                body: formData,\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Upload failed');\r\n            }\r\n\r\n            const data = await response.json();\r\n            setMediaUrl(data.url);\r\n            toast.success('File uploaded successfully');\r\n        } catch (error) {\r\n            console.error('Error uploading file:', error);\r\n            toast.error('Failed to upload file');\r\n        } finally {\r\n            setUploadingMedia(false);\r\n        }\r\n    };\r\n\r\n    // Handle form submit\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        // Validation\r\n        if (!type) {\r\n            toast.error('Please select a platform');\r\n            return;\r\n        }\r\n\r\n        if (!message && !subject) {\r\n            toast.error('Please enter a message or subject');\r\n            return;\r\n        }\r\n\r\n        if (type === 'EMAIL' && !senderEmail) {\r\n            toast.error('Please enter sender email for email posts');\r\n            return;\r\n        }\r\n\r\n        if (['INSTAGRAM', 'YOUTUBE', 'PINTEREST'].includes(type) && !mediaUrl) {\r\n            toast.error(`${type} posts require media (image/video)`);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setSaving(true);\r\n\r\n            const response = await fetch(`/api/campaigns/${campaignId}/posts/${postId}`, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    subject: subject || null,\r\n                    message: message || null,\r\n                    type,\r\n                    senderEmail: type === 'EMAIL' ? senderEmail : null,\r\n                    scheduledPostTime: scheduledPostTime || null,\r\n                    videoUrl: mediaUrl || null,\r\n                    pinterestBoardId,\r\n                    pinterestLink\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const error = await response.json();\r\n                throw new Error(error.error || 'Failed to update post');\r\n            }\r\n\r\n            toast.success('Post updated successfully');\r\n            router.push(`/organisation/campaigns/${campaignId}/posts`);\r\n        } catch (error) {\r\n            console.error('Error updating post:', error);\r\n            toast.error(error instanceof Error ? error.message : 'Failed to update post');\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-background\">\r\n                <Header />\r\n                <div className=\"flex\">\r\n                    <Sidebar />\r\n                    <main className=\"flex-1 p-6\">\r\n                        <div className=\"flex items-center justify-center h-[calc(100vh-8rem)]\">\r\n                            <Loader2 className=\"size-8 animate-spin text-muted-foreground\" />\r\n                        </div>\r\n                    </main>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-3xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => router.back()}\r\n                            >\r\n                                <ArrowLeft className=\"size-4 mr-2\" />\r\n                                Back\r\n                            </Button>\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">Edit Post</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    Update post details\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                            {/* Post Details */}\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <CardTitle>Post Details</CardTitle>\r\n                                    <CardDescription>\r\n                                        Configure your campaign post\r\n                                    </CardDescription>\r\n                                </CardHeader>\r\n                                <CardContent className=\"space-y-4\">\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"type\">Platform *</Label>\r\n                                        <Select value={type} onValueChange={setType}>\r\n                                            <SelectTrigger id=\"type\">\r\n                                                <SelectValue placeholder=\"Select platform\" />\r\n                                            </SelectTrigger>\r\n                                            <SelectContent>\r\n                                                <SelectItem value=\"EMAIL\">Email</SelectItem>\r\n                                                <SelectItem value=\"SMS\">SMS</SelectItem>\r\n                                                <SelectItem value=\"WHATSAPP\">WhatsApp</SelectItem>\r\n                                                <SelectItem value=\"FACEBOOK\">Facebook</SelectItem>\r\n                                                <SelectItem value=\"INSTAGRAM\">Instagram</SelectItem>\r\n                                                <SelectItem value=\"LINKEDIN\">LinkedIn</SelectItem>\r\n                                                <SelectItem value=\"YOUTUBE\">YouTube</SelectItem>\r\n                                                <SelectItem value=\"PINTEREST\">Pinterest</SelectItem>\r\n                                            </SelectContent>\r\n                                        </Select>\r\n                                    </div>\r\n\r\n                                    {type === 'EMAIL' && (\r\n                                        <>\r\n                                            <div className=\"space-y-2\">\r\n                                                <Label htmlFor=\"senderEmail\">Sender Email *</Label>\r\n                                                <Input\r\n                                                    id=\"senderEmail\"\r\n                                                    type=\"email\"\r\n                                                    placeholder=\"sender@example.com\"\r\n                                                    value={senderEmail}\r\n                                                    onChange={(e) => setSenderEmail(e.target.value)}\r\n                                                    required={type === 'EMAIL'}\r\n                                                />\r\n                                            </div>\r\n\r\n                                            <div className=\"space-y-2\">\r\n                                                <Label htmlFor=\"subject\">Subject *</Label>\r\n                                                <Input\r\n                                                    id=\"subject\"\r\n                                                    placeholder=\"Enter email subject\"\r\n                                                    value={subject}\r\n                                                    onChange={(e) => setSubject(e.target.value)}\r\n                                                    required={type === 'EMAIL'}\r\n                                                />\r\n                                            </div>\r\n                                        </>\r\n                                    )}\r\n\r\n                                    {type && (\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label htmlFor=\"message\">\r\n                                                Message {type !== 'EMAIL' && '*'}\r\n                                            </Label>\r\n                                            <Textarea\r\n                                                id=\"message\"\r\n                                                placeholder=\"Enter your message\"\r\n                                                value={message}\r\n                                                onChange={(e) => setMessage(e.target.value)}\r\n                                                rows={6}\r\n                                                required={type !== 'EMAIL'}\r\n                                            />\r\n                                            <p className=\"text-xs text-muted-foreground\">\r\n                                                {type === 'SMS' && 'SMS messages are limited to 160 characters'}\r\n                                                {type === 'WHATSAPP' && 'WhatsApp messages support rich formatting'}\r\n                                                {type === 'EMAIL' && 'You can use HTML formatting in email messages'}\r\n                                            </p>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Media Upload */}\r\n                                    {['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST'].includes(type) && (\r\n                                        <div className=\"space-y-2\">\r\n                                            <Label>\r\n                                                {type === 'YOUTUBE' ? 'Video *' : 'Media (Photo/Video)'}\r\n                                                {['INSTAGRAM', 'PINTEREST'].includes(type) && ' *'}\r\n                                            </Label>\r\n                                            {!mediaUrl ? (\r\n                                                <div className=\"flex items-center justify-center w-full\">\r\n                                                    <label htmlFor=\"media-upload\" className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-muted/50 transition-colors\">\r\n                                                        <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\r\n                                                            {uploadingMedia ? (\r\n                                                                <Loader2 className=\"size-8 mb-2 text-muted-foreground animate-spin\" />\r\n                                                            ) : (\r\n                                                                <Upload className=\"size-8 mb-2 text-muted-foreground\" />\r\n                                                            )}\r\n                                                            <p className=\"text-sm text-muted-foreground\">\r\n                                                                {uploadingMedia ? 'Uploading...' : 'Click to upload photo or video'}\r\n                                                            </p>\r\n                                                        </div>\r\n                                                        <input \r\n                                                            id=\"media-upload\" \r\n                                                            type=\"file\" \r\n                                                            className=\"hidden\" \r\n                                                            accept={type === 'YOUTUBE' ? 'video/*' : 'image/*,video/*'}\r\n                                                            onChange={handleFileUpload}\r\n                                                            disabled={uploadingMedia}\r\n                                                        />\r\n                                                    </label>\r\n                                                </div>\r\n                                            ) : (\r\n                                                <div className=\"relative rounded-lg overflow-hidden border bg-muted/50\">\r\n                                                    <div className=\"p-4 flex items-center justify-between\">\r\n                                                        <div className=\"flex items-center gap-2 truncate\">\r\n                                                            <div className=\"size-10 bg-background rounded flex items-center justify-center border\">\r\n                                                                {mediaUrl.match(/\\.(mp4|mov|webm)$/i) ? (\r\n                                                                    <Youtube className=\"size-5 text-muted-foreground\" />\r\n                                                                ) : (\r\n                                                                    <Image \r\n                                                                        src={mediaUrl} \r\n                                                                        alt=\"Preview\" \r\n                                                                        width={40} \r\n                                                                        height={40} \r\n                                                                        className=\"object-cover size-full\"\r\n                                                                    />\r\n                                                                )}\r\n                                                            </div>\r\n                                                            <span className=\"text-sm text-muted-foreground truncate max-w-[200px]\">\r\n                                                                {mediaUrl.split('/').pop()}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                        <Button\r\n                                                            type=\"button\"\r\n                                                            variant=\"ghost\"\r\n                                                            size=\"icon\"\r\n                                                            onClick={() => setMediaUrl('')}\r\n                                                        >\r\n                                                            <X className=\"size-4\" />\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    <div className=\"space-y-2\">\r\n                                        <Label htmlFor=\"scheduledPostTime\">Schedule Post (Optional)</Label>\r\n                                        <Input\r\n                                            id=\"scheduledPostTime\"\r\n                                            type=\"datetime-local\"\r\n                                            value={scheduledPostTime}\r\n                                            onChange={(e) => setScheduledPostTime(e.target.value)}\r\n                                        />\r\n                                        <p className=\"text-xs text-muted-foreground\">\r\n                                            Leave empty to send immediately\r\n                                        </p>\r\n                                    </div>\r\n\r\n                                    {/* Pinterest Specific Fields */}\r\n                                    {type === 'PINTEREST' && (\r\n                                        <div className=\"space-y-4 pt-4 border-t\">\r\n                                            <h3 className=\"font-medium flex items-center gap-2\">\r\n                                                <div className=\"p-1 bg-red-600 rounded-full\">\r\n                                                    <span className=\"text-white text-[10px] font-bold\">P</span>\r\n                                                </div>\r\n                                                Pinterest Settings\r\n                                            </h3>\r\n                                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"pinterestBoardId\">Board *</Label>\r\n                                                    {loadingPinterestBoards ? (\r\n                                                        <div className=\"flex items-center gap-2 h-10 px-3 border rounded-md bg-muted/50\">\r\n                                                            <Loader2 className=\"size-4 animate-spin text-muted-foreground\" />\r\n                                                            <span className=\"text-sm text-muted-foreground\">Loading boards...</span>\r\n                                                        </div>\r\n                                                    ) : (\r\n                                                        <Select value={pinterestBoardId} onValueChange={setPinterestBoardId}>\r\n                                                            <SelectTrigger id=\"pinterestBoardId\">\r\n                                                                <SelectValue placeholder=\"Select a board\" />\r\n                                                            </SelectTrigger>\r\n                                                            <SelectContent>\r\n                                                                {pinterestBoards.length === 0 ? (\r\n                                                                    <SelectItem value=\"none\" disabled>No boards found</SelectItem>\r\n                                                                ) : (\r\n                                                                    pinterestBoards.map((board) => (\r\n                                                                        <SelectItem key={board.id} value={board.id}>\r\n                                                                            {board.name}\r\n                                                                        </SelectItem>\r\n                                                                    ))\r\n                                                                )}\r\n                                                            </SelectContent>\r\n                                                        </Select>\r\n                                                    )}\r\n                                                </div>\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"pinterestLink\">Destination Link</Label>\r\n                                                    <Input\r\n                                                        id=\"pinterestLink\"\r\n                                                        placeholder=\"https://yourwebsite.com\"\r\n                                                        value={pinterestLink}\r\n                                                        onChange={(e) => setPinterestLink(e.target.value)}\r\n                                                    />\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </CardContent>\r\n                            </Card>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex justify-end gap-4\">\r\n                                <Button\r\n                                    type=\"button\"\r\n                                    variant=\"outline\"\r\n                                    onClick={() => router.back()}\r\n                                    disabled={saving}\r\n                                >\r\n                                    Cancel\r\n                                </Button>\r\n                                <Button type=\"submit\" disabled={saving}>\r\n                                    {saving ? (\r\n                                        <>\r\n                                            <Loader2 className=\"size-4 mr-2 animate-spin\" />\r\n                                            Saving...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Save className=\"size-4 mr-2\" />\r\n                                            Save Changes\r\n                                        </>\r\n                                    )}\r\n                                </Button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\[id]\\posts\\new\\_components\\post-preview.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5626,5629],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5626,5629],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":158,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7365,7368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7365,7368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":198,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9501,9504],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9501,9504],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":235,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11193,11196],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11193,11196],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is defined but never used.","line":268,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":268,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":268,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12876,12879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12876,12879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'message' is defined but never used.","line":294,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":294,"endColumn":45},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":294,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":294,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14041,14044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14041,14044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Heart, MessageCircle, Share2, MoreHorizontal, ThumbsUp, MessageSquare, Repeat, Send } from 'lucide-react';\r\nimport Image from 'next/image';\r\n\r\ninterface PostPreviewProps {\r\n    platforms: string[];\r\n    subject: string;\r\n    message: string;\r\n    mediaUrls: string[];\r\n    user?: {\r\n        name?: string;\r\n        image?: string;\r\n    };\r\n}\r\n\r\nexport function PostPreview({ platforms, subject, message, mediaUrls, user }: PostPreviewProps) {\r\n    const [activeTab, setActiveTab] = useState(platforms[0] || 'FACEBOOK');\r\n\r\n    if (platforms.length === 0) {\r\n        return (\r\n            <Card className=\"h-full\">\r\n                <CardHeader>\r\n                    <CardTitle>Preview</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"flex items-center justify-center h-[300px] text-muted-foreground\">\r\n                    Select a platform to see preview\r\n                </CardContent>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    // Update active tab if current active tab is not in selected platforms\r\n    if (!platforms.includes(activeTab) && platforms.length > 0) {\r\n        setActiveTab(platforms[0]);\r\n    }\r\n\r\n    return (\r\n        <Card className=\"h-full sticky top-4\">\r\n            <CardHeader>\r\n                <CardTitle>Post Preview</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n                <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n                    <TabsList className=\"w-full justify-start overflow-x-auto mb-4\">\r\n                        {platforms.map(platform => (\r\n                            <TabsTrigger key={platform} value={platform}>\r\n                                {platform.charAt(0) + platform.slice(1).toLowerCase()}\r\n                            </TabsTrigger>\r\n                        ))}\r\n                    </TabsList>\r\n\r\n                    {platforms.map(platform => (\r\n                        <TabsContent key={platform} value={platform} className=\"mt-0\">\r\n                            <div className=\"border rounded-lg overflow-hidden bg-white dark:bg-black\">\r\n                                {platform === 'FACEBOOK' && (\r\n                                    <FacebookPreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'INSTAGRAM' && (\r\n                                    <InstagramPreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'LINKEDIN' && (\r\n                                    <LinkedInPreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'TWITTER' && (\r\n                                    <TwitterPreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'YOUTUBE' && (\r\n                                    <YouTubePreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'PINTEREST' && (\r\n                                    <PinterestPreview \r\n                                        subject={subject} \r\n                                        message={message} \r\n                                        mediaUrls={mediaUrls} \r\n                                        user={user} \r\n                                    />\r\n                                )}\r\n                                {platform === 'SMS' && (\r\n                                    <SMSPreview message={message} />\r\n                                )}\r\n                                {platform === 'EMAIL' && (\r\n                                    <EmailPreview subject={subject} message={message} />\r\n                                )}\r\n                            </div>\r\n                        </TabsContent>\r\n                    ))}\r\n                </Tabs>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n\r\nfunction FacebookPreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"p-4 space-y-3\">\r\n            <div className=\"flex items-center gap-2\">\r\n                <Avatar className=\"size-10\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback>U</AvatarFallback>\r\n                </Avatar>\r\n                <div>\r\n                    <p className=\"font-semibold text-sm\">{user?.name || 'Your Page Name'}</p>\r\n                    <p className=\"text-xs text-muted-foreground\">Just now  <span className=\"text-xs\"></span></p>\r\n                </div>\r\n                <Button variant=\"ghost\" size=\"icon\" className=\"ml-auto h-8 w-8\">\r\n                    <MoreHorizontal className=\"size-4\" />\r\n                </Button>\r\n            </div>\r\n            {subject && <p className=\"font-bold\">{subject}</p>}\r\n            <p className=\"text-sm whitespace-pre-wrap\">{message || 'Your post content...'}</p>\r\n            {mediaUrls && mediaUrls.length > 0 && (\r\n                <MediaGrid mediaUrls={mediaUrls} />\r\n            )}\r\n            <div className=\"flex items-center justify-between pt-2 border-t text-muted-foreground\">\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-1 gap-2\">\r\n                    <ThumbsUp className=\"size-4\" /> Like\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-1 gap-2\">\r\n                    <MessageCircle className=\"size-4\" /> Comment\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-1 gap-2\">\r\n                    <Share2 className=\"size-4\" /> Share\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction LinkedInPreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"p-4 space-y-3 bg-white dark:bg-gray-900\">\r\n            <div className=\"flex items-center gap-2\">\r\n                <Avatar className=\"size-12 rounded-none\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback className=\"rounded-none\">Co</AvatarFallback>\r\n                </Avatar>\r\n                <div>\r\n                    <p className=\"font-semibold text-sm\">{user?.name || 'Company Name'}</p>\r\n                    <p className=\"text-xs text-muted-foreground\">1,234 followers</p>\r\n                    <p className=\"text-xs text-muted-foreground\">Just now  <span className=\"text-xs\"></span></p>\r\n                </div>\r\n                <Button variant=\"ghost\" size=\"icon\" className=\"ml-auto h-8 w-8\">\r\n                    <MoreHorizontal className=\"size-4\" />\r\n                </Button>\r\n            </div>\r\n            {subject && <p className=\"font-bold\">{subject}</p>}\r\n            <p className=\"text-sm whitespace-pre-wrap\">{message || 'Your post content...'}</p>\r\n            {mediaUrls && mediaUrls.length > 0 && (\r\n                <MediaGrid mediaUrls={mediaUrls} />\r\n            )}\r\n            <div className=\"flex items-center justify-between pt-2 border-t text-muted-foreground\">\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-col h-auto py-2 gap-1 text-xs\">\r\n                    <ThumbsUp className=\"size-4\" /> Like\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-col h-auto py-2 gap-1 text-xs\">\r\n                    <MessageCircle className=\"size-4\" /> Comment\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-col h-auto py-2 gap-1 text-xs\">\r\n                    <Repeat className=\"size-4\" /> Repost\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex-col h-auto py-2 gap-1 text-xs\">\r\n                    <Send className=\"size-4\" /> Send\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction InstagramPreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"space-y-3 pb-4\">\r\n            <div className=\"flex items-center gap-2 p-3\">\r\n                <Avatar className=\"size-8\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback>U</AvatarFallback>\r\n                </Avatar>\r\n                <p className=\"font-semibold text-sm\">{user?.name || 'username'}</p>\r\n                <Button variant=\"ghost\" size=\"icon\" className=\"ml-auto h-8 w-8\">\r\n                    <MoreHorizontal className=\"size-4\" />\r\n                </Button>\r\n            </div>\r\n            {mediaUrls && mediaUrls.length > 0 ? (\r\n                <MediaGrid mediaUrls={mediaUrls} square />\r\n            ) : (\r\n                <div className=\"aspect-square bg-muted flex items-center justify-center text-muted-foreground\">\r\n                    No media\r\n                </div>\r\n            )}\r\n            <div className=\"px-3 space-y-2\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Heart className=\"size-6\" />\r\n                    <MessageCircle className=\"size-6\" />\r\n                    <Send className=\"size-6\" />\r\n                    <div className=\"ml-auto\">\r\n                        <div className=\"size-6 border-2 border-current rounded-none\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"text-sm\">\r\n                    <p><span className=\"font-semibold\">{user?.name || 'username'}</span> {subject ? <span className=\"font-bold mr-1\">{subject}</span> : ''}{message}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction TwitterPreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"p-4 space-y-3\">\r\n            <div className=\"flex gap-3\">\r\n                <Avatar className=\"size-10\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback>U</AvatarFallback>\r\n                </Avatar>\r\n                <div className=\"flex-1 space-y-2\">\r\n                    <div className=\"flex items-center gap-1\">\r\n                        <p className=\"font-bold text-sm\">{user?.name || 'Name'}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">@{user?.name?.toLowerCase().replace(/\\s/g, '') || 'handle'}  Just now</p>\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"ml-auto h-8 w-8\">\r\n                            <MoreHorizontal className=\"size-4\" />\r\n                        </Button>\r\n                    </div>\r\n                    {subject && <p className=\"font-bold\">{subject}</p>}\r\n                    <p className=\"text-sm whitespace-pre-wrap\">{message || 'What is happening?!'}</p>\r\n                    {mediaUrls && mediaUrls.length > 0 && (\r\n                        <MediaGrid mediaUrls={mediaUrls} rounded />\r\n                    )}\r\n                    <div className=\"flex items-center justify-between text-muted-foreground max-w-md pt-2\">\r\n                        <MessageSquare className=\"size-4\" />\r\n                        <Repeat className=\"size-4\" />\r\n                        <Heart className=\"size-4\" />\r\n                        <Share2 className=\"size-4\" />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction YouTubePreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"space-y-3 pb-4\">\r\n            {mediaUrls && mediaUrls.length > 0 && mediaUrls[0].match(/\\.(mp4|mov|webm)$/i) ? (\r\n                <div className=\"aspect-video bg-black flex items-center justify-center text-white\">\r\n                    Video Preview\r\n                </div>\r\n            ) : (\r\n                <div className=\"aspect-video bg-muted flex items-center justify-center text-muted-foreground\">\r\n                    Video Thumbnail\r\n                </div>\r\n            )}\r\n            <div className=\"px-3 flex gap-3\">\r\n                <Avatar className=\"size-9\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback>U</AvatarFallback>\r\n                </Avatar>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-semibold text-sm line-clamp-2\">{subject || 'Video Title'}</p>\r\n                    <p className=\"text-xs text-muted-foreground\">{user?.name || 'Channel Name'}  0 views  Just now</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction PinterestPreview({ subject, message, mediaUrls, user }: any) {\r\n    return (\r\n        <div className=\"p-4 max-w-[236px] mx-auto\">\r\n            <div className=\"rounded-2xl overflow-hidden bg-muted mb-2\">\r\n                {mediaUrls && mediaUrls.length > 0 ? (\r\n                    <Image \r\n                        src={mediaUrls[0]} \r\n                        alt=\"Pin\" \r\n                        width={236} \r\n                        height={354} \r\n                        className=\"object-cover w-full h-auto\"\r\n                    />\r\n                ) : (\r\n                    <div className=\"aspect-[2/3] flex items-center justify-center text-muted-foreground\">\r\n                        Pin Image\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <p className=\"font-semibold text-sm truncate\">{subject || 'Pin Title'}</p>\r\n            <div className=\"flex items-center gap-2 mt-1\">\r\n                <Avatar className=\"size-6\">\r\n                    <AvatarImage src={user?.image} />\r\n                    <AvatarFallback>U</AvatarFallback>\r\n                </Avatar>\r\n                <p className=\"text-xs text-muted-foreground truncate\">{user?.name || 'Username'}</p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction SMSPreview({ message }: { message: string }) {\r\n    return (\r\n        <div className=\"p-4 bg-gray-100 dark:bg-gray-900 rounded-lg max-w-sm mx-auto my-4\">\r\n            <div className=\"bg-blue-500 text-white p-3 rounded-2xl rounded-tr-none max-w-[80%] ml-auto mb-1\">\r\n                <p className=\"text-sm\">{message || 'Message content...'}</p>\r\n            </div>\r\n            <p className=\"text-[10px] text-muted-foreground text-right\">Delivered</p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction EmailPreview({ subject, message }: { subject: string, message: string }) {\r\n    return (\r\n        <div className=\"border rounded-lg overflow-hidden\">\r\n            <div className=\"bg-muted p-2 border-b text-xs space-y-1\">\r\n                <p><span className=\"text-muted-foreground\">To:</span> Recipient</p>\r\n                <p><span className=\"text-muted-foreground\">Subject:</span> {subject || 'No Subject'}</p>\r\n            </div>\r\n            <div className=\"p-4 min-h-[200px] text-sm whitespace-pre-wrap\">\r\n                {message || 'Email content...'}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MediaGrid({ mediaUrls, square, rounded }: { mediaUrls: string[], square?: boolean, rounded?: boolean }) {\r\n    const count = mediaUrls.length;\r\n    const displayUrls = mediaUrls.slice(0, 4);\r\n    \r\n    return (\r\n        <div className={`grid gap-0.5 ${count === 1 ? 'grid-cols-1' : 'grid-cols-2'} ${rounded ? 'rounded-xl overflow-hidden border' : ''}`}>\r\n            {displayUrls.map((url, index) => (\r\n                <div key={index} className={`relative ${square ? 'aspect-square' : (count === 1 ? 'aspect-video' : 'aspect-square')} bg-muted`}>\r\n                    {url.match(/\\.(mp4|mov|webm)$/i) ? (\r\n                        <div className=\"flex items-center justify-center h-full bg-black/10\">\r\n                            <div className=\"size-8 rounded-full bg-white/80 flex items-center justify-center\">\r\n                                <div className=\"ml-1 size-0 border-y-[6px] border-y-transparent border-l-[10px] border-l-black\" />\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <Image \r\n                            src={url} \r\n                            alt={`Media ${index}`} \r\n                            fill \r\n                            className=\"object-cover\"\r\n                        />\r\n                    )}\r\n                    {index === 3 && count > 4 && (\r\n                        <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center text-white font-bold text-xl\">\r\n                            +{count - 4}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\[id]\\posts\\new\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageIcon' is defined but never used.","line":34,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useParams' is defined but never used.","line":39,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":39,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2497,2500],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2497,2500],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loadingContacts' is assigned a value but never used.","line":76,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":82,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2915,2918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2915,2918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3157,3160],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3157,3160],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loadingTemplates' is assigned a value but never used.","line":90,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":90,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'fetchTemplates' is assigned a value but never used.","line":356,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":356,"endColumn":25}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n    ArrowLeft,\r\n    Loader2,\r\n    Save,\r\n    Eye,\r\n    Mail,\r\n    MessageSquare,\r\n    Phone,\r\n    Send,\r\n    Facebook,\r\n    Instagram,\r\n    Linkedin,\r\n    Youtube,\r\n    Upload,\r\n    X,\r\n    FileText,\r\n    Image as ImageIcon,\r\n    Video\r\n} from 'lucide-react';\r\nimport { useUser } from '@clerk/nextjs';\r\nimport { PostPreview } from './_components/post-preview';\r\nimport { useRouter, useParams } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\nimport Image from 'next/image';\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from '@/components/ui/select';\r\nimport React from 'react'; // Import React for React.use\r\n\r\nexport default function NewPostPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const { user } = useUser();\r\n    const router = useRouter();\r\n    const resolvedParams = React.use(params);\r\n    const campaignId = resolvedParams.id;\r\n\r\n    // Form state\r\n    const [subject, setSubject] = useState('');\r\n    const [message, setMessage] = useState('');\r\n    const [selectedPlatform, setSelectedPlatform] = useState<string | null>(null);\r\n    const [mediaUrls, setMediaUrls] = useState<string[]>([]);\r\n\r\n    // Platform specific fields\r\n    const [youtubeTags, setYoutubeTags] = useState('');\r\n    const [youtubePrivacy, setYoutubePrivacy] = useState('public');\r\n    const [pinterestBoardId, setPinterestBoardId] = useState('');\r\n    const [pinterestLink, setPinterestLink] = useState('');\r\n    const [senderEmail, setSenderEmail] = useState('');\r\n    const [scheduledPostTime, setScheduledPostTime] = useState('');\r\n    const [saving, setSaving] = useState(false);\r\n    const [organisationPlatforms, setOrganisationPlatforms] = useState<string[]>([]);\r\n    const [loadingPlatforms, setLoadingPlatforms] = useState(true);\r\n    const [campaignContacts, setCampaignContacts] = useState<any[]>([]);\r\n    const [loadingContacts, setLoadingContacts] = useState(true);\r\n    // const [loadingContacts, setLoadingContacts] = useState(true); // Duplicate declaration removed\r\n    // const [mediaUrl, setMediaUrl] = useState(''); // Replaced by mediaUrls\r\n    const [uploadingMedia, setUploadingMedia] = useState(false);\r\n    \r\n    // Pinterest Boards\r\n    const [pinterestBoards, setPinterestBoards] = useState<any[]>([]);\r\n    const [loadingPinterestBoards, setLoadingPinterestBoards] = useState(false);\r\n    \r\n    // Reel state\r\n    const [isReel, setIsReel] = useState(false);\r\n\r\n    // Template state\r\n    const [templates, setTemplates] = useState<any[]>([]);\r\n    const [loadingTemplates, setLoadingTemplates] = useState(false);\r\n    const [selectedTemplateId, setSelectedTemplateId] = useState<string>('none');\r\n\r\n    // Fetch campaign contacts\r\n    useEffect(() => {\r\n        const fetchCampaignContacts = async () => {\r\n            try {\r\n                setLoadingContacts(true);\r\n                const response = await fetch(`/api/campaigns/${campaignId}`);\r\n                if (!response.ok) {\r\n                    console.error('Failed to fetch campaign');\r\n                    return;\r\n                }\r\n                const data = await response.json();\r\n                setCampaignContacts(data.campaign.contacts || []);\r\n            } catch (error) {\r\n                console.error('Error fetching campaign contacts:', error);\r\n            } finally {\r\n                setLoadingContacts(false);\r\n            }\r\n        };\r\n\r\n        fetchCampaignContacts();\r\n    }, [campaignId]);\r\n\r\n    // Fetch organisation platforms\r\n    useEffect(() => {\r\n        const fetchOrgPlatforms = async () => {\r\n            try {\r\n                setLoadingPlatforms(true);\r\n                const response = await fetch('/api/Organisation/GetPlatforms');\r\n                if (!response.ok) {\r\n                    // If API fails, show all platforms\r\n                    setOrganisationPlatforms(['EMAIL', 'SMS', 'WHATSAPP', 'FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST']);\r\n                    return;\r\n                }\r\n                const data = await response.json();\r\n                const platforms = data.platforms || [];\r\n                // Filter out admin-only platforms (EMAIL, SMS, WHATSAPP are managed by admin)\r\n                const availablePlatforms = platforms.filter((p: string) =>\r\n                    !['EMAIL', 'SMS', 'WHATSAPP'].includes(p.toUpperCase())\r\n                );\r\n                // Add EMAIL, SMS, WHATSAPP as they're always available\r\n                setOrganisationPlatforms(['EMAIL', 'SMS', 'WHATSAPP', ...availablePlatforms]);\r\n            } catch (error) {\r\n                console.error('Error fetching organisation platforms:', error);\r\n                // Default to all platforms on error\r\n                setOrganisationPlatforms(['EMAIL', 'SMS', 'WHATSAPP', 'FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST']);\r\n            } finally {\r\n                setLoadingPlatforms(false);\r\n            }\r\n        };\r\n\r\n        fetchOrgPlatforms();\r\n    }, []);\r\n\r\n    // Fetch Pinterest boards\r\n    useEffect(() => {\r\n        if (selectedPlatform === 'PINTEREST') {\r\n            const fetchBoards = async () => {\r\n                try {\r\n                    setLoadingPinterestBoards(true);\r\n                    const response = await fetch('/api/socialmedia/pinterest/boards');\r\n                    if (response.ok) {\r\n                        const data = await response.json();\r\n                        setPinterestBoards(data.boards || []);\r\n                        // If only one board, select it\r\n                        if (data.boards && data.boards.length === 1) {\r\n                            setPinterestBoardId(data.boards[0].id);\r\n                        }\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error fetching Pinterest boards:', error);\r\n                    toast.error('Failed to fetch Pinterest boards');\r\n                } finally {\r\n                    setLoadingPinterestBoards(false);\r\n                }\r\n            };\r\n            fetchBoards();\r\n        }\r\n    }, [selectedPlatform]);\r\n\r\n    // Insert variable placeholder\r\n    const insertVariable = (variable: string) => {\r\n        setMessage(message + `{{${variable}}}`);\r\n    };\r\n\r\n    // Get preview content with variables replaced\r\n    const getPreviewContent = () => {\r\n        // Use first contact from campaign for preview, or fallback to placeholder\r\n        const sampleContact = campaignContacts.length > 0 ? campaignContacts[0] : null;\r\n\r\n        return message\r\n            .replace(/{{name}}/g, sampleContact?.contactName || 'John Doe')\r\n            .replace(/{{email}}/g, sampleContact?.contactEmail || 'john@example.com')\r\n            .replace(/{{phone}}/g, sampleContact?.contactMobile || '+1234567890')\r\n            .replace(/{{company}}/g, 'Acme Corp'); // Company field not in contact model\r\n    };\r\n\r\n    // Get platform icon\r\n    const getPlatformIcon = (platform: string) => {\r\n        switch (platform) {\r\n            case 'EMAIL':\r\n                return Mail;\r\n            case 'SMS':\r\n                return MessageSquare;\r\n            case 'WHATSAPP':\r\n                return Phone;\r\n            case 'FACEBOOK':\r\n                return Facebook;\r\n            case 'INSTAGRAM':\r\n                return Instagram;\r\n            case 'LINKEDIN':\r\n                return Linkedin;\r\n            case 'YOUTUBE':\r\n                return Youtube;\r\n            default:\r\n                return Send;\r\n        }\r\n    };\r\n\r\n    // Handle file upload\r\n    const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = e.target.files;\r\n        if (!files || files.length === 0) return;\r\n\r\n        // Limit to 10 images\r\n        if (mediaUrls.length + files.length > 10) {\r\n            toast.error('You can upload a maximum of 10 images');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setUploadingMedia(true);\r\n            const newUrls: string[] = [];\r\n\r\n            for (let i = 0; i < files.length; i++) {\r\n                const file = files[i];\r\n                const formData = new FormData();\r\n                formData.append('file', file);\r\n\r\n                const response = await fetch('/api/socialmedia/upload-media-file', {\r\n                    method: 'POST',\r\n                    body: formData,\r\n                });\r\n\r\n                if (!response.ok) throw new Error('Upload failed');\r\n\r\n                const data = await response.json();\r\n                newUrls.push(data.url);\r\n            }\r\n\r\n            setMediaUrls(prev => [...prev, ...newUrls]);\r\n            toast.success('Files uploaded successfully');\r\n        } catch (error) {\r\n            console.error('Error uploading file:', error);\r\n            toast.error('Failed to upload file');\r\n        } finally {\r\n            setUploadingMedia(false);\r\n        }\r\n    };\r\n\r\n    const removeMedia = (index: number) => {\r\n        setMediaUrls(prev => prev.filter((_, i) => i !== index));\r\n    };\r\n\r\n    // Handle form submit\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        // Validation\r\n        if (!selectedPlatform) {\r\n            toast.error('Please select a platform');\r\n            return;\r\n        }\r\n\r\n        // SMS validation\r\n        if (selectedPlatform === 'SMS') {\r\n            if (!message) {\r\n                toast.error('Please enter a message for SMS');\r\n                return;\r\n            }\r\n        }\r\n        // Email validation\r\n        if (selectedPlatform === 'EMAIL') {\r\n            if (!senderEmail) {\r\n                toast.error('Please enter sender email');\r\n                return;\r\n            }\r\n            if (!subject) {\r\n                toast.error('Please enter a subject');\r\n                return;\r\n            }\r\n            if (!message) {\r\n                toast.error('Please enter a message');\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Social Media validation\r\n        const isSocialPlatform = selectedPlatform && !['EMAIL', 'SMS'].includes(selectedPlatform);\r\n        if (isSocialPlatform) {\r\n            if (!subject && selectedPlatform !== 'SMS') {\r\n                toast.error('Please enter a title');\r\n                return;\r\n            }\r\n            if (!message) {\r\n                toast.error('Please enter a message');\r\n                return;\r\n            }\r\n\r\n            // Media validation\r\n            if ((selectedPlatform === 'INSTAGRAM' || selectedPlatform === 'YOUTUBE' || selectedPlatform === 'PINTEREST') && mediaUrls.length === 0) {\r\n                toast.error(`Instagram, YouTube, and Pinterest posts require media`);\r\n                return;\r\n            }\r\n\r\n            // YouTube specific validation\r\n            if (selectedPlatform === 'YOUTUBE' && mediaUrls.length > 0 && !mediaUrls[0].match(/\\.(mp4|mov|webm)$/i)) {\r\n                 toast.error('YouTube requires a video file');\r\n                 return;\r\n            }\r\n        }\r\n\r\n        try {\r\n            setSaving(true);\r\n\r\n            const response = await fetch(`/api/campaigns/${campaignId}/posts`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    subject: subject || null,\r\n                    message: message || null,\r\n                    type: selectedPlatform, // Send single type\r\n                    senderEmail: selectedPlatform === 'EMAIL' ? senderEmail : null,\r\n                    scheduledPostTime: scheduledPostTime || null,\r\n                    mediaUrls: mediaUrls, // Send array\r\n                    youtubeTags: youtubeTags ? youtubeTags.split(',').map(t => t.trim()) : [],\r\n                    youtubePrivacy,\r\n                    pinterestBoardId,\r\n                    pinterestLink,\r\n                    isReel // Send isReel flag\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const error = await response.json();\r\n                throw new Error(error.error || 'Failed to create post');\r\n            }\r\n\r\n            toast.success('Post created successfully');\r\n            router.push(`/organisation/campaigns/${campaignId}/posts`);\r\n        } catch (error) {\r\n            console.error('Error creating post:', error);\r\n            toast.error(error instanceof Error ? error.message : 'Failed to create post');\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    // Handle platform selection toggle\r\n    const togglePlatform = (platform: string) => {\r\n        setSelectedPlatform(prev => prev === platform ? null : platform);\r\n    };\r\n\r\n    // Fetch templates for selected platform\r\n    const fetchTemplates = async (platform: string) => {\r\n        try {\r\n            setLoadingTemplates(true);\r\n            const response = await fetch(`/api/templates?platform=${platform}&isActive=true`);\r\n            if (!response.ok) {\r\n                setTemplates([]);\r\n                return;\r\n            }\r\n            const data = await response.json();\r\n            setTemplates(data.success ? data.data : []);\r\n        } catch (error) {\r\n            console.error('Error fetching templates:', error);\r\n            setTemplates([]);\r\n        } finally {\r\n            setLoadingTemplates(false);\r\n        }\r\n    };\r\n\r\n    // Handle template selection\r\n    const handleTemplateSelect = (templateId: string) => {\r\n        setSelectedTemplateId(templateId);\r\n\r\n        if (!templateId || templateId === 'none') {\r\n            // Clear the form if \"none\" is selected\r\n            return;\r\n        }\r\n\r\n        const template = templates.find(t => t.id.toString() === templateId);\r\n        if (!template) return;\r\n\r\n        // Fill form with template data\r\n        setSubject(template.subject || '');\r\n        setMessage(template.content || '');\r\n\r\n        toast.success('Template loaded! You can now edit the content.');\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-5xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => router.back()}\r\n                            >\r\n                                <ArrowLeft className=\"size-4 mr-2\" />\r\n                                Back\r\n                            </Button>\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">New Post</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    Create a new post for this campaign\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                            <div className=\"lg:col-span-2\">\r\n                                <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                                    {/* Post Details */}\r\n                                    <Card>\r\n                                        <CardHeader>\r\n                                            <CardTitle>Post Details</CardTitle>\r\n                                            <CardDescription>\r\n                                                Create content for your campaign\r\n                                            </CardDescription>\r\n                                        </CardHeader>\r\n                                        <CardContent className=\"space-y-6\">\r\n                                            {/* Platform Selection */}\r\n                                            <div className=\"space-y-3\">\r\n                                                <Label>Select Platform *</Label>\r\n                                                {loadingPlatforms ? (\r\n                                                    <div className=\"flex items-center gap-2 p-4\">\r\n                                                        <Loader2 className=\"size-4 animate-spin\" />\r\n                                                        <span className=\"text-sm text-muted-foreground\">Loading platforms...</span>\r\n                                                    </div>\r\n                                                ) : (\r\n                                                    <>\r\n                                                        <div className=\"flex flex-wrap gap-3\">\r\n                                                            {organisationPlatforms.map((platform) => {\r\n                                                                const isSelected = selectedPlatform === platform;\r\n                                                                const Icon = getPlatformIcon(platform);\r\n\r\n                                                                return (\r\n                                                                    <button\r\n                                                                        key={platform}\r\n                                                                        type=\"button\"\r\n                                                                        onClick={() => togglePlatform(platform)}\r\n                                                                        className={`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all min-w-[100px] ${\r\n                                                                            isSelected\r\n                                                                                ? 'border-primary bg-primary/10 shadow-sm'\r\n                                                                                : 'border-border hover:border-primary/50 hover:bg-muted/50'\r\n                                                                        }`}\r\n                                                                    >\r\n                                                                        <Icon className={`size-6 ${isSelected ? 'text-primary' : 'text-muted-foreground'}`} />\r\n                                                                        <span className={`text-xs font-medium ${isSelected ? 'text-primary' : 'text-muted-foreground'}`}>\r\n                                                                            {platform}\r\n                                                                        </span>\r\n                                                                    </button>\r\n                                                                );\r\n                                                            })}\r\n                                                        </div>\r\n                                                        <p className=\"text-xs text-muted-foreground\">\r\n                                                            Select a platform to configure your post\r\n                                                        </p>\r\n                                                    </>\r\n                                                )}\r\n                                            </div>\r\n\r\n                                            {/* Template Selection */}\r\n                                            {selectedPlatform && templates.length > 0 && (\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"template\">Use a Template (Optional)</Label>\r\n                                                    <Select value={selectedTemplateId || \"none\"} onValueChange={handleTemplateSelect}>\r\n                                                        <SelectTrigger id=\"template\">\r\n                                                            <SelectValue placeholder=\"Select a template to start with...\" />\r\n                                                        </SelectTrigger>\r\n                                                        <SelectContent>\r\n                                                            <SelectItem value=\"none\">None - Start from scratch</SelectItem>\r\n                                                            {templates.map((template) => (\r\n                                                                <SelectItem key={template.id} value={template.id.toString()}>\r\n                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                        <FileText className=\"size-4\" />\r\n                                                                        <span>{template.name}</span>\r\n                                                                        {template.category && (\r\n                                                                            <span className=\"text-xs text-muted-foreground\">\r\n                                                                                ({template.category})\r\n                                                                            </span>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                </SelectItem>\r\n                                                            ))}\r\n                                                        </SelectContent>\r\n                                                    </Select>\r\n                                                    <p className=\"text-xs text-muted-foreground\">\r\n                                                        Templates will pre-fill the form fields. You can edit them after selection.\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Email Form */}\r\n                                            {selectedPlatform === 'EMAIL' && (\r\n                                                <>\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <Label htmlFor=\"senderEmail\">Sender Email *</Label>\r\n                                                        <Input\r\n                                                            id=\"senderEmail\"\r\n                                                            type=\"email\"\r\n                                                            placeholder=\"sender@example.com\"\r\n                                                            value={senderEmail}\r\n                                                            onChange={(e) => setSenderEmail(e.target.value)}\r\n                                                            required={selectedPlatform === 'EMAIL'}\r\n                                                        />\r\n                                                    </div>\r\n\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <Label htmlFor=\"subject\">Subject *</Label>\r\n                                                        <Input\r\n                                                            id=\"subject\"\r\n                                                            placeholder=\"Enter email subject\"\r\n                                                            value={subject}\r\n                                                            onChange={(e) => setSubject(e.target.value)}\r\n                                                            required={selectedPlatform === 'EMAIL'}\r\n                                                        />\r\n                                                    </div>\r\n\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <div className=\"flex items-center justify-between\">\r\n                                                            <Label htmlFor=\"message\">Message Body *</Label>\r\n                                                            <Dialog>\r\n                                                                <DialogTrigger asChild>\r\n                                                                    <Button type=\"button\" variant=\"outline\" size=\"sm\">\r\n                                                                        <Eye className=\"size-4 mr-2\" />\r\n                                                                        Preview\r\n                                                                    </Button>\r\n                                                                </DialogTrigger>\r\n                                                                <DialogContent className=\"max-w-2xl\">\r\n                                                                    <DialogHeader>\r\n                                                                        <DialogTitle>Email Preview</DialogTitle>\r\n                                                                        <DialogDescription>\r\n                                                                            Preview how your email will look with sample data\r\n                                                                        </DialogDescription>\r\n                                                                    </DialogHeader>\r\n                                                                    <div className=\"space-y-4\">\r\n                                                                        <div>\r\n                                                                            <p className=\"text-sm font-medium mb-1\">Subject:</p>\r\n                                                                            <p className=\"text-sm text-muted-foreground\">{subject || 'No subject'}</p>\r\n                                                                        </div>\r\n                                                                        <div>\r\n                                                                            <p className=\"text-sm font-medium mb-1\">Message:</p>\r\n                                                                            <div className=\"p-4 border rounded-lg bg-muted/50 whitespace-pre-wrap\">\r\n                                                                                {getPreviewContent() || 'No message'}\r\n                                                                            </div>\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                </DialogContent>\r\n                                                            </Dialog>\r\n                                                        </div>\r\n                                                        <Textarea\r\n                                                            id=\"message\"\r\n                                                            placeholder=\"Enter your email message\"\r\n                                                            value={message}\r\n                                                            onChange={(e) => setMessage(e.target.value)}\r\n                                                            rows={8}\r\n                                                            required={selectedPlatform === 'EMAIL'}\r\n                                                        />\r\n                                                        <div className=\"flex flex-wrap gap-2\">\r\n                                                            <p className=\"text-xs text-muted-foreground w-full\">\r\n                                                                Insert variables:\r\n                                                            </p>\r\n                                                            <Button\r\n                                                                type=\"button\"\r\n                                                                variant=\"outline\"\r\n                                                                size=\"sm\"\r\n                                                                onClick={() => insertVariable('name')}\r\n                                                            >\r\n                                                                {'{{name}}'}\r\n                                                            </Button>\r\n                                                            <Button\r\n                                                                type=\"button\"\r\n                                                                variant=\"outline\"\r\n                                                                size=\"sm\"\r\n                                                                onClick={() => insertVariable('email')}\r\n                                                            >\r\n                                                                {'{{email}}'}\r\n                                                            </Button>\r\n                                                            <Button\r\n                                                                type=\"button\"\r\n                                                                variant=\"outline\"\r\n                                                                size=\"sm\"\r\n                                                                onClick={() => insertVariable('phone')}\r\n                                                            >\r\n                                                                {'{{phone}}'}\r\n                                                            </Button>\r\n                                                            <Button\r\n                                                                type=\"button\"\r\n                                                                variant=\"outline\"\r\n                                                                size=\"sm\"\r\n                                                                onClick={() => insertVariable('company')}\r\n                                                            >\r\n                                                                {'{{company}}'}\r\n                                                            </Button>\r\n                                                        </div>\r\n                                                        <p className=\"text-xs text-muted-foreground\">\r\n                                                            Variables will be replaced with actual contact data when sent\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </>\r\n                                            )}\r\n\r\n                                            {/* Other Platforms Form */}\r\n                                            {selectedPlatform && selectedPlatform !== 'EMAIL' && (\r\n                                                <div className=\"space-y-4\">\r\n                                                    {/* Title Field for Social Media & WhatsApp */}\r\n                                                    {selectedPlatform !== 'SMS' && (\r\n                                                        <div className=\"space-y-2\">\r\n                                                            <Label htmlFor=\"subject\">Title *</Label>\r\n                                                            <Input\r\n                                                                id=\"subject\"\r\n                                                                placeholder=\"Enter post title\"\r\n                                                                value={subject}\r\n                                                                onChange={(e) => setSubject(e.target.value)}\r\n                                                                required={selectedPlatform !== 'SMS' && selectedPlatform !== 'EMAIL'}\r\n                                                            />\r\n                                                            <p className=\"text-xs text-muted-foreground\">\r\n                                                                This will be displayed as the bold header of your post\r\n                                                            </p>\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <Label htmlFor=\"message\">Message *</Label>\r\n                                                        <Textarea\r\n                                                            id=\"message\"\r\n                                                            placeholder=\"Enter your message\"\r\n                                                            value={message}\r\n                                                            onChange={(e) => setMessage(e.target.value)}\r\n                                                            rows={6}\r\n                                                            required={true}\r\n                                                        />\r\n                                                        <div className=\"flex justify-between text-xs text-muted-foreground mt-1\">\r\n                                                            <span>\r\n                                                                {message.length} characters\r\n                                                            </span>\r\n                                                            <span>\r\n                                                                {selectedPlatform === 'SMS' && `Limit: 160 | `}\r\n                                                                {selectedPlatform === 'TWITTER' && `Limit: 280 | `}\r\n                                                                {selectedPlatform === 'INSTAGRAM' && `Limit: 2200`}\r\n                                                            </span>\r\n                                                        </div>\r\n                                                        <p className=\"text-xs text-muted-foreground\">\r\n                                                            {selectedPlatform === 'SMS' && 'SMS messages are limited to 160 characters. '}\r\n                                                            {selectedPlatform === 'WHATSAPP' && 'WhatsApp messages support rich formatting. '}\r\n                                                            {selectedPlatform === 'FACEBOOK' && 'Create engaging content for your Facebook audience. '}\r\n                                                            {selectedPlatform === 'INSTAGRAM' && 'Share visual content with your Instagram followers. '}\r\n                                                            {selectedPlatform === 'LINKEDIN' && 'Professional content for your LinkedIn network. '}\r\n                                                            {selectedPlatform === 'YOUTUBE' && 'Video description or community post. '}\r\n                                                        </p>\r\n                                                    </div>\r\n\r\n\r\n                                                    {/* Media Upload */}\r\n                                                    {['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST'].includes(selectedPlatform) && (\r\n                                                        <div className=\"space-y-2\">\r\n                                                            <div className=\"flex items-center justify-between mb-2\">\r\n                                                                <Label>\r\n                                                                    {selectedPlatform === 'YOUTUBE' ? 'Video *' : 'Media (Photo/Video)'}\r\n                                                                    {(selectedPlatform === 'INSTAGRAM' || selectedPlatform === 'PINTEREST') && ' *'}\r\n                                                                </Label>\r\n                                                                <span className=\"text-xs text-muted-foreground\">{mediaUrls.length}/10 uploaded</span>\r\n                                                            </div>\r\n\r\n                                                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\r\n                                                                {mediaUrls.map((url, index) => (\r\n                                                                    <div key={index} className=\"relative rounded-lg overflow-hidden border bg-muted/50 aspect-square group\">\r\n                                                                        {url.match(/\\.(mp4|mov|webm)$/i) ? (\r\n                                                                            <div className=\"flex items-center justify-center h-full\">\r\n                                                                                <Video className=\"size-8 text-muted-foreground\" />\r\n                                                                            </div>\r\n                                                                        ) : (\r\n                                                                            <Image\r\n                                                                                src={url}\r\n                                                                                alt={`Media ${index + 1}`}\r\n                                                                                fill\r\n                                                                                className=\"object-cover\"\r\n                                                                            />\r\n                                                                        )}\r\n                                                                        <button\r\n                                                                            type=\"button\"\r\n                                                                            onClick={() => removeMedia(index)}\r\n                                                                            className=\"absolute top-1 right-1 bg-black/50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                                                                        >\r\n                                                                            <X className=\"size-3\" />\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                ))}\r\n\r\n                                                                {mediaUrls.length < 10 && (\r\n                                                                    <label htmlFor=\"media-upload\" className=\"flex flex-col items-center justify-center aspect-square border-2 border-dashed rounded-lg cursor-pointer hover:bg-muted/50 transition-colors\">\r\n                                                                        <Upload className=\"size-6 text-muted-foreground mb-1\" />\r\n                                                                        <span className=\"text-xs text-muted-foreground\">Add</span>\r\n                                                                        <input\r\n                                                                            id=\"media-upload\"\r\n                                                                            type=\"file\"\r\n                                                                            className=\"hidden\"\r\n                                                                            accept={selectedPlatform === 'YOUTUBE' ? 'video/*' : 'image/*,video/*'}\r\n                                                                            onChange={handleFileUpload}\r\n                                                                            disabled={uploadingMedia}\r\n                                                                            multiple\r\n                                                                        />\r\n                                                                    </label>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                    {/* Reel Option for Facebook/Instagram */}\r\n                                                    {(selectedPlatform === 'FACEBOOK' || selectedPlatform === 'INSTAGRAM') && \r\n                                                      mediaUrls.some(url => url.match(/\\.(mp4|mov|webm)$/i)) && (\r\n                                                        <div className=\"space-y-4 pt-4 border-t\">\r\n                                                            <div className=\"flex items-center space-x-2\">\r\n                                                                <input\r\n                                                                    type=\"checkbox\"\r\n                                                                    id=\"isReel\"\r\n                                                                    checked={isReel}\r\n                                                                    onChange={(e) => setIsReel(e.target.checked)}\r\n                                                                    className=\"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary\"\r\n                                                                />\r\n                                                                <Label htmlFor=\"isReel\" className=\"font-medium cursor-pointer\">\r\n                                                                    Post as Reel\r\n                                                                </Label>\r\n                                                            </div>\r\n                                                            <p className=\"text-xs text-muted-foreground pl-6\">\r\n                                                                Upload as a short-form video (Reel). Recommended for vertical videos (9:16) under 90 seconds.\r\n                                                            </p>\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    {/* YouTube Specific Fields */}\r\n                                                    {selectedPlatform === 'YOUTUBE' && (\r\n                                                        <div className=\"space-y-4 pt-4 border-t\">\r\n                                                            <h3 className=\"font-medium flex items-center gap-2\">\r\n                                                                <Youtube className=\"size-4 text-red-600\" />\r\n                                                                YouTube Settings\r\n                                                            </h3>\r\n                                                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                                                <div className=\"space-y-2\">\r\n                                                                    <Label htmlFor=\"youtubeTags\">Tags (comma separated)</Label>\r\n                                                                    <Input\r\n                                                                        id=\"youtubeTags\"\r\n                                                                        placeholder=\"tutorial, tech, campzeo\"\r\n                                                                        value={youtubeTags}\r\n                                                                        onChange={(e) => setYoutubeTags(e.target.value)}\r\n                                                                    />\r\n                                                                </div>\r\n                                                                <div className=\"space-y-2\">\r\n                                                                    <Label htmlFor=\"youtubePrivacy\">Privacy Status</Label>\r\n                                                                    <Select value={youtubePrivacy} onValueChange={setYoutubePrivacy}>\r\n                                                                        <SelectTrigger id=\"youtubePrivacy\">\r\n                                                                            <SelectValue />\r\n                                                                        </SelectTrigger>\r\n                                                                        <SelectContent>\r\n                                                                            <SelectItem value=\"public\">Public</SelectItem>\r\n                                                                            <SelectItem value=\"private\">Private</SelectItem>\r\n                                                                            <SelectItem value=\"unlisted\">Unlisted</SelectItem>\r\n                                                                        </SelectContent>\r\n                                                                    </Select>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    {/* Pinterest Specific Fields */}\r\n                                                    {selectedPlatform === 'PINTEREST' && (\r\n                                                        <div className=\"space-y-4 pt-4 border-t\">\r\n                                                            <h3 className=\"font-medium flex items-center gap-2\">\r\n                                                                <div className=\"p-1 bg-red-600 rounded-full\">\r\n                                                                    <span className=\"text-white text-[10px] font-bold\">P</span>\r\n                                                                </div>\r\n                                                                Pinterest Settings\r\n                                                            </h3>\r\n                                                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                                                <div className=\"space-y-2\">\r\n                                                                    <Label htmlFor=\"pinterestBoardId\">Board *</Label>\r\n                                                                    {loadingPinterestBoards ? (\r\n                                                                        <div className=\"flex items-center gap-2 h-10 px-3 border rounded-md bg-muted/50\">\r\n                                                                            <Loader2 className=\"size-4 animate-spin text-muted-foreground\" />\r\n                                                                            <span className=\"text-sm text-muted-foreground\">Loading boards...</span>\r\n                                                                        </div>\r\n                                                                    ) : (\r\n                                                                        <Select value={pinterestBoardId} onValueChange={setPinterestBoardId}>\r\n                                                                            <SelectTrigger id=\"pinterestBoardId\">\r\n                                                                                <SelectValue placeholder=\"Select a board\" />\r\n                                                                            </SelectTrigger>\r\n                                                                            <SelectContent>\r\n                                                                                {pinterestBoards.length === 0 ? (\r\n                                                                                    <SelectItem value=\"none\" disabled>No boards found</SelectItem>\r\n                                                                                ) : (\r\n                                                                                    pinterestBoards.map((board) => (\r\n                                                                                        <SelectItem key={board.id} value={board.id}>\r\n                                                                                            {board.name}\r\n                                                                                        </SelectItem>\r\n                                                                                    ))\r\n                                                                                )}\r\n                                                                            </SelectContent>\r\n                                                                        </Select>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                                <div className=\"space-y-2\">\r\n                                                                    <Label htmlFor=\"pinterestLink\">Destination Link</Label>\r\n                                                                    <Input\r\n                                                                        id=\"pinterestLink\"\r\n                                                                        placeholder=\"https://yourwebsite.com\"\r\n                                                                        value={pinterestLink}\r\n                                                                        onChange={(e) => setPinterestLink(e.target.value)}\r\n                                                                    />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                            )}\r\n\r\n                                            {/* Schedule Field */}\r\n                                            {selectedPlatform && (\r\n                                                <div className=\"space-y-2\">\r\n                                                    <Label htmlFor=\"scheduledPostTime\">Schedule Post (Optional)</Label>\r\n                                                    <Input\r\n                                                        id=\"scheduledPostTime\"\r\n                                                        type=\"datetime-local\"\r\n                                                        value={scheduledPostTime}\r\n                                                        onChange={(e) => setScheduledPostTime(e.target.value)}\r\n                                                    />\r\n                                                    <p className=\"text-xs text-muted-foreground\">\r\n                                                        Leave empty to send immediately\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </CardContent>\r\n                                    </Card>\r\n\r\n                                    {/* Actions */}\r\n                                    <div className=\"flex justify-end gap-4\">\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"outline\"\r\n                                            onClick={() => router.back()}\r\n                                            disabled={saving}\r\n                                        >\r\n                                            Cancel\r\n                                        </Button>\r\n                                        <Button type=\"submit\" disabled={saving || !selectedPlatform || uploadingMedia}>\r\n                                            {saving ? (\r\n                                                <>\r\n                                                    <Loader2 className=\"size-4 mr-2 animate-spin\" />\r\n                                                    Creating...\r\n                                                </>\r\n                                            ) : (\r\n                                                <>\r\n                                                    <Save className=\"size-4 mr-2\" />\r\n                                                    Create Post\r\n                                                </>\r\n                                            )}\r\n                                        </Button>\r\n                                    </div>\r\n                                </form>\r\n                            </div>\r\n\r\n                            {/* Preview Column */}\r\n                            <div className=\"lg:col-span-1\">\r\n                                <div className=\"sticky top-6\">\r\n                                    <PostPreview \r\n                                        platforms={selectedPlatform ? [selectedPlatform] : []}\r\n                                        subject={subject}\r\n                                        message={message}\r\n                                        mediaUrls={mediaUrls}\r\n                                        user={{\r\n                                            name: user?.fullName || user?.firstName || 'User',\r\n                                            image: user?.imageUrl\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\[id]\\posts\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1761,1764],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1761,1764],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'organisationPlatforms' is assigned a value but never used.","line":93,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":272,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9370,9373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9370,9373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":347,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":347,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12287,12290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12287,12290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":632,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30638,30641],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30638,30641],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { \r\n    ArrowLeft, \r\n    Loader2, \r\n    Plus, \r\n    Trash2, \r\n    Edit, \r\n    Calendar, \r\n    Send, \r\n    Mail, \r\n    MessageSquare, \r\n    Phone,\r\n    Copy,\r\n    Filter,\r\n    Facebook,\r\n    Instagram,\r\n    Linkedin,\r\n    Youtube,\r\n    Eye,\r\n    Share2,\r\n    Check,\r\n    Paperclip\r\n} from 'lucide-react';\r\nimport { useRouter, useParams } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\n\r\ninterface Post {\r\n    id: number;\r\n    subject: string | null;\r\n    message: string | null;\r\n    type: string;\r\n    scheduledPostTime: string | null;\r\n    isPostSent: boolean;\r\n    createdAt: string;\r\n    senderEmail: string | null;\r\n    videoUrl: string | null;\r\n}\r\n\r\ninterface Campaign {\r\n    id: number;\r\n    name: string;\r\n    description: string | null;\r\n    contacts?: any[];\r\n}\r\n\r\nexport default function CampaignPostsPage() {\r\n    const router = useRouter();\r\n    const params = useParams();\r\n    const campaignId = params.id as string;\r\n\r\n    // State\r\n    const [campaign, setCampaign] = useState<Campaign | null>(null);\r\n    const [posts, setPosts] = useState<Post[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n    const [deletePostId, setDeletePostId] = useState<number | null>(null);\r\n    const [filterPlatform, setFilterPlatform] = useState<string>('all');\r\n    const [filterStatus, setFilterStatus] = useState<string>('all');\r\n    const [organisationPlatforms, setOrganisationPlatforms] = useState<string[]>([]);\r\n    \r\n    // Preview & Share State\r\n    const [previewPost, setPreviewPost] = useState<Post | null>(null);\r\n    const [sharePost, setSharePost] = useState<Post | null>(null);\r\n    const [selectedContacts, setSelectedContacts] = useState<string[]>([]);\r\n    const [sendingShare, setSendingShare] = useState(false);\r\n\r\n    // Fetch organisation platforms\r\n    useEffect(() => {\r\n        const fetchOrgPlatforms = async () => {\r\n            try {\r\n                const response = await fetch('/api/Organisation/GetPlatforms');\r\n                if (!response.ok) return;\r\n                const data = await response.json();\r\n                setOrganisationPlatforms(data.platforms || []);\r\n            } catch (error) {\r\n                console.error('Error fetching organisation platforms:', error);\r\n            }\r\n        };\r\n\r\n        fetchOrgPlatforms();\r\n    }, []);\r\n\r\n    // Fetch campaign and posts\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                setLoading(true);\r\n\r\n                // Fetch campaign\r\n                const campaignResponse = await fetch(`/api/campaigns/${campaignId}`);\r\n                if (!campaignResponse.ok) throw new Error('Failed to fetch campaign');\r\n                const campaignData = await campaignResponse.json();\r\n                setCampaign(campaignData.campaign);\r\n\r\n                // Fetch posts\r\n                const postsResponse = await fetch(`/api/campaigns/${campaignId}/posts`);\r\n                if (!postsResponse.ok) throw new Error('Failed to fetch posts');\r\n                const postsData = await postsResponse.json();\r\n                setPosts(postsData.posts);\r\n            } catch (error) {\r\n                console.error('Error fetching data:', error);\r\n                toast.error('Failed to load campaign posts');\r\n                router.push('/organisation/campaigns');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, [campaignId, router]);\r\n\r\n    // Filter posts\r\n    const filteredPosts = posts.filter((post) => {\r\n        const platformMatch = filterPlatform === 'all' || post.type === filterPlatform;\r\n        const statusMatch = filterStatus === 'all' || \r\n            (filterStatus === 'sent' && post.isPostSent) ||\r\n            (filterStatus === 'pending' && !post.isPostSent) ||\r\n            (filterStatus === 'scheduled' && post.scheduledPostTime && !post.isPostSent);\r\n        return platformMatch && statusMatch;\r\n    });\r\n\r\n    // Group posts by platform\r\n    const groupedPosts = filteredPosts.reduce((acc, post) => {\r\n        if (!acc[post.type]) {\r\n            acc[post.type] = [];\r\n        }\r\n        acc[post.type].push(post);\r\n        return acc;\r\n    }, {} as Record<string, Post[]>);\r\n\r\n    // Handle delete post\r\n    const handleDeletePost = async (postId: number) => {\r\n        try {\r\n            const response = await fetch(`/api/campaigns/${campaignId}/posts/${postId}`, {\r\n                method: 'DELETE',\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to delete post');\r\n\r\n            toast.success('Post deleted successfully');\r\n            setPosts(posts.filter((p) => p.id !== postId));\r\n            setShowDeleteDialog(false);\r\n            setDeletePostId(null);\r\n        } catch (error) {\r\n            console.error('Error deleting post:', error);\r\n            toast.error('Failed to delete post');\r\n        }\r\n    };\r\n\r\n    // Handle duplicate post\r\n    const handleDuplicatePost = async (post: Post) => {\r\n        try {\r\n            const response = await fetch(`/api/campaigns/${campaignId}/posts`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    subject: post.subject ? `${post.subject} (Copy)` : null,\r\n                    message: post.message,\r\n                    type: post.type,\r\n                    senderEmail: null,\r\n                    scheduledPostTime: null,\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to duplicate post');\r\n\r\n            const data = await response.json();\r\n            setPosts([...posts, data.post]);\r\n            toast.success('Post duplicated successfully');\r\n        } catch (error) {\r\n            console.error('Error duplicating post:', error);\r\n            toast.error('Failed to duplicate post');\r\n        }\r\n    };\r\n\r\n    // Handle Share/Send\r\n    const handleSendShare = async () => {\r\n        const isSocialPlatform = ['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST'].includes(sharePost?.type || '');\r\n        \r\n        if (!isSocialPlatform && selectedContacts.length === 0) {\r\n            toast.error('Please select at least one contact');\r\n            return;\r\n        }\r\n\r\n        if (!sharePost) return;\r\n\r\n        try {\r\n            setSendingShare(true);\r\n            \r\n            const response = await fetch(`/api/campaigns/${campaignId}/posts/${sharePost.id}/send`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ contactIds: selectedContacts })\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json().catch(() => ({}));\r\n                throw new Error(errorData.error || 'Failed to send post');\r\n            }\r\n\r\n            const data = await response.json();\r\n            \r\n            toast.success(isSocialPlatform ? 'Post published successfully!' : `Post shared successfully! Sent: ${data.sent}, Failed: ${data.failed}`);\r\n            setSharePost(null);\r\n            setSelectedContacts([]);\r\n            \r\n            // Refresh posts to update status\r\n            const postsResponse = await fetch(`/api/campaigns/${campaignId}/posts`);\r\n            if (postsResponse.ok) {\r\n                const postsData = await postsResponse.json();\r\n                setPosts(postsData.posts);\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error('Error sharing post:', error);\r\n            toast.error(error instanceof Error ? error.message : 'Failed to share post');\r\n        } finally {\r\n            setSendingShare(false);\r\n        }\r\n    };\r\n\r\n    // Toggle contact selection\r\n    const toggleContact = (contactId: string) => {\r\n        setSelectedContacts(prev => \r\n            prev.includes(contactId) \r\n                ? prev.filter(id => id !== contactId)\r\n                : [...prev, contactId]\r\n        );\r\n    };\r\n\r\n    // Select all contacts\r\n    const toggleAllContacts = () => {\r\n        if (!campaign?.contacts) return;\r\n        \r\n        if (selectedContacts.length === campaign.contacts.length) {\r\n            setSelectedContacts([]);\r\n        } else {\r\n            setSelectedContacts(campaign.contacts.map((c: any) => c.id));\r\n        }\r\n    };\r\n\r\n    // Format date\r\n    const formatDate = (dateString: string) => {\r\n        return new Date(dateString).toLocaleString('en-US', {\r\n            year: 'numeric',\r\n            month: 'short',\r\n            day: 'numeric',\r\n            hour: '2-digit',\r\n            minute: '2-digit',\r\n        });\r\n    };\r\n\r\n    // Get platform icon\r\n    const getPlatformIcon = (type: string) => {\r\n        switch (type.toUpperCase()) {\r\n            case 'EMAIL':\r\n                return <Mail className=\"size-4\" />;\r\n            case 'SMS':\r\n                return <MessageSquare className=\"size-4\" />;\r\n            case 'WHATSAPP':\r\n                return <Phone className=\"size-4\" />;\r\n            case 'FACEBOOK':\r\n                return <Facebook className=\"size-4\" />;\r\n            case 'INSTAGRAM':\r\n                return <Instagram className=\"size-4\" />;\r\n            case 'LINKEDIN':\r\n                return <Linkedin className=\"size-4\" />;\r\n            case 'YOUTUBE':\r\n                return <Youtube className=\"size-4\" />;\r\n            case 'PINTEREST':\r\n                return (\r\n                    <div className=\"p-0.5 bg-red-600 rounded-full size-4 flex items-center justify-center\">\r\n                        <span className=\"text-white text-[10px] font-bold\">P</span>\r\n                    </div>\r\n                );\r\n            default:\r\n                return <Send className=\"size-4\" />;\r\n        }\r\n    };\r\n\r\n    // Get status badge\r\n    const getStatusBadge = (post: Post) => {\r\n        if (post.isPostSent) {\r\n            return <Badge variant=\"default\">Sent</Badge>;\r\n        }\r\n        if (post.scheduledPostTime && new Date(post.scheduledPostTime) > new Date()) {\r\n            return <Badge variant=\"secondary\">Scheduled</Badge>;\r\n        }\r\n        return <Badge variant=\"outline\">Pending</Badge>;\r\n    };\r\n\r\n    // Get preview content with variables replaced\r\n    const getPreviewContent = (content: string | null) => {\r\n        if (!content) return '';\r\n        \r\n        // Use first contact from campaign for preview, or fallback to placeholder\r\n        const sampleContact = campaign?.contacts && campaign.contacts.length > 0 ? campaign.contacts[0] : null;\r\n        \r\n        return content\r\n            .replace(/{{name}}/g, sampleContact?.contactName || 'John Doe')\r\n            .replace(/{{email}}/g, sampleContact?.contactEmail || 'john@example.com')\r\n            .replace(/{{phone}}/g, sampleContact?.contactMobile || '+1234567890')\r\n            .replace(/{{company}}/g, 'Acme Corp');\r\n    };\r\n\r\n    // Get share preview content\r\n    const getSharePreviewContent = (content: string | null) => {\r\n        if (!content) return '';\r\n        \r\n        // If exactly one contact is selected, use their data\r\n        if (selectedContacts.length === 1) {\r\n            const contactId = selectedContacts[0];\r\n            const contact = campaign?.contacts?.find((c: any) => c.id === contactId);\r\n            \r\n            if (contact) {\r\n                return content\r\n                    .replace(/{{name}}/g, contact.contactName || '{{name}}')\r\n                    .replace(/{{email}}/g, contact.contactEmail || '{{email}}')\r\n                    .replace(/{{phone}}/g, contact.contactMobile || '{{phone}}')\r\n                    .replace(/{{company}}/g, 'Acme Corp');\r\n            }\r\n        }\r\n        \r\n        // Otherwise return raw content or generic preview\r\n        return content;\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-background\">\r\n                <Header />\r\n                <div className=\"flex\">\r\n                    <Sidebar />\r\n                    <main className=\"flex-1 p-6\">\r\n                        <div className=\"flex items-center justify-center h-[calc(100vh-8rem)]\">\r\n                            <Loader2 className=\"size-8 animate-spin text-muted-foreground\" />\r\n                        </div>\r\n                    </main>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const isSocialPlatform = sharePost ? ['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE', 'PINTEREST'].includes(sharePost.type) : false;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-7xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => router.push('/organisation/campaigns')}\r\n                            >\r\n                                <ArrowLeft className=\"size-4 mr-2\" />\r\n                                Back to Campaigns\r\n                            </Button>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">{campaign?.name}</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    {campaign?.description || 'Manage posts for this campaign'}\r\n                                </p>\r\n                            </div>\r\n                            <Button onClick={() => router.push(`/organisation/campaigns/${campaignId}/posts/new`)}>\r\n                                <Plus className=\"size-4 mr-2\" />\r\n                                Add Post\r\n                            </Button>\r\n                        </div>\r\n\r\n                        {/* Filters */}\r\n                        <Card>\r\n                            <CardContent className=\"pt-6\">\r\n                                <div className=\"flex flex-col md:flex-row gap-4\">\r\n                                    <div className=\"flex items-center gap-2 flex-1\">\r\n                                        <Filter className=\"size-4 text-muted-foreground\" />\r\n                                        <Select value={filterPlatform} onValueChange={setFilterPlatform}>\r\n                                            <SelectTrigger className=\"w-[200px]\">\r\n                                                <SelectValue placeholder=\"Filter by platform\" />\r\n                                            </SelectTrigger>\r\n                                            <SelectContent>\r\n                                                <SelectItem value=\"all\">All Platforms</SelectItem>\r\n                                                <SelectItem value=\"EMAIL\">Email</SelectItem>\r\n                                                <SelectItem value=\"SMS\">SMS</SelectItem>\r\n                                                <SelectItem value=\"WHATSAPP\">WhatsApp</SelectItem>\r\n                                                <SelectItem value=\"FACEBOOK\">Facebook</SelectItem>\r\n                                                <SelectItem value=\"INSTAGRAM\">Instagram</SelectItem>\r\n                                                <SelectItem value=\"LINKEDIN\">LinkedIn</SelectItem>\r\n                                                <SelectItem value=\"YOUTUBE\">YouTube</SelectItem>\r\n                                            </SelectContent>\r\n                                        </Select>\r\n                                    </div>\r\n\r\n                                    <Select value={filterStatus} onValueChange={setFilterStatus}>\r\n                                        <SelectTrigger className=\"w-[200px]\">\r\n                                            <SelectValue placeholder=\"Filter by status\" />\r\n                                        </SelectTrigger>\r\n                                        <SelectContent>\r\n                                            <SelectItem value=\"all\">All Status</SelectItem>\r\n                                            <SelectItem value=\"scheduled\">Scheduled</SelectItem>\r\n                                            <SelectItem value=\"sent\">Sent</SelectItem>\r\n                                            <SelectItem value=\"pending\">Pending</SelectItem>\r\n                                        </SelectContent>\r\n                                    </Select>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Posts Grouped by Platform */}\r\n                        {filteredPosts.length === 0 ? (\r\n                            <Card>\r\n                                <CardContent className=\"text-center py-12\">\r\n                                    <Send className=\"size-12 mx-auto text-muted-foreground mb-4\" />\r\n                                    <p className=\"text-muted-foreground mb-4\">\r\n                                        {posts.length === 0 ? 'No posts yet' : 'No posts match your filters'}\r\n                                    </p>\r\n                                    <Button onClick={() => router.push(`/organisation/campaigns/${campaignId}/posts/new`)}>\r\n                                        <Plus className=\"size-4 mr-2\" />\r\n                                        Add Your First Post\r\n                                    </Button>\r\n                                </CardContent>\r\n                            </Card>\r\n                        ) : (\r\n                            Object.entries(groupedPosts).map(([platform, platformPosts]) => (\r\n                                <Card key={platform}>\r\n                                    <CardHeader>\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            {getPlatformIcon(platform)}\r\n                                            <div>\r\n                                                <CardTitle>{platform}</CardTitle>\r\n                                                <CardDescription>\r\n                                                    {platformPosts.length} {platformPosts.length === 1 ? 'post' : 'posts'}\r\n                                                </CardDescription>\r\n                                            </div>\r\n                                        </div>\r\n                                    </CardHeader>\r\n                                    <CardContent>\r\n                                        <div className=\"space-y-4\">\r\n                                            {platformPosts.map((post) => (\r\n                                                <div\r\n                                                    key={post.id}\r\n                                                    className=\"flex items-start justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors\"\r\n                                                >\r\n                                                    <div className=\"flex-1 space-y-2\">\r\n                                                        {post.subject && (\r\n                                                            <h4 className=\"font-medium\">{post.subject}</h4>\r\n                                                        )}\r\n                                                        {post.message && (\r\n                                                            <p className=\"text-sm text-muted-foreground line-clamp-2\">\r\n                                                                {post.message}\r\n                                                            </p>\r\n                                                        )}\r\n                                                        {post.type === 'EMAIL' && post.senderEmail && (\r\n                                                            <p className=\"text-xs text-muted-foreground\">\r\n                                                                From: {post.senderEmail}\r\n                                                            </p>\r\n                                                        )}\r\n                                                        {post.videoUrl && (\r\n                                                            <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\r\n                                                                <Paperclip className=\"size-3\" />\r\n                                                                <span>Media attached</span>\r\n                                                            </div>\r\n                                                        )}\r\n                                                        <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n                                                            {post.scheduledPostTime && (\r\n                                                                <div className=\"flex items-center gap-1\">\r\n                                                                    <Calendar className=\"size-3\" />\r\n                                                                    <span>{formatDate(post.scheduledPostTime)}</span>\r\n                                                                </div>\r\n                                                            )}\r\n                                                            <div>{getStatusBadge(post)}</div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"flex items-center gap-2 ml-4\">\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"ghost\"\r\n                                                            onClick={() => setPreviewPost(post)}\r\n                                                            title=\"Preview\"\r\n                                                        >\r\n                                                            <Eye className=\"size-4\" />\r\n                                                        </Button>\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"ghost\"\r\n                                                            onClick={() => {\r\n                                                                setSharePost(post);\r\n                                                                setSelectedContacts([]);\r\n                                                            }}\r\n                                                            title={isSocialPlatform ? \"Publish Now\" : \"Share to Contacts\"}\r\n                                                        >\r\n                                                            {isSocialPlatform ? <Send className=\"size-4\" /> : <Share2 className=\"size-4\" />}\r\n                                                        </Button>\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"ghost\"\r\n                                                            onClick={() => handleDuplicatePost(post)}\r\n                                                            title=\"Duplicate\"\r\n                                                        >\r\n                                                            <Copy className=\"size-4\" />\r\n                                                        </Button>\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"ghost\"\r\n                                                            onClick={() => router.push(`/organisation/campaigns/${campaignId}/posts/${post.id}/edit`)}\r\n                                                            disabled={post.isPostSent}\r\n                                                            title=\"Edit\"\r\n                                                        >\r\n                                                            <Edit className=\"size-4\" />\r\n                                                        </Button>\r\n                                                        <Button\r\n                                                            size=\"sm\"\r\n                                                            variant=\"ghost\"\r\n                                                            onClick={() => {\r\n                                                                setDeletePostId(post.id);\r\n                                                                setShowDeleteDialog(true);\r\n                                                            }}\r\n                                                            disabled={post.isPostSent}\r\n                                                            title=\"Delete\"\r\n                                                        >\r\n                                                            <Trash2 className=\"size-4 text-destructive\" />\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </CardContent>\r\n                                </Card>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </main>\r\n            </div>\r\n\r\n            {/* Preview Dialog */}\r\n            <Dialog open={!!previewPost} onOpenChange={(open) => !open && setPreviewPost(null)}>\r\n                <DialogContent className=\"max-w-2xl\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>Post Preview</DialogTitle>\r\n                        <DialogDescription>\r\n                            Preview how your post will look\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    {previewPost && (\r\n                        <div className=\"space-y-4\">\r\n                            {previewPost.subject && (\r\n                                <div>\r\n                                    <p className=\"text-sm font-medium mb-1\">Subject:</p>\r\n                                    <p className=\"text-sm text-muted-foreground\">{previewPost.subject}</p>\r\n                                </div>\r\n                            )}\r\n                            <div>\r\n                                <p className=\"text-sm font-medium mb-1\">Message:</p>\r\n                                <div className=\"p-4 border rounded-lg bg-muted/50 whitespace-pre-wrap\">\r\n                                    {getPreviewContent(previewPost.message)}\r\n                                </div>\r\n                            </div>\r\n                            {!['FACEBOOK', 'INSTAGRAM', 'LINKEDIN', 'YOUTUBE'].includes(previewPost.type) && (\r\n                                <div className=\"text-xs text-muted-foreground italic\">\r\n                                    * Variables like {'{{name}}'} are replaced with sample data from your campaign contacts.\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </DialogContent>\r\n            </Dialog>\r\n\r\n            {/* Share/Send Dialog */}\r\n            <Dialog open={!!sharePost} onOpenChange={(open) => !open && setSharePost(null)}>\r\n                <DialogContent className=\"max-w-3xl\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>{isSocialPlatform ? 'Publish Post' : 'Share Post'}</DialogTitle>\r\n                        <DialogDescription>\r\n                            {isSocialPlatform \r\n                                ? `Publish this post to your ${sharePost?.type} page`\r\n                                : 'Select contacts to share this post with'\r\n                            }\r\n                        </DialogDescription>\r\n                    </DialogHeader>\r\n                    <div className=\"space-y-4\">\r\n                        {!isSocialPlatform && (\r\n                            <>\r\n                                <div className=\"flex items-center justify-between\">\r\n                                    <h4 className=\"text-sm font-medium\">Select Contacts</h4>\r\n                                    <Button variant=\"outline\" size=\"sm\" onClick={toggleAllContacts}>\r\n                                        {selectedContacts.length === (campaign?.contacts?.length || 0) ? 'Deselect All' : 'Select All'}\r\n                                    </Button>\r\n                                </div>\r\n                                <div className=\"border rounded-lg max-h-[200px] overflow-y-auto p-2 space-y-1\">\r\n                                    {campaign?.contacts && campaign.contacts.length > 0 ? (\r\n                                        campaign.contacts.map((contact: any) => (\r\n                                            <div\r\n                                                key={contact.id}\r\n                                                className=\"flex items-center gap-3 p-2 hover:bg-muted/50 rounded cursor-pointer\"\r\n                                                onClick={() => toggleContact(contact.id)}\r\n                                            >\r\n                                                <div className={`size-4 rounded border flex items-center justify-center ${selectedContacts.includes(contact.id) ? 'bg-primary border-primary text-primary-foreground' : 'border-muted-foreground'}`}>\r\n                                                    {selectedContacts.includes(contact.id) && <Check className=\"size-3\" />}\r\n                                                </div>\r\n                                                <div className=\"flex-1\">\r\n                                                    <p className=\"text-sm font-medium\">{contact.contactName}</p>\r\n                                                    <p className=\"text-xs text-muted-foreground\">{contact.contactEmail || contact.contactMobile}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))\r\n                                    ) : (\r\n                                        <div className=\"p-4 text-center text-muted-foreground text-sm\">\r\n                                            No contacts found in this campaign.\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"text-xs text-muted-foreground\">\r\n                                    Selected: {selectedContacts.length} contacts\r\n                                </div>\r\n                            </>\r\n                        )}\r\n\r\n                        {/* Dynamic Message Preview */}\r\n                        {sharePost && (\r\n                            <div className=\"mt-4 p-4 border rounded-lg bg-muted/30\">\r\n                                <h5 className=\"text-xs font-medium mb-2 text-muted-foreground uppercase tracking-wider\">\r\n                                    {isSocialPlatform ? 'Content Preview' : `Message Preview ${selectedContacts.length === 1 ? '(Personalized)' : ''}`}\r\n                                </h5>\r\n                                {sharePost.subject && (\r\n                                    <p className=\"font-medium mb-1\">{sharePost.subject}</p>\r\n                                )}\r\n                                <p className=\"text-sm whitespace-pre-wrap\">\r\n                                    {isSocialPlatform ? sharePost.message : getSharePreviewContent(sharePost.message)}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    <DialogFooter>\r\n                        <Button variant=\"outline\" onClick={() => setSharePost(null)}>Cancel</Button>\r\n                        <Button onClick={handleSendShare} disabled={sendingShare || (!isSocialPlatform && selectedContacts.length === 0)}>\r\n                            {sendingShare ? (\r\n                                <>\r\n                                    <Loader2 className=\"size-4 mr-2 animate-spin\" />\r\n                                    {isSocialPlatform ? 'Publishing...' : 'Sending...'}\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <Send className=\"size-4 mr-2\" />\r\n                                    {isSocialPlatform ? 'Publish Now' : 'Send Now'}\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </DialogContent>\r\n            </Dialog>\r\n\r\n            {/* Delete Confirmation Dialog */}\r\n            <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n                <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            This will permanently delete this post. This action cannot be undone.\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => setDeletePostId(null)}>\r\n                            Cancel\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction\r\n                            onClick={() => {\r\n                                if (deletePostId) {\r\n                                    handleDeletePost(deletePostId);\r\n                                }\r\n                            }}\r\n                            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                        >\r\n                            Delete\r\n                        </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\campaigns\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Dialog' is defined but never used.","line":34,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogContent' is defined but never used.","line":35,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogDescription' is defined but never used.","line":36,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogHeader' is defined but never used.","line":37,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DialogTitle' is defined but never used.","line":38,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showCampaignModal' is assigned a value but never used.","line":83,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setShowCampaignModal' is assigned a value but never used.","line":83,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'editingCampaign' is assigned a value but never used.","line":84,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCampaigns'. Either include it or remove the dependency array.","line":113,"column":8,"nodeType":"ArrayExpression","endLine":113,"endColumn":48,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, fetchCampaigns, itemsPerPage, searchQuery]","fix":{"range":[3324,3364],"text":"[currentPage, fetchCampaigns, itemsPerPage, searchQuery]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isCampaignActive' is assigned a value but never used.","line":160,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":160,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n    AlertDialog,\r\n    AlertDialogAction,\r\n    AlertDialogCancel,\r\n    AlertDialogContent,\r\n    AlertDialogDescription,\r\n    AlertDialogFooter,\r\n    AlertDialogHeader,\r\n    AlertDialogTitle,\r\n} from '@/components/ui/alert-dialog';\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n    Search,\r\n    Trash2,\r\n    Edit,\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    Plus,\r\n    Loader2,\r\n    Calendar,\r\n    FileText,\r\n    Users,\r\n} from 'lucide-react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { toast } from 'sonner';\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\n\r\ninterface Campaign {\r\n    id: number;\r\n    name: string;\r\n    description: string | null;\r\n    startDate: string;\r\n    endDate: string;\r\n    createdAt: string;\r\n    _count: {\r\n        posts: number;\r\n        contacts: number;\r\n    };\r\n}\r\n\r\nexport default function CampaignsPage() {\r\n    const router = useRouter();\r\n\r\n    // State\r\n    const [campaigns, setCampaigns] = useState<Campaign[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [itemsPerPage, setItemsPerPage] = useState(10);\r\n    const [totalPages, setTotalPages] = useState(1);\r\n    const [totalCampaigns, setTotalCampaigns] = useState(0);\r\n    const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n    const [deleteCampaignId, setDeleteCampaignId] = useState<number | null>(null);\r\n    const [showCampaignModal, setShowCampaignModal] = useState(false);\r\n    const [editingCampaign, setEditingCampaign] = useState<Campaign | null>(null);\r\n\r\n    // Fetch campaigns\r\n    const fetchCampaigns = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const params = new URLSearchParams({\r\n                page: currentPage.toString(),\r\n                limit: itemsPerPage.toString(),\r\n                ...(searchQuery && { search: searchQuery }),\r\n            });\r\n\r\n            const response = await fetch(`/api/campaigns?${params}`);\r\n            if (!response.ok) throw new Error('Failed to fetch campaigns');\r\n\r\n            const data = await response.json();\r\n            setCampaigns(data.campaigns);\r\n            setTotalPages(data.pagination.totalPages);\r\n            setTotalCampaigns(data.pagination.total);\r\n        } catch (error) {\r\n            console.error('Error fetching campaigns:', error);\r\n            toast.error('Failed to fetch campaigns');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchCampaigns();\r\n    }, [currentPage, itemsPerPage, searchQuery]);\r\n\r\n    // Handle delete campaign\r\n    const handleDeleteCampaign = async (campaignId: number) => {\r\n        try {\r\n            const response = await fetch(`/api/campaigns/${campaignId}`, {\r\n                method: 'DELETE',\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to delete campaign');\r\n\r\n            toast.success('Campaign deleted successfully');\r\n            fetchCampaigns();\r\n            setShowDeleteDialog(false);\r\n            setDeleteCampaignId(null);\r\n        } catch (error) {\r\n            console.error('Error deleting campaign:', error);\r\n            toast.error('Failed to delete campaign');\r\n        }\r\n    };\r\n\r\n    // Handle add campaign\r\n    const handleAddCampaign = () => {\r\n        setEditingCampaign(null);\r\n        router.push('/organisation/campaigns/new');\r\n    };\r\n\r\n    // Handle edit campaign\r\n    const handleEditCampaign = (campaign: Campaign) => {\r\n        router.push(`/organisation/campaigns/${campaign.id}/edit`);\r\n    };\r\n\r\n    // Handle manage posts\r\n    const handleManagePosts = (campaign: Campaign) => {\r\n        router.push(`/organisation/campaigns/${campaign.id}/posts`);\r\n    };\r\n\r\n    // Format date\r\n    const formatDate = (dateString: string) => {\r\n        return new Date(dateString).toLocaleDateString('en-US', {\r\n            year: 'numeric',\r\n            month: 'short',\r\n            day: 'numeric',\r\n        });\r\n    };\r\n\r\n    // Check if campaign is active\r\n    const isCampaignActive = (campaign: Campaign) => {\r\n        const now = new Date();\r\n        const start = new Date(campaign.startDate);\r\n        const end = new Date(campaign.endDate);\r\n        return now >= start && now <= end;\r\n    };\r\n\r\n    // Get campaign status\r\n    const getCampaignStatus = (campaign: Campaign) => {\r\n        const now = new Date();\r\n        const start = new Date(campaign.startDate);\r\n        const end = new Date(campaign.endDate);\r\n\r\n        if (now < start) return { label: 'Scheduled', variant: 'secondary' as const };\r\n        if (now > end) return { label: 'Completed', variant: 'outline' as const };\r\n        return { label: 'Active', variant: 'default' as const };\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n                    <div className=\"max-w-7xl mx-auto space-y-6\">\r\n                        {/* Header */}\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <h1 className=\"text-3xl font-bold tracking-tight\">Campaigns</h1>\r\n                                <p className=\"text-muted-foreground mt-1\">\r\n                                    Manage your marketing campaigns and posts\r\n                                </p>\r\n                            </div>\r\n                            <Button onClick={handleAddCampaign}>\r\n                                <Plus className=\"size-4 mr-2\" />\r\n                                New Campaign\r\n                            </Button>\r\n                        </div>\r\n\r\n                        {/* Filters */}\r\n                        <Card>\r\n                            <CardContent className=\"pt-6\">\r\n                                <div className=\"flex flex-col md:flex-row gap-4\">\r\n                                    {/* Search */}\r\n                                    <div className=\"relative flex-1\">\r\n                                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground\" />\r\n                                        <Input\r\n                                            placeholder=\"Search campaigns...\"\r\n                                            value={searchQuery}\r\n                                            onChange={(e) => {\r\n                                                setSearchQuery(e.target.value);\r\n                                                setCurrentPage(1);\r\n                                            }}\r\n                                            className=\"pl-9\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        {/* Table */}\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <CardTitle>Campaign List</CardTitle>\r\n                                <CardDescription>\r\n                                    Showing {campaigns.length} of {totalCampaigns} campaigns\r\n                                </CardDescription>\r\n                            </CardHeader>\r\n                            <CardContent>\r\n                                {loading ? (\r\n                                    <div className=\"flex items-center justify-center py-12\">\r\n                                        <Loader2 className=\"size-8 animate-spin text-muted-foreground\" />\r\n                                    </div>\r\n                                ) : campaigns.length === 0 ? (\r\n                                    <div className=\"text-center py-12\">\r\n                                        <FileText className=\"size-12 mx-auto text-muted-foreground mb-4\" />\r\n                                        <p className=\"text-muted-foreground\">No campaigns found</p>\r\n                                        <Button onClick={handleAddCampaign} className=\"mt-4\">\r\n                                            <Plus className=\"size-4 mr-2\" />\r\n                                            Create Your First Campaign\r\n                                        </Button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <div className=\"rounded-md border\">\r\n                                            <Table>\r\n                                                <TableHeader>\r\n                                                    <TableRow>\r\n                                                        <TableHead>Campaign Name</TableHead>\r\n                                                        <TableHead>Status</TableHead>\r\n                                                        <TableHead>Duration</TableHead>\r\n                                                        <TableHead>Contacts</TableHead>\r\n                                                        <TableHead>Posts</TableHead>\r\n                                                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                                                    </TableRow>\r\n                                                </TableHeader>\r\n                                                <TableBody>\r\n                                                    {campaigns.map((campaign) => {\r\n                                                        const status = getCampaignStatus(campaign);\r\n                                                        return (\r\n                                                            <TableRow key={campaign.id}>\r\n                                                                <TableCell>\r\n                                                                    <div>\r\n                                                                        <p className=\"font-medium\">{campaign.name}</p>\r\n                                                                        {campaign.description && (\r\n                                                                            <p className=\"text-sm text-muted-foreground line-clamp-1\">\r\n                                                                                {campaign.description}\r\n                                                                            </p>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                </TableCell>\r\n                                                                <TableCell>\r\n                                                                    <Badge variant={status.variant}>\r\n                                                                        {status.label}\r\n                                                                    </Badge>\r\n                                                                </TableCell>\r\n                                                                <TableCell>\r\n                                                                    <div className=\"flex items-center gap-2 text-sm\">\r\n                                                                        <Calendar className=\"size-4 text-muted-foreground\" />\r\n                                                                        <span>\r\n                                                                            {formatDate(campaign.startDate)} - {formatDate(campaign.endDate)}\r\n                                                                        </span>\r\n                                                                    </div>\r\n                                                                </TableCell>\r\n                                                                <TableCell>\r\n                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                        <Users className=\"size-4 text-muted-foreground\" />\r\n                                                                        <span>{campaign._count.contacts}</span>\r\n                                                                    </div>\r\n                                                                </TableCell>\r\n                                                                <TableCell>\r\n                                                                    <div className=\"flex items-center gap-2\">\r\n                                                                        <FileText className=\"size-4 text-muted-foreground\" />\r\n                                                                        <span>{campaign._count.posts}</span>\r\n                                                                    </div>\r\n                                                                </TableCell>\r\n                                                                <TableCell className=\"text-right\">\r\n                                                                    <div className=\"flex items-center justify-end gap-2\">\r\n                                                                        <Button\r\n                                                                            size=\"sm\"\r\n                                                                            variant=\"outline\"\r\n                                                                            onClick={() => handleManagePosts(campaign)}\r\n                                                                        >\r\n                                                                            {campaign._count.posts === 0 ? 'Add Post' : 'Posts'}\r\n                                                                        </Button>\r\n                                                                        <Button\r\n                                                                            size=\"sm\"\r\n                                                                            variant=\"ghost\"\r\n                                                                            onClick={() => handleEditCampaign(campaign)}\r\n                                                                        >\r\n                                                                            <Edit className=\"size-4\" />\r\n                                                                        </Button>\r\n                                                                        <Button\r\n                                                                            size=\"sm\"\r\n                                                                            variant=\"ghost\"\r\n                                                                            onClick={() => {\r\n                                                                                setDeleteCampaignId(campaign.id);\r\n                                                                                setShowDeleteDialog(true);\r\n                                                                            }}\r\n                                                                        >\r\n                                                                            <Trash2 className=\"size-4 text-destructive\" />\r\n                                                                        </Button>\r\n                                                                    </div>\r\n                                                                </TableCell>\r\n                                                            </TableRow>\r\n                                                        );\r\n                                                    })}\r\n                                                </TableBody>\r\n                                            </Table>\r\n                                        </div>\r\n\r\n                                        {/* Pagination */}\r\n                                        <div className=\"flex items-center justify-between mt-4\">\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span className=\"text-sm text-muted-foreground\">Rows per page:</span>\r\n                                                <Select\r\n                                                    value={itemsPerPage.toString()}\r\n                                                    onValueChange={(value) => {\r\n                                                        setItemsPerPage(parseInt(value));\r\n                                                        setCurrentPage(1);\r\n                                                    }}\r\n                                                >\r\n                                                    <SelectTrigger className=\"w-[80px]\">\r\n                                                        <SelectValue />\r\n                                                    </SelectTrigger>\r\n                                                    <SelectContent>\r\n                                                        <SelectItem value=\"5\">5</SelectItem>\r\n                                                        <SelectItem value=\"10\">10</SelectItem>\r\n                                                        <SelectItem value=\"20\">20</SelectItem>\r\n                                                        <SelectItem value=\"50\">50</SelectItem>\r\n                                                    </SelectContent>\r\n                                                </Select>\r\n                                            </div>\r\n\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span className=\"text-sm text-muted-foreground\">\r\n                                                    Page {currentPage} of {totalPages}\r\n                                                </span>\r\n                                                <div className=\"flex gap-1\">\r\n                                                    <Button\r\n                                                        size=\"sm\"\r\n                                                        variant=\"outline\"\r\n                                                        onClick={() => setCurrentPage((p) => Math.max(1, p - 1))}\r\n                                                        disabled={currentPage === 1}\r\n                                                    >\r\n                                                        <ChevronLeft className=\"size-4\" />\r\n                                                    </Button>\r\n                                                    <Button\r\n                                                        size=\"sm\"\r\n                                                        variant=\"outline\"\r\n                                                        onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))}\r\n                                                        disabled={currentPage === totalPages}\r\n                                                    >\r\n                                                        <ChevronRight className=\"size-4\" />\r\n                                                    </Button>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </>\r\n                                )}\r\n                            </CardContent>\r\n                        </Card>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n\r\n            {/* Delete Confirmation Dialog */}\r\n            <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n                <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                        <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                            This will permanently delete this campaign and all associated posts. This action cannot be undone.\r\n                        </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => setDeleteCampaignId(null)}>\r\n                            Cancel\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction\r\n                            onClick={() => {\r\n                                if (deleteCampaignId) {\r\n                                    handleDeleteCampaign(deleteCampaignId);\r\n                                }\r\n                            }}\r\n                            className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                        >\r\n                            Delete\r\n                        </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                </AlertDialogContent>\r\n            </AlertDialog>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":48,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setOrgName' is assigned a value but never used.","line":49,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":29},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":97,"column":21,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[3281,3362],"text":"\r\n                Here&apos;s what's happening with your account today\r\n              "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[3281,3362],"text":"\r\n                Here&lsquo;s what's happening with your account today\r\n              "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[3281,3362],"text":"\r\n                Here&#39;s what's happening with your account today\r\n              "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[3281,3362],"text":"\r\n                Here&rsquo;s what's happening with your account today\r\n              "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":97,"column":28,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[3281,3362],"text":"\r\n                Here's what&apos;s happening with your account today\r\n              "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[3281,3362],"text":"\r\n                Here's what&lsquo;s happening with your account today\r\n              "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[3281,3362],"text":"\r\n                Here's what&#39;s happening with your account today\r\n              "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[3281,3362],"text":"\r\n                Here's what&rsquo;s happening with your account today\r\n              "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport {\r\n  Users,\r\n  CreditCard,\r\n  BarChart3,\r\n  Zap,\r\n} from \"lucide-react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\r\nimport { Sidebar } from \"@/components/Sidebar\";\r\nimport { Header } from \"@/components/Header\";\r\n\r\n// Mock organisation data\r\nconst mockOrganisation = {\r\n  name: \"Acme Corp\",\r\n  email: \"admin@acme.com\",\r\n  plan: \"Professional\",\r\n  status: \"active\",\r\n  trialEndsAt: null,\r\n  storageUsed: 45,\r\n  storageLimit: 100,\r\n  usersCount: 12,\r\n  usersLimit: 50,\r\n  nextBillingDate: \"2025-01-15\",\r\n  nextBillingAmount: 2999,\r\n};\r\n\r\nconst mockTeamMembers = [\r\n  { id: 1, name: \"John Doe\", email: \"john@acme.com\", role: \"Admin\", status: \"active\" },\r\n  { id: 2, name: \"Jane Smith\", email: \"jane@acme.com\", role: \"Member\", status: \"active\" },\r\n  { id: 3, name: \"Bob Johnson\", email: \"bob@acme.com\", role: \"Member\", status: \"active\" },\r\n];\r\n\r\nconst mockRecentActivity = [\r\n  { id: 1, action: \"Document uploaded\", user: \"John Doe\", timestamp: \"2 hours ago\" },\r\n  { id: 2, action: \"Team member invited\", user: \"Jane Smith\", timestamp: \"5 hours ago\" },\r\n  { id: 3, action: \"Settings updated\", user: \"John Doe\", timestamp: \"1 day ago\" },\r\n];\r\n\r\nexport default function OrganisationDashboard() {\r\n  const router = useRouter();\r\n  const [orgName, setOrgName] = useState(mockOrganisation.name);\r\n\r\n  useEffect(() => {\r\n    // Sync user on mount\r\n    fetch(\"/api/user/sync\")\r\n      .then((res) => res.json())\r\n      .then((data) => console.log(\"User sync status:\", data))\r\n      .catch((err) => console.error(\"User sync error:\", err));\r\n\r\n    // Fetch tenant data\r\n    fetch(\"/api/tenant\")\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(\"=== TENANT DATA ===\");\r\n        console.log(\"Full Response:\", data);\r\n        if (data.tenant) {\r\n          console.log(\"Organization Name:\", data.tenant.name);\r\n          console.log(\"Plan:\", data.tenant.plan);\r\n          console.log(\"Status:\", data.tenant.status);\r\n          console.log(\"Enquiry:\", data.tenant.enquiry);\r\n          console.log(\"Created At:\", data.tenant.createdAt);\r\n          console.log(\"==================\");\r\n        }\r\n      })\r\n      .catch((err) => console.error(\"Error fetching tenant:\", err));\r\n  }, []);\r\n\r\n  const handleInviteMember = () => {\r\n    alert(\"Invite member functionality would open a modal here\");\r\n  };\r\n\r\n  const handleManageBilling = () => {\r\n    alert(\"Manage billing functionality would be implemented here\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n\r\n<Header />\r\n      <div className=\"flex\">\r\n        <Sidebar />\r\n\r\n        <main className=\"flex-1 p-6\">\r\n          <div className=\"max-w-6xl mx-auto space-y-6\">\r\n            {/* Welcome Section */}\r\n            <div>\r\n              <h1>Welcome back, {orgName}</h1>\r\n              <p className=\"text-muted-foreground\">\r\n                Here's what's happening with your account today\r\n              </p>\r\n            </div>\r\n\r\n            {/* Plan Status Banner */}\r\n            <Card className=\"bg-primary text-primary-foreground\">\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                      <h3 className=\"text-primary-foreground\">{mockOrganisation.plan} Plan</h3>\r\n                      <Badge variant=\"secondary\">Active</Badge>\r\n                    </div>\r\n                    <p className=\"text-primary-foreground/80\">\r\n                      Next billing: {mockOrganisation.nextBillingDate}  {mockOrganisation.nextBillingAmount}\r\n                    </p>\r\n                  </div>\r\n                  <Button variant=\"secondary\" onClick={handleManageBilling}>\r\n                    <CreditCard className=\"size-4 mr-2\" />\r\n                    Manage Billing\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid gap-4 md:grid-cols-3\">\r\n              <Card>\r\n                <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                  <CardTitle className=\"text-sm\">Team Members</CardTitle>\r\n                  <Users className=\"size-4 text-muted-foreground\" />\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl\">{mockOrganisation.usersCount}</div>\r\n                  <Progress value={(mockOrganisation.usersCount / mockOrganisation.usersLimit) * 100} className=\"mt-2\" />\r\n                  <p className=\"text-xs text-muted-foreground mt-2\">\r\n                    {mockOrganisation.usersCount} of {mockOrganisation.usersLimit} users\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                  <CardTitle className=\"text-sm\">Storage Used</CardTitle>\r\n                  <BarChart3 className=\"size-4 text-muted-foreground\" />\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl\">{mockOrganisation.storageUsed}GB</div>\r\n                  <Progress value={mockOrganisation.storageUsed} className=\"mt-2\" />\r\n                  <p className=\"text-xs text-muted-foreground mt-2\">\r\n                    {mockOrganisation.storageUsed} of {mockOrganisation.storageLimit}GB used\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                <CardTitle className=\"text-sm\">API Calls</CardTitle>\r\n                <Zap className=\"size-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl\">12,450</div>\r\n                <Progress value={62} className=\"mt-2\" />\r\n                <p className=\"text-xs text-muted-foreground mt-2\">\r\n                  62% of monthly limit\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Tabs Content */}\r\n          <Tabs defaultValue=\"activity\" className=\"space-y-4\">\r\n            <TabsList>\r\n              <TabsTrigger value=\"activity\">Recent Activity</TabsTrigger>\r\n              <TabsTrigger value=\"team\">Team Members</TabsTrigger>\r\n              <TabsTrigger value=\"usage\">Usage Details</TabsTrigger>\r\n            </TabsList>\r\n\r\n            <TabsContent value=\"activity\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Recent Activity</CardTitle>\r\n                  <CardDescription>\r\n                    Latest actions in your workspace\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {mockRecentActivity.map((activity) => (\r\n                      <div key={activity.id} className=\"flex items-center justify-between py-3 border-b last:border-0\">\r\n                        <div>\r\n                          <p>{activity.action}</p>\r\n                          <p className=\"text-sm text-muted-foreground\">{activity.user}</p>\r\n                        </div>\r\n                        <span className=\"text-sm text-muted-foreground\">{activity.timestamp}</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"team\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <CardTitle>Team Members</CardTitle>\r\n                      <CardDescription>\r\n                        Manage your team members and their roles\r\n                      </CardDescription>\r\n                    </div>\r\n                    <Button onClick={handleInviteMember}>\r\n                      <Users className=\"size-4 mr-2\" />\r\n                      Invite Member\r\n                    </Button>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {mockTeamMembers.map((member) => (\r\n                      <div key={member.id} className=\"flex items-center justify-between py-3 border-b last:border-0\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <Avatar>\r\n                            <AvatarFallback>{member.name.split(\" \").map((n) => n[0]).join(\"\")}</AvatarFallback>\r\n                          </Avatar>\r\n                          <div>\r\n                            <p>{member.name}</p>\r\n                            <p className=\"text-sm text-muted-foreground\">{member.email}</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant=\"secondary\">{member.role}</Badge>\r\n                          <Button variant=\"ghost\" size=\"sm\">Edit</Button>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n\r\n              <TabsContent value=\"usage\" className=\"space-y-4\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>Usage Details</CardTitle>\r\n                    <CardDescription>\r\n                      Detailed breakdown of your usage and limits\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-6\">\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>Storage</span>\r\n                          <span className=\"text-muted-foreground\">{mockOrganisation.storageUsed}/{mockOrganisation.storageLimit}GB</span>\r\n                        </div>\r\n                        <Progress value={mockOrganisation.storageUsed} />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>Team Members</span>\r\n                          <span className=\"text-muted-foreground\">{mockOrganisation.usersCount}/{mockOrganisation.usersLimit}</span>\r\n                        </div>\r\n                        <Progress value={(mockOrganisation.usersCount / mockOrganisation.usersLimit) * 100} />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>API Calls</span>\r\n                          <span className=\"text-muted-foreground\">12,450/20,000</span>\r\n                        </div>\r\n                        <Progress value={62} />\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\settings\\_components\\settings-client.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":9,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":9,"column":81,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":88},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":9,"column":123,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":131},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":11,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Avatar' is defined but never used.","line":15,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AvatarFallback' is defined but never used.","line":15,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AvatarImage' is defined but never used.","line":15,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":45},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Separator' is defined but never used.","line":16,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isUpdating' is assigned a value but never used.","line":56,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isUploading' is assigned a value but never used.","line":57,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showLinkedInDialog' is assigned a value but never used.","line":58,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'linkedInPages' is assigned a value but never used.","line":60,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2395,2398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2395,2398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loadingPages' is assigned a value but never used.","line":61,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'form' is assigned a value but never used.","line":63,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onSubmit' is assigned a value but never used.","line":72,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleImageUpload' is assigned a value but never used.","line":101,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleConfigureLinkedIn' is assigned a value but never used.","line":179,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSelectPage' is assigned a value but never used.","line":196,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":196,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":217,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6857,6860],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6857,6860],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":433,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":433,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15731,15734],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15731,15734],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":433,"column":96,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":433,"endColumn":99,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15780,15783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15780,15783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":434,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":434,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15873,15876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15873,15876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":536,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":536,"endColumn":31}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useUser } from \"@clerk/nextjs\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { toast } from \"sonner\";\r\nimport { Loader2, Upload, Facebook, Instagram, Linkedin, Youtube, CheckCircle2, XCircle, Mail, Smartphone, MessageSquare, Settings } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { \r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from '@/components/ui/dialog';\r\n\r\n// Schema for profile form\r\nconst profileSchema = z.object({\r\n  firstName: z.string().min(2, \"First name must be at least 2 characters\"),\r\n  lastName: z.string().min(2, \"Last name must be at least 2 characters\"),\r\n  mobile: z.string().min(10, \"Mobile number must be at least 10 characters\").optional().or(z.literal(\"\")),\r\n});\r\n\r\ntype ProfileFormValues = z.infer<typeof profileSchema>;\r\n\r\ninterface SettingsClientProps {\r\n  userData: {\r\n    firstName: string | null;\r\n    lastName: string | null;\r\n    mobile: string | null;\r\n    email: string;\r\n    facebookConnected: boolean;\r\n    instagramConnected: boolean;\r\n    linkedInConnected: boolean;\r\n    linkedInAuthUrn: string | null;\r\n    youtubeConnected: boolean;\r\n    pinterestConnected: boolean;\r\n    emailConnected: boolean;\r\n    smsConnected: boolean;\r\n    whatsappConnected: boolean;\r\n  };\r\n  assignedPlatforms: string[];\r\n}\r\n\r\nexport function SettingsClient({ userData, assignedPlatforms }: SettingsClientProps) {\r\n  const { user, isLoaded } = useUser();\r\n  const [isUpdating, setIsUpdating] = useState(false);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [showLinkedInDialog, setShowLinkedInDialog] = useState(false);\r\n  const [showInstagramDialog, setShowInstagramDialog] = useState(false);\r\n  const [linkedInPages, setLinkedInPages] = useState<any[]>([]);\r\n  const [loadingPages, setLoadingPages] = useState(false);\r\n\r\n  const form = useForm<ProfileFormValues>({\r\n    resolver: zodResolver(profileSchema),\r\n    defaultValues: {\r\n      firstName: userData.firstName || \"\",\r\n      lastName: userData.lastName || \"\",\r\n      mobile: userData.mobile || \"\",\r\n    },\r\n  });\r\n\r\n  const onSubmit = async (data: ProfileFormValues) => {\r\n    setIsUpdating(true);\r\n    try {\r\n      // Update local DB\r\n      const response = await fetch(\"/api/user/me\", {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(data),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Failed to update profile\");\r\n\r\n      // Update Clerk user\r\n      if (user) {\r\n        await user.update({\r\n          firstName: data.firstName,\r\n          lastName: data.lastName,\r\n        });\r\n      }\r\n\r\n      toast.success(\"Profile updated successfully\");\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast.error(\"Failed to update profile\");\r\n    } finally {\r\n      setIsUpdating(false);\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith(\"image/\")) {\r\n      toast.error(\"Please upload an image file\");\r\n      return;\r\n    }\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      toast.error(\"Image size should be less than 5MB\");\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    try {\r\n      if (user) {\r\n        await user.setProfileImage({ file });\r\n        toast.success(\"Avatar updated successfully\");\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast.error(\"Failed to update avatar\");\r\n    } finally {\r\n      setIsUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleConnect = async (platform: string) => {\r\n    if (['EMAIL', 'SMS', 'WHATSAPP'].includes(platform)) {\r\n        toast.info(`To enable ${platform} (via Twilio), please contact support.`);\r\n        return;\r\n    }\r\n\r\n    // Show Instagram connection method dialog\r\n    if (platform === 'INSTAGRAM') {\r\n        setShowInstagramDialog(true);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        const res = await fetch(`/api/socialmedia/auth-url?platform=${platform}`);\r\n        const data = await res.json();\r\n        \r\n        if (data.error) {\r\n            toast.error(data.error);\r\n            return;\r\n        }\r\n\r\n        if (data.url) {\r\n            window.location.href = data.url;\r\n        }\r\n    } catch (error) {\r\n        console.error(error);\r\n        toast.error(`Failed to initiate connection for ${platform}`);\r\n    }\r\n  };\r\n\r\n  const handleDisconnect = async (platform: string) => {\r\n    try {\r\n        const res = await fetch(\"/api/socialmedia/disconnect\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({ platform })\r\n        });\r\n        \r\n        if (res.ok) {\r\n            toast.success(`Disconnected ${platform} successfully`);\r\n            window.location.reload(); \r\n        } else {\r\n            toast.error(\"Failed to disconnect\");\r\n        }\r\n    } catch (error) {\r\n        console.error(error);\r\n        toast.error(\"Failed to disconnect\");\r\n    }\r\n  };\r\n\r\n  const handleConfigureLinkedIn = async () => {\r\n    setShowLinkedInDialog(true);\r\n    setLoadingPages(true);\r\n    try {\r\n        const res = await fetch(\"/api/socialmedia/linkedin/pages\");\r\n        if (res.ok) {\r\n            const data = await res.json();\r\n            setLinkedInPages(data.organizations || []);\r\n        }\r\n    } catch (error) {\r\n        console.error(error);\r\n        toast.error(\"Failed to fetch LinkedIn pages\");\r\n    } finally {\r\n        setLoadingPages(false);\r\n    }\r\n  };\r\n\r\n  const handleSelectPage = async (urn: string) => {\r\n    try {\r\n        const res = await fetch(\"/api/user/linkedin-page\", {\r\n            method: \"PUT\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({ urn })\r\n        });\r\n        \r\n        if (res.ok) {\r\n            toast.success(\"LinkedIn page updated\");\r\n            setShowLinkedInDialog(false);\r\n            window.location.reload(); \r\n        } else {\r\n            toast.error(\"Failed to update page\");\r\n        }\r\n    } catch (error) {\r\n        console.error(error);\r\n        toast.error(\"Failed to update page\");\r\n    }\r\n  };\r\n\r\n  const [socialStatus, setSocialStatus] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchSocialStatus = async () => {\r\n      try {\r\n        const res = await fetch(\"/api/user/social-status\");\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          setSocialStatus(data);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch social status\", error);\r\n      }\r\n    };\r\n    fetchSocialStatus();\r\n  }, []);\r\n\r\n  const platforms = [\r\n    {\r\n      id: \"FACEBOOK\",\r\n      name: \"Facebook\",\r\n      icon: Facebook,\r\n      color: \"text-blue-600\",\r\n      connected: userData.facebookConnected,\r\n      accountName: socialStatus?.facebook?.name,\r\n      description: \"Connect your Facebook Page to share posts and view analytics.\",\r\n    },\r\n    {\r\n      id: \"INSTAGRAM\",\r\n      name: \"Instagram\",\r\n      icon: Instagram,\r\n      color: \"text-pink-600\",\r\n      connected: userData.instagramConnected,\r\n      accountName: socialStatus?.instagram?.name,\r\n      description: \"Connect your Instagram Business account for posting and insights.\",\r\n    },\r\n    {\r\n      id: \"LINKEDIN\",\r\n      name: \"LinkedIn\",\r\n      icon: Linkedin,\r\n      color: \"text-blue-700\",\r\n      connected: userData.linkedInConnected,\r\n      accountName: socialStatus?.linkedin?.name,\r\n      followerCount: socialStatus?.linkedin?.followerCount,\r\n      description: \"Share updates to your LinkedIn personal profile or company page.\",\r\n    },\r\n    {\r\n      id: \"YOUTUBE\",\r\n      name: \"YouTube\",\r\n      icon: Youtube,\r\n      color: \"text-red-600\",\r\n      connected: userData.youtubeConnected,\r\n      accountName: socialStatus?.youtube?.name,\r\n      description: \"Upload videos and manage your YouTube channel.\",\r\n    },\r\n    {\r\n        id: \"PINTEREST\",\r\n        name: \"Pinterest\",\r\n        icon: CheckCircle2,\r\n        color: \"text-red-500\",\r\n        connected: userData.pinterestConnected,\r\n        accountName: socialStatus?.pinterest?.name,\r\n        description: \"Pin your visual content to Pinterest boards.\",\r\n    },\r\n    {\r\n        id: \"EMAIL\",\r\n        name: \"Email (Twilio SendGrid)\",\r\n        icon: Mail,\r\n        color: \"text-slate-600\",\r\n        connected: userData.emailConnected,\r\n        accountName: null,\r\n        description: \"Send emails via Twilio SendGrid.\",\r\n    },\r\n    {\r\n        id: \"SMS\",\r\n        name: \"SMS (Twilio)\",\r\n        icon: Smartphone,\r\n        color: \"text-red-500\",\r\n        connected: userData.smsConnected,\r\n        accountName: null,\r\n        description: \"Send SMS messages via Twilio.\",\r\n    },\r\n    {\r\n        id: \"WHATSAPP\",\r\n        name: \"WhatsApp (Twilio)\",\r\n        icon: MessageSquare,\r\n        color: \"text-green-500\",\r\n        connected: userData.whatsappConnected,\r\n        accountName: null,\r\n        description: \"Send WhatsApp messages via Twilio.\",\r\n    }\r\n  ];\r\n\r\n  const filteredPlatforms = platforms.filter(platform => {\r\n    // 1. Exclude EMAIL, SMS, WHATSAPP from the list entirely as they are admin-managed\r\n    if (['EMAIL', 'SMS', 'WHATSAPP'].includes(platform.id)) {\r\n        return false;\r\n    }\r\n    // 2. Only show platforms that are assigned to the organisation\r\n    return assignedPlatforms.includes(platform.id);\r\n  });\r\n\r\n  if (!isLoaded) {\r\n    return <div className=\"flex items-center justify-center h-96\"><Loader2 className=\"h-8 w-8 animate-spin\" /></div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold tracking-tight\">Settings</h2>\r\n        <p className=\"text-muted-foreground\">Manage your account settings and social connections.</p>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"social\" className=\"space-y-4\">\r\n        <TabsList>\r\n          {/* <TabsTrigger value=\"profile\">Profile</TabsTrigger> */}\r\n          <TabsTrigger value=\"social\">Social Accounts</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* <TabsContent value=\"profile\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Profile Information</CardTitle>\r\n              <CardDescription>Update your personal information and profile picture.</CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-6\">\r\n              <div className=\"flex items-center gap-6\">\r\n                <Avatar className=\"h-24 w-24\">\r\n                  <AvatarImage src={user?.imageUrl} />\r\n                  <AvatarFallback>{user?.firstName?.[0]}{user?.lastName?.[0]}</AvatarFallback>\r\n                </Avatar>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\" className=\"relative\" disabled={isUploading}>\r\n                      {isUploading ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Upload className=\"mr-2 h-4 w-4\" />}\r\n                      Change Avatar\r\n                      <input\r\n                        type=\"file\"\r\n                        className=\"absolute inset-0 cursor-pointer opacity-0\"\r\n                        accept=\"image/*\"\r\n                        onChange={handleImageUpload}\r\n                        disabled={isUploading}\r\n                      />\r\n                    </Button>\r\n                    <p className=\"text-xs text-muted-foreground\">JPG, GIF or PNG. Max 5MB.</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <Separator />\r\n\r\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"firstName\">First Name</Label>\r\n                    <Input id=\"firstName\" {...form.register(\"firstName\")} />\r\n                    {form.formState.errors.firstName && (\r\n                      <p className=\"text-sm text-red-500\">{form.formState.errors.firstName.message}</p>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"lastName\">Last Name</Label>\r\n                    <Input id=\"lastName\" {...form.register(\"lastName\")} />\r\n                    {form.formState.errors.lastName && (\r\n                      <p className=\"text-sm text-red-500\">{form.formState.errors.lastName.message}</p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"email\">Email</Label>\r\n                    <Input id=\"email\" value={userData.email} disabled className=\"bg-muted\" />\r\n                    <p className=\"text-xs text-muted-foreground\">Email cannot be changed.</p>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"mobile\">Mobile Number</Label>\r\n                    <Input id=\"mobile\" {...form.register(\"mobile\")} placeholder=\"+1 234 567 890\" />\r\n                    {form.formState.errors.mobile && (\r\n                      <p className=\"text-sm text-red-500\">{form.formState.errors.mobile.message}</p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end\">\r\n                  <Button type=\"submit\" disabled={isUpdating}>\r\n                    {isUpdating && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                    Save Changes\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent> */}\r\n\r\n        <TabsContent value=\"social\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Connected Accounts</CardTitle>\r\n              <CardDescription>Connect your social media accounts to enable posting and analytics.</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {filteredPlatforms.length > 0 ? (\r\n                    filteredPlatforms.map((platform) => (\r\n                  <div key={platform.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className={`p-2 rounded-full bg-muted ${platform.color}`}>\r\n                        <platform.icon className=\"h-6 w-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <h3 className=\"font-medium\">{platform.name}</h3>\r\n                        <p className=\"text-sm text-muted-foreground\">{platform.description}</p>\r\n                        {platform.connected && platform.accountName && (\r\n                            <p className=\"text-xs text-green-600 font-medium mt-1\">\r\n                                Connected as: {platform.accountName}\r\n                                {(platform as any).followerCount !== undefined && (platform as any).followerCount !== null && (\r\n                                    <span>  {(platform as any).followerCount} followers</span>\r\n                                )}\r\n                            </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      {platform.connected ? (\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <Badge variant=\"secondary\" className=\"bg-green-100 text-green-800 hover:bg-green-100\">\r\n                                <CheckCircle2 className=\"mr-1 h-3 w-3\" />\r\n                                Connected\r\n                            </Badge>\r\n                            {/* {platform.id === 'LINKEDIN' && (\r\n                                <Button variant=\"ghost\" size=\"sm\" onClick={handleConfigureLinkedIn} title=\"Configure Page\">\r\n                                    <Settings className=\"h-4 w-4\" />\r\n                                </Button>\r\n                            )} */}\r\n                            <Button variant=\"ghost\" size=\"sm\" className=\"text-red-500 hover:text-red-600 hover:bg-red-50\" onClick={() => handleDisconnect(platform.id)}>\r\n                                Disconnect\r\n                            </Button>\r\n                        </div>\r\n                      ) : (\r\n                        <Button variant=\"outline\" onClick={() => handleConnect(platform.id)}>\r\n                          Connect\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))\r\n                ) : (\r\n                    <div className=\"text-center py-8 text-muted-foreground\">\r\n                        No social platforms are assigned to your organisation. Please contact your administrator.\r\n                    </div>\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* LinkedIn Page Selection Dialog */}\r\n      {/* <Dialog open={showLinkedInDialog} onOpenChange={setShowLinkedInDialog}>\r\n        <DialogContent>\r\n            <DialogHeader>\r\n                <DialogTitle>Select LinkedIn Page</DialogTitle>\r\n                <DialogDescription>\r\n                    Choose the LinkedIn profile or company page you want to post to.\r\n                </DialogDescription>\r\n            </DialogHeader>\r\n            <div className=\"space-y-2 max-h-[300px] overflow-y-auto\">\r\n                {loadingPages ? (\r\n                    <div className=\"flex justify-center p-4\">\r\n                        <Loader2 className=\"h-6 w-6 animate-spin\" />\r\n                    </div>\r\n                ) : linkedInPages.length > 0 ? (\r\n                    linkedInPages.map((page) => (\r\n                        <div \r\n                            key={page.id} \r\n                            className={`flex items-center justify-between p-3 border rounded-lg hover:bg-muted cursor-pointer ${userData.linkedInAuthUrn === page.id ? 'bg-muted border-primary' : ''}`}\r\n                            onClick={() => handleSelectPage(page.id)}\r\n                        >\r\n                            <div>\r\n                                <p className=\"\">{page.name}</p>\r\n                                {page.followerCount !== null && (\r\n                                    <p className=\"text-xs text-muted-foreground\">{page.followerCount} followers</p>\r\n                                )}\r\n                                {page.type === 'PERSON' && (\r\n                                    <Badge variant=\"outline \"  className=\"mt-1 bg-gree\">Personal Profile</Badge>\r\n                                )}\r\n                            </div>\r\n                            {userData.linkedInAuthUrn === page.id && (\r\n                                <CheckCircle2 className=\"h-4 w-4 text-green-600\" />\r\n                            )}\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <p className=\"text-center text-muted-foreground p-4\">No pages found.</p>\r\n                )}\r\n            </div>\r\n        </DialogContent>\r\n      </Dialog> */}\r\n\r\n      {/* Instagram Connection Method Dialog */}\r\n      <Dialog open={showInstagramDialog} onOpenChange={setShowInstagramDialog}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>Connect Instagram</DialogTitle>\r\n            <DialogDescription>\r\n              Choose how you want to connect your Instagram account\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4 py-4\">\r\n            {/* Option 1: Via Facebook (Business Account) */}\r\n            <div \r\n              className=\"flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer hover:border-primary hover:bg-accent transition-colors\"\r\n              onClick={async () => {\r\n                setShowInstagramDialog(false);\r\n                try {\r\n                  const res = await fetch(`/api/socialmedia/auth-url?platform=INSTAGRAM`);\r\n                  const data = await res.json();\r\n                  if (data.url) window.location.href = data.url;\r\n                } catch (error) {\r\n                  toast.error('Failed to connect');\r\n                }\r\n              }}\r\n            >\r\n              <div className=\"p-2 rounded-full bg-blue-100\">\r\n                <Facebook className=\"h-6 w-6 text-blue-600\" />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h4 className=\"font-semibold text-sm\">Via Facebook (Recommended)</h4>\r\n                <p className=\"text-xs text-muted-foreground mt-1\">\r\n                  Connect your Instagram Business or Creator account through Facebook. \r\n                  Enables posting, Reels, and analytics.\r\n                </p>\r\n                <div className=\"mt-2\">\r\n                  <Badge variant=\"secondary\" className=\"text-xs\">\r\n                    <CheckCircle2 className=\"h-3 w-3 mr-1\" />\r\n                    Full Features\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Option 2: Instagram Basic Display (Limited) */}\r\n            <div \r\n              className=\"flex items-start gap-4 p-4 border-2 rounded-lg cursor-pointer hover:border-primary hover:bg-accent transition-colors opacity-60\"\r\n              onClick={() => {\r\n                toast.info('Instagram Basic Display is coming soon. Please use Facebook connection for now.');\r\n              }}\r\n            >\r\n              <div className=\"p-2 rounded-full bg-pink-100\">\r\n                <Instagram className=\"h-6 w-6 text-pink-600\" />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h4 className=\"font-semibold text-sm\">Instagram Basic Display</h4>\r\n                <p className=\"text-xs text-muted-foreground mt-1\">\r\n                  Connect personal Instagram account. Limited to viewing posts and profile info only.\r\n                </p>\r\n                <div className=\"mt-2\">\r\n                  <Badge variant=\"outline\" className=\"text-xs\">\r\n                    Coming Soon\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"bg-muted p-3 rounded-lg\">\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              <strong>Note:</strong> To post content and use Reels, you need an Instagram Business or Creator account connected via Facebook.\r\n            </p>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\organisation\\templates\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1478,1481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1478,1481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1591,1594],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1591,1594],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'filterTemplates'. Either include it or remove the dependency array.","line":127,"column":6,"nodeType":"ArrayExpression","endLine":127,"endColumn":62,"suggestions":[{"desc":"Update the dependencies array to be: [templates, searchQuery, platformFilter, categoryFilter, filterTemplates]","fix":{"range":[3126,3182],"text":"[templates, searchQuery, platformFilter, categoryFilter, filterTemplates]"}}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":636,"column":47,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21647,21696],"text":"\r\n              Are you sure you want to delete &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21647,21696],"text":"\r\n              Are you sure you want to delete &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21647,21696],"text":"\r\n              Are you sure you want to delete &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21647,21696],"text":"\r\n              Are you sure you want to delete &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":636,"column":70,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[21718,21779],"text":"&quot;? This action cannot be\r\n              undone.\r\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[21718,21779],"text":"&ldquo;? This action cannot be\r\n              undone.\r\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[21718,21779],"text":"&#34;? This action cannot be\r\n              undone.\r\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[21718,21779],"text":"&rdquo;? This action cannot be\r\n              undone.\r\n            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from \"@/components/ui/card\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n  Plus,\r\n  Search,\r\n  Eye,\r\n  Edit,\r\n  Trash2,\r\n  Mail,\r\n  MessageSquare,\r\n  Phone,\r\n  Facebook,\r\n  Instagram,\r\n  Linkedin,\r\n  Youtube,\r\n  Filter,\r\n} from \"lucide-react\";\r\n\r\nimport { Sidebar } from '@/components/Sidebar';\r\nimport { Header } from '@/components/Header';\r\n\r\ninterface MessageTemplate {\r\n  id: number;\r\n  name: string;\r\n  description: string | null;\r\n  content: string;\r\n  subject: string | null;\r\n  platform: string;\r\n  category: string;\r\n  variables: any;\r\n  isActive: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nconst platformIcons: Record<string, any> = {\r\n  EMAIL: Mail,\r\n  SMS: MessageSquare,\r\n  WHATSAPP: Phone,\r\n  FACEBOOK: Facebook,\r\n  INSTAGRAM: Instagram,\r\n  LINKEDIN: Linkedin,\r\n  YOUTUBE: Youtube,\r\n};\r\n\r\nconst platformColors: Record<string, string> = {\r\n  EMAIL: \"bg-blue-500\",\r\n  SMS: \"bg-green-500\",\r\n  WHATSAPP: \"bg-emerald-500\",\r\n  FACEBOOK: \"bg-blue-600\",\r\n  INSTAGRAM: \"bg-pink-500\",\r\n  LINKEDIN: \"bg-blue-700\",\r\n  YOUTUBE: \"bg-red-500\",\r\n};\r\n\r\nexport default function TemplatesPage() {\r\n  const [templates, setTemplates] = useState<MessageTemplate[]>([]);\r\n  const [filteredTemplates, setFilteredTemplates] = useState<MessageTemplate[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [platformFilter, setPlatformFilter] = useState<string>(\"ALL\");\r\n  const [categoryFilter, setCategoryFilter] = useState<string>(\"ALL\");\r\n  \r\n  // Modals\r\n  const [previewTemplate, setPreviewTemplate] = useState<MessageTemplate | null>(null);\r\n  const [editTemplate, setEditTemplate] = useState<MessageTemplate | null>(null);\r\n  const [deleteTemplate, setDeleteTemplate] = useState<MessageTemplate | null>(null);\r\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\r\n\r\n  // Form state\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    description: \"\",\r\n    content: \"\",\r\n    subject: \"\",\r\n    platform: \"EMAIL\",\r\n    category: \"CUSTOM\",\r\n    isActive: true,\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchTemplates();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    filterTemplates();\r\n  }, [templates, searchQuery, platformFilter, categoryFilter]);\r\n\r\n  const fetchTemplates = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await fetch(\"/api/templates\");\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        setTemplates(data.data);\r\n      } else {\r\n        toast.error(\"Failed to load templates\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching templates:\", error);\r\n      toast.error(\"Failed to load templates\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const filterTemplates = () => {\r\n    let filtered = [...templates];\r\n\r\n    // Platform filter\r\n    if (platformFilter !== \"ALL\") {\r\n      filtered = filtered.filter((t) => t.platform === platformFilter);\r\n    }\r\n\r\n    // Category filter\r\n    if (categoryFilter !== \"ALL\") {\r\n      filtered = filtered.filter((t) => t.category === categoryFilter);\r\n    }\r\n\r\n    // Search filter\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (t) =>\r\n          t.name.toLowerCase().includes(query) ||\r\n          t.description?.toLowerCase().includes(query) ||\r\n          t.content.toLowerCase().includes(query)\r\n      );\r\n    }\r\n\r\n    setFilteredTemplates(filtered);\r\n  };\r\n\r\n  const handleCreate = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/templates\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        toast.success(\"Template created successfully\");\r\n        setIsCreateModalOpen(false);\r\n        resetForm();\r\n        fetchTemplates();\r\n      } else {\r\n        toast.error(data.error || \"Failed to create template\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error creating template:\", error);\r\n      toast.error(\"Failed to create template\");\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async () => {\r\n    if (!editTemplate) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/templates/${editTemplate.id}`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        toast.success(\"Template updated successfully\");\r\n        setEditTemplate(null);\r\n        resetForm();\r\n        fetchTemplates();\r\n      } else {\r\n        toast.error(data.error || \"Failed to update template\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error updating template:\", error);\r\n      toast.error(\"Failed to update template\");\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!deleteTemplate) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/templates/${deleteTemplate.id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        toast.success(\"Template deleted successfully\");\r\n        setDeleteTemplate(null);\r\n        fetchTemplates();\r\n      } else {\r\n        toast.error(data.error || \"Failed to delete template\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error deleting template:\", error);\r\n      toast.error(\"Failed to delete template\");\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      name: \"\",\r\n      description: \"\",\r\n      content: \"\",\r\n      subject: \"\",\r\n      platform: \"EMAIL\",\r\n      category: \"CUSTOM\",\r\n      isActive: true,\r\n    });\r\n  };\r\n\r\n  const openEditModal = (template: MessageTemplate) => {\r\n    setFormData({\r\n      name: template.name,\r\n      description: template.description || \"\",\r\n      content: template.content,\r\n      subject: template.subject || \"\",\r\n      platform: template.platform,\r\n      category: template.category,\r\n      isActive: template.isActive,\r\n    });\r\n    setEditTemplate(template);\r\n  };\r\n\r\n  const getPlatformIcon = (platform: string) => {\r\n    const Icon = platformIcons[platform] || Mail;\r\n    return <Icon className=\"size-5\" />;\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n     <div className=\"min-h-screen bg-background\">\r\n            <Header />\r\n            <div className=\"flex\">\r\n                <Sidebar />\r\n                <main className=\"flex-1 p-6\">\r\n    <div className=\"container mx-auto p-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Message Templates</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Create and manage reusable message templates\r\n          </p>\r\n        </div>\r\n        <Button onClick={() => setIsCreateModalOpen(true)}>\r\n          <Plus className=\"mr-2 size-4\" />\r\n          New Template\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"grid gap-4 md:grid-cols-3\">\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-3 size-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search templates...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n\r\n            <Select value={platformFilter} onValueChange={setPlatformFilter}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Filter by platform\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"ALL\">All Platforms</SelectItem>\r\n                <SelectItem value=\"EMAIL\">Email</SelectItem>\r\n                <SelectItem value=\"SMS\">SMS</SelectItem>\r\n                <SelectItem value=\"WHATSAPP\">WhatsApp</SelectItem>\r\n                <SelectItem value=\"FACEBOOK\">Facebook</SelectItem>\r\n                <SelectItem value=\"INSTAGRAM\">Instagram</SelectItem>\r\n                <SelectItem value=\"LINKEDIN\">LinkedIn</SelectItem>\r\n                <SelectItem value=\"YOUTUBE\">YouTube</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <Select value={categoryFilter} onValueChange={setCategoryFilter}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Filter by category\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"ALL\">All Categories</SelectItem>\r\n                <SelectItem value=\"MARKETING\">Marketing</SelectItem>\r\n                <SelectItem value=\"TRANSACTIONAL\">Transactional</SelectItem>\r\n                <SelectItem value=\"NOTIFICATION\">Notification</SelectItem>\r\n                <SelectItem value=\"CUSTOM\">Custom</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Templates Grid */}\r\n      {filteredTemplates.length === 0 ? (\r\n        <Card>\r\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\r\n            <Filter className=\"size-12 text-muted-foreground mb-4\" />\r\n            <h3 className=\"text-lg font-semibold mb-2\">No templates found</h3>\r\n            <p className=\"text-muted-foreground text-center mb-4\">\r\n              {searchQuery || platformFilter !== \"ALL\" || categoryFilter !== \"ALL\"\r\n                ? \"Try adjusting your filters\"\r\n                : \"Create your first template to get started\"}\r\n            </p>\r\n            {!searchQuery && platformFilter === \"ALL\" && categoryFilter === \"ALL\" && (\r\n              <Button onClick={() => setIsCreateModalOpen(true)}>\r\n                <Plus className=\"mr-2 size-4\" />\r\n                Create Template\r\n              </Button>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n          {filteredTemplates.map((template) => (\r\n            <Card key={template.id} className=\"hover:shadow-lg transition-shadow\">\r\n              <CardHeader>\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className={`p-2 rounded-lg ${platformColors[template.platform]} text-white`}>\r\n                      {getPlatformIcon(template.platform)}\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle className=\"text-lg\">{template.name}</CardTitle>\r\n                      <div className=\"flex gap-2 mt-1\">\r\n                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                          {template.category}\r\n                        </Badge>\r\n                        {!template.isActive && (\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">\r\n                            Inactive\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                {template.description && (\r\n                  <CardDescription className=\"mt-2\">\r\n                    {template.description}\r\n                  </CardDescription>\r\n                )}\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {template.subject && (\r\n                    <div>\r\n                      <p className=\"text-sm font-medium text-muted-foreground\">Subject:</p>\r\n                      <p className=\"text-sm truncate\">{template.subject}</p>\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <p className=\"text-sm font-medium text-muted-foreground\">Content Preview:</p>\r\n                    <p className=\"text-sm line-clamp-2\">{template.content}</p>\r\n                  </div>\r\n                  <div className=\"flex gap-2 pt-2\">\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      className=\"flex-1\"\r\n                      onClick={() => setPreviewTemplate(template)}\r\n                    >\r\n                      <Eye className=\"mr-2 size-4\" />\r\n                      Preview\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => openEditModal(template)}\r\n                    >\r\n                      <Edit className=\"size-4\" />\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => setDeleteTemplate(template)}\r\n                    >\r\n                      <Trash2 className=\"size-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Create/Edit Modal */}\r\n      <Dialog\r\n        open={isCreateModalOpen || !!editTemplate}\r\n        onOpenChange={(open) => {\r\n          if (!open) {\r\n            setIsCreateModalOpen(false);\r\n            setEditTemplate(null);\r\n            resetForm();\r\n          }\r\n        }}\r\n      >\r\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editTemplate ? \"Edit Template\" : \"Create New Template\"}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {editTemplate\r\n                ? \"Update your message template\"\r\n                : \"Create a reusable message template\"}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-4\">\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"name\">Template Name *</Label>\r\n                <Input\r\n                  id=\"name\"\r\n                  value={formData.name}\r\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                  placeholder=\"Welcome Email\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"platform\">Platform *</Label>\r\n                <Select\r\n                  value={formData.platform}\r\n                  onValueChange={(value) => setFormData({ ...formData, platform: value })}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"EMAIL\">Email</SelectItem>\r\n                    <SelectItem value=\"SMS\">SMS</SelectItem>\r\n                    <SelectItem value=\"WHATSAPP\">WhatsApp</SelectItem>\r\n                    <SelectItem value=\"FACEBOOK\">Facebook</SelectItem>\r\n                    <SelectItem value=\"INSTAGRAM\">Instagram</SelectItem>\r\n                    <SelectItem value=\"LINKEDIN\">LinkedIn</SelectItem>\r\n                    <SelectItem value=\"YOUTUBE\">YouTube</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"category\">Category</Label>\r\n              <Select\r\n                value={formData.category}\r\n                onValueChange={(value) => setFormData({ ...formData, category: value })}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"MARKETING\">Marketing</SelectItem>\r\n                  <SelectItem value=\"TRANSACTIONAL\">Transactional</SelectItem>\r\n                  <SelectItem value=\"NOTIFICATION\">Notification</SelectItem>\r\n                  <SelectItem value=\"CUSTOM\">Custom</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"description\">Description</Label>\r\n              <Input\r\n                id=\"description\"\r\n                value={formData.description}\r\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                placeholder=\"Brief description of this template\"\r\n              />\r\n            </div>\r\n\r\n            {(formData.platform === \"EMAIL\") && (\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"subject\">Subject</Label>\r\n                <Input\r\n                  id=\"subject\"\r\n                  value={formData.subject}\r\n                  onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\r\n                  placeholder=\"Email subject line\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"content\">Content *</Label>\r\n              <Textarea\r\n                id=\"content\"\r\n                value={formData.content}\r\n                onChange={(e) => setFormData({ ...formData, content: e.target.value })}\r\n                placeholder=\"Template content... Use {{variable_name}} for variables\"\r\n                rows={8}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Use double curly braces for variables: {`{{firstName}}, {{companyName}}`}\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch\r\n                id=\"isActive\"\r\n                checked={formData.isActive}\r\n                onCheckedChange={(checked) => setFormData({ ...formData, isActive: checked })}\r\n              />\r\n              <Label htmlFor=\"isActive\">Active</Label>\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setIsCreateModalOpen(false);\r\n                setEditTemplate(null);\r\n                resetForm();\r\n              }}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={editTemplate ? handleUpdate : handleCreate}>\r\n              {editTemplate ? \"Update\" : \"Create\"} Template\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Preview Modal */}\r\n      <Dialog open={!!previewTemplate} onOpenChange={() => setPreviewTemplate(null)}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>{previewTemplate?.name}</DialogTitle>\r\n            <DialogDescription asChild>\r\n              <div className=\"flex gap-2 mt-2\">\r\n                <Badge>{previewTemplate?.platform}</Badge>\r\n                <Badge variant=\"outline\">{previewTemplate?.category}</Badge>\r\n              </div>\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-4\">\r\n            {previewTemplate?.description && (\r\n              <div>\r\n                <p className=\"text-sm font-medium mb-1\">Description:</p>\r\n                <p className=\"text-sm text-muted-foreground\">{previewTemplate.description}</p>\r\n              </div>\r\n            )}\r\n\r\n            {previewTemplate?.subject && (\r\n              <div>\r\n                <p className=\"text-sm font-medium mb-1\">Subject:</p>\r\n                <p className=\"text-sm\">{previewTemplate.subject}</p>\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <p className=\"text-sm font-medium mb-1\">Content:</p>\r\n              <div className=\"bg-muted p-4 rounded-lg whitespace-pre-wrap text-sm\">\r\n                {previewTemplate?.content}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setPreviewTemplate(null)}>\r\n              Close\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Delete Confirmation */}\r\n      <AlertDialog open={!!deleteTemplate} onOpenChange={() => setDeleteTemplate(null)}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Delete Template</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Are you sure you want to delete \"{deleteTemplate?.name}\"? This action cannot be\r\n              undone.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleDelete} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\r\n              Delete\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n    </main>\r\n    </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedPlan' is assigned a value but never used.","line":79,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showPaymentModal' is assigned a value but never used.","line":80,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":80,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handlePaymentSuccess' is assigned a value but never used.","line":94,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":94,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Check, Zap, Shield, BarChart3, Users, Star, ArrowRight } from \"lucide-react\";\r\nimport { useState } from \"react\";\r\n// import { PaymentModal } from \"@/components/PaymentModal\"; // We will need to migrate this component too\r\nimport { SignInButton, SignUpButton, SignedOut, SignedIn, UserButton } from \"@clerk/nextjs\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Header } from '@/components/Header';\r\n\r\ntype Plan = {\r\n  name: string;\r\n  price: number;\r\n  period: string;\r\n  description: string;\r\n  features: string[];\r\n  isTrial?: boolean;\r\n  isPopular?: boolean;\r\n  priceId?: string;\r\n};\r\n\r\nconst plans: Plan[] = [\r\n  {\r\n    name: \"Free Trial\",\r\n    price: 0,\r\n    period: \"14 days\",\r\n    description: \"Try all features for free\",\r\n    isTrial: true,\r\n    features: [\r\n      \"Up to 5 users\",\r\n      \"Basic analytics\",\r\n      \"Email support\",\r\n      \"Core features access\",\r\n      \"5GB storage\",\r\n      \"Community support\",\r\n    ],\r\n  },\r\n  {\r\n    name: \"Professional\",\r\n    price: 2999,\r\n    period: \"month\",\r\n    description: \"Perfect for growing teams\",\r\n    isPopular: true,\r\n    priceId: \"plan_pro_monthly\",\r\n    features: [\r\n      \"Unlimited users\",\r\n      \"Advanced analytics\",\r\n      \"Priority support\",\r\n      \"All features unlocked\",\r\n      \"100GB storage\",\r\n      \"Custom integrations\",\r\n      \"API access\",\r\n      \"White-label options\",\r\n    ],\r\n  },\r\n  {\r\n    name: \"Enterprise\",\r\n    price: 9999,\r\n    period: \"month\",\r\n    description: \"For large organizations\",\r\n    priceId: \"plan_enterprise_monthly\",\r\n    features: [\r\n      \"Everything in Professional\",\r\n      \"Dedicated account manager\",\r\n      \"24/7 phone support\",\r\n      \"Custom SLA\",\r\n      \"Unlimited storage\",\r\n      \"Advanced security\",\r\n      \"Custom contracts\",\r\n      \"On-premise deployment option\",\r\n    ],\r\n  },\r\n];\r\n\r\nexport default function LandingPage() {\r\n  const [selectedPlan, setSelectedPlan] = useState<Plan | null>(null);\r\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n  const router = useRouter();\r\n\r\n  const handlePlanSelect = (plan: Plan) => {\r\n    if (plan.isTrial) {\r\n      // Redirect to sign up\r\n      router.push(\"/sign-up\");\r\n    } else {\r\n      // Show payment modal for paid plans\r\n      setSelectedPlan(plan);\r\n      setShowPaymentModal(true);\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = () => {\r\n    setShowPaymentModal(false);\r\n    alert(\"Payment successful! Your account has been created.\");\r\n    router.push(\"/organisation\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen\">\r\n      {/* Navigation */}\r\n      <Header />\r\n      <nav className=\"fixed top-0 w-full bg-background/80 backdrop-blur-md border-b z-50\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex justify-between items-center h-16\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Zap className=\"size-8 text-primary\" />\r\n              <span className=\"font-semibold\">SaaSify</span>\r\n            </div>\r\n            <div className=\"hidden md:flex items-center gap-8\">\r\n              <a href=\"#features\" className=\"text-muted-foreground hover:text-foreground\">\r\n                Features\r\n              </a>\r\n              <a href=\"#pricing\" className=\"text-muted-foreground hover:text-foreground\">\r\n                Pricing\r\n              </a>\r\n              <a href=\"#about\" className=\"text-muted-foreground hover:text-foreground\">\r\n                About\r\n              </a>\r\n            </div>\r\n            <div className=\"flex items-center gap-4\">\r\n              <SignedOut>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <SignUpButton mode=\"modal\">\r\n                    <button className=\"px-3 py-2 text-red-500 border border-red-500 rounded-md\">\r\n                      Sign Up\r\n                    </button>\r\n                  </SignUpButton>\r\n\r\n                  <SignInButton mode=\"modal\">\r\n                    <button className=\"px-3 py-2 text-red-500 border border-red-500 rounded-md\" style={{ backgroundColor: \"red\",color :\"white\" }}>\r\n                      Sign In\r\n                    </button>\r\n                  </SignInButton>\r\n                </div>\r\n              </SignedOut>\r\n              <SignedIn>\r\n                <UserButton afterSignOutUrl=\"/\" />\r\n                <Link href=\"/organisation\">\r\n                    <Button variant=\"outline\">Dashboard</Button>\r\n                </Link>\r\n              </SignedIn>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* Hero Section */}\r\n      <section className=\"pt-32 pb-20 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-7xl mx-auto text-center\">\r\n          <Badge variant=\"secondary\" className=\"mb-4\">\r\n             Now with AI-powered insights\r\n          </Badge>\r\n          <h1 className=\"mb-6 max-w-4xl mx-auto\">\r\n            The Complete SaaS Platform for Modern Teams\r\n          </h1>\r\n          <p className=\"text-muted-foreground mb-8 max-w-2xl mx-auto\">\r\n            Streamline your workflow, boost productivity, and scale your business with our all-in-one platform.\r\n            Start your free 14-day trial today, no credit card required.\r\n          </p>\r\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\r\n            <Button size=\"lg\" onClick={() => handlePlanSelect(plans[0])}>\r\n              Start Free Trial\r\n              <ArrowRight className=\"ml-2 size-4\" />\r\n            </Button>\r\n            <Button\r\n              size=\"lg\"\r\n              variant=\"outline\"\r\n              onClick={() => document.getElementById(\"pricing\")?.scrollIntoView({ behavior: \"smooth\" })}\r\n            >\r\n              View Pricing\r\n            </Button>\r\n          </div>\r\n          <div className=\"mt-16 flex justify-center gap-8 text-sm text-muted-foreground\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              14-day free trial\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              No credit card required\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              Cancel anytime\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Features Section */}\r\n      <section id=\"features\" className=\"py-20 px-4 sm:px-6 lg:px-8 bg-muted/30\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          <div className=\"text-center mb-16\">\r\n            <h2 className=\"mb-4\">Powerful Features for Every Team</h2>\r\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\r\n              Everything you need to manage, scale, and optimize your business operations\r\n            </p>\r\n          </div>\r\n          <div className=\"grid md:grid-cols-3 gap-8\">\r\n            <Card>\r\n              <CardHeader>\r\n                <BarChart3 className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Advanced Analytics</CardTitle>\r\n                <CardDescription>\r\n                  Get deep insights into your business metrics with real-time dashboards and custom reports\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader>\r\n                <Shield className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Enterprise Security</CardTitle>\r\n                <CardDescription>\r\n                  Bank-level encryption, SOC 2 compliance, and advanced access controls to keep your data safe\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader>\r\n                <Users className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Team Collaboration</CardTitle>\r\n                <CardDescription>\r\n                  Work seamlessly with your team using shared workspaces, comments, and real-time updates\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Pricing Section */}\r\n      <section id=\"pricing\" className=\"py-20 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          <div className=\"text-center mb-16\">\r\n            <h2 className=\"mb-4\">Simple, Transparent Pricing</h2>\r\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\r\n              Choose the perfect plan for your needs. Start with a free trial or go straight to a paid plan.\r\n            </p>\r\n          </div>\r\n          <div className=\"grid md:grid-cols-3 gap-8\">\r\n            {plans.map((plan) => (\r\n              <Card\r\n                key={plan.name}\r\n                className={`relative ${plan.isPopular ? \"border-primary shadow-lg\" : \"\"}`}\r\n              >\r\n                {plan.isPopular && (\r\n                  <div className=\"absolute -top-4 left-1/2 -translate-x-1/2\">\r\n                    <Badge className=\"gap-1\">\r\n                      <Star className=\"size-3\" />\r\n                      Most Popular\r\n                    </Badge>\r\n                  </div>\r\n                )}\r\n                <CardHeader>\r\n                  <CardTitle>{plan.name}</CardTitle>\r\n                  <CardDescription>{plan.description}</CardDescription>\r\n                  <div className=\"mt-4\">\r\n                    <span className=\"text-4xl\">{plan.price === 0 ? \"Free\" : `${plan.price}`}</span>\r\n                    {plan.price > 0 && <span className=\"text-muted-foreground\">/{plan.period}</span>}\r\n                    {plan.isTrial && <span className=\"text-muted-foreground\"> for {plan.period}</span>}\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <ul className=\"space-y-3\">\r\n                    {plan.features.map((feature, index) => (\r\n                      <li key={index} className=\"flex items-start gap-2\">\r\n                        <Check className=\"size-5 text-green-500 shrink-0 mt-0.5\" />\r\n                        <span className=\"text-sm\">{feature}</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </CardContent>\r\n                <CardFooter>\r\n                  <Button\r\n                    className=\"w-full\"\r\n                    variant={plan.isPopular ? \"default\" : \"outline\"}\r\n                    onClick={() => handlePlanSelect(plan)}\r\n                  >\r\n                    {plan.isTrial ? \"Start Free Trial\" : \"Purchase Now\"}\r\n                  </Button>\r\n                </CardFooter>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      <section className=\"py-20 px-4 sm:px-6 lg:px-8 bg-primary text-primary-foreground\">\r\n        <div className=\"max-w-4xl mx-auto text-center\">\r\n          <h2 className=\"mb-4 text-primary-foreground\">Ready to Get Started?</h2>\r\n          <p className=\"mb-8 text-primary-foreground/90\">\r\n            Join thousands of teams already using SaaSify to streamline their operations\r\n          </p>\r\n          <Button size=\"lg\" variant=\"secondary\" onClick={() => handlePlanSelect(plans[0])}>\r\n            Start Your Free Trial\r\n            <ArrowRight className=\"ml-2 size-4\" />\r\n          </Button>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n      <footer className=\"py-12 px-4 sm:px-6 lg:px-8 border-t\">\r\n        <div className=\"max-w-7xl mx-auto text-center text-muted-foreground text-sm\">\r\n          <div className=\"flex items-center justify-center gap-2 mb-4\">\r\n            <Zap className=\"size-6 text-primary\" />\r\n            <span className=\"font-semibold text-foreground\">SaaSify</span>\r\n          </div>\r\n          <p> 2025 SaaSify. All rights reserved.</p>\r\n        </div>\r\n      </footer>\r\n\r\n      {/* Payment Modal Placeholder - Needs migration */}\r\n      {/* {showPaymentModal && selectedPlan && (\r\n        <PaymentModal\r\n          plan={selectedPlan}\r\n          onClose={() => setShowPaymentModal(false)}\r\n          onSuccess={handlePaymentSuccess}\r\n        />\r\n      )} */}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\payment\\failure\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":24,"column":22,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[983,1060],"text":"\r\n            We couldn&apos;t process your payment. Please try again.\r\n          "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[983,1060],"text":"\r\n            We couldn&lsquo;t process your payment. Please try again.\r\n          "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[983,1060],"text":"\r\n            We couldn&#39;t process your payment. Please try again.\r\n          "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[983,1060],"text":"\r\n            We couldn&rsquo;t process your payment. Please try again.\r\n          "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { XCircle, RefreshCcw, HelpCircle } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function PaymentFailurePage() {\r\n  const searchParams = useSearchParams();\r\n  const error = searchParams.get(\"error\");\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30 p-4\">\r\n      <Card className=\"w-full max-w-md text-center\">\r\n        <CardHeader>\r\n          <div className=\"flex justify-center mb-4\">\r\n            <div className=\"size-16 rounded-full bg-red-100 flex items-center justify-center\">\r\n              <XCircle className=\"size-8 text-red-600\" />\r\n            </div>\r\n          </div>\r\n          <CardTitle className=\"text-2xl text-red-700\">Payment Failed</CardTitle>\r\n          <CardDescription>\r\n            We couldn't process your payment. Please try again.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"bg-red-50 p-4 rounded-lg border border-red-100 text-left\">\r\n            <p className=\"text-sm font-medium text-red-800 mb-1\">Error Details:</p>\r\n            <p className=\"text-sm text-red-600\">\r\n              {error || \"The transaction was declined by the bank or cancelled.\"}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"flex flex-col gap-3\">\r\n            <Button className=\"w-full\" asChild>\r\n              <Link href=\"/onboarding\">\r\n                <RefreshCcw className=\"mr-2 size-4\" /> Try Again\r\n              </Link>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"w-full\" asChild>\r\n              <Link href=\"mailto:support@campzeo.com\">\r\n                <HelpCircle className=\"mr-2 size-4\" /> Contact Support\r\n              </Link>\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\payment\\success\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":12,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":15},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\payment\\success\\page.tsx:18:7\n  16 |     const pid = searchParams.get(\"payment_id\");\n  17 |     if (pid) {\n> 18 |       setPaymentId(pid);\n     |       ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  19 |     }\n  20 |   }, [searchParams]);\n  21 |","line":18,"column":7,"nodeType":null,"endLine":18,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useSearchParams, useRouter } from \"next/navigation\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { CheckCircle, ArrowRight, Download } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function PaymentSuccessPage() {\r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n  const [paymentId, setPaymentId] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const pid = searchParams.get(\"payment_id\");\r\n    if (pid) {\r\n      setPaymentId(pid);\r\n    }\r\n  }, [searchParams]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30 p-4\">\r\n      <Card className=\"w-full max-w-md text-center\">\r\n        <CardHeader>\r\n          <div className=\"flex justify-center mb-4\">\r\n            <div className=\"size-16 rounded-full bg-green-100 flex items-center justify-center\">\r\n              <CheckCircle className=\"size-8 text-green-600\" />\r\n            </div>\r\n          </div>\r\n          <CardTitle className=\"text-2xl text-green-700\">Payment Successful!</CardTitle>\r\n          <CardDescription>\r\n            Thank you for your purchase. Your transaction has been completed successfully.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"bg-slate-50 p-4 rounded-lg border text-left space-y-2\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-muted-foreground\">Status</span>\r\n              <span className=\"font-medium text-green-600\">Completed</span>\r\n            </div>\r\n            {paymentId && (\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-muted-foreground\">Payment ID</span>\r\n                <span className=\"font-medium font-mono\">{paymentId}</span>\r\n              </div>\r\n            )}\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-muted-foreground\">Receipt</span>\r\n              <span className=\"font-medium\">Sent to email</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex flex-col gap-3\">\r\n            <Button className=\"w-full\" asChild>\r\n              <Link href=\"/organisation\">\r\n                Go to Dashboard <ArrowRight className=\"ml-2 size-4\" />\r\n              </Link>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"w-full\">\r\n              <Download className=\"mr-2 size-4\" /> Download Invoice\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\pending-approval\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\sign-in\\[[...sign-in]]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\sign-up\\[[...sign-up]]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SignUp' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useClerk } from \"@clerk/nextjs\";\r\nimport { SignUp } from \"@clerk/nextjs\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { toast } from \"sonner\";\r\n\r\nexport default function Page() {\r\n  const { client } = useClerk();\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [form, setForm] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n    name: \"\",\r\n    organisationName: \"\",\r\n    mobile: \"\",\r\n    address: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    country: \"\",\r\n    postalCode: \"\",\r\n    enquiryText: \"\",\r\n    taxNumber: \"\",\r\n  });\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) =>\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n\r\n  const submit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      debugger;\r\n      const signUp = await client.signUp.create({\r\n        emailAddress: form.email,\r\n        password: form.password,\r\n      });\r\n\r\n      await signUp.prepareEmailAddressVerification({\r\n        strategy: \"email_code\",\r\n      });\r\n\r\n      const response = await fetch(\"/api/enquiries\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify(form),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(\"Failed to submit enquiry\");\r\n      }\r\n\r\n      toast.success(\"Success!\", {\r\n        description: \"Your account has been created and enquiry submitted. Please check your email for verification.\",\r\n      });\r\n\r\n      // Reset form after successful submission\r\n      setForm({\r\n        email: \"\",\r\n        password: \"\",\r\n        name: \"\",\r\n        organisationName: \"\",\r\n        mobile: \"\",\r\n        address: \"\",\r\n        city: \"\",\r\n        state: \"\",\r\n        country: \"\",\r\n        postalCode: \"\",\r\n        enquiryText: \"\",\r\n        taxNumber: \"\",\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Submission error:\", error);\r\n      toast.error(\"Submission Failed\", {\r\n        description: error instanceof Error ? error.message : \"An error occurred during submission. Please try again.\",\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-screen bg-background p-4 gap-8\">\r\n      {/* <SignUp /> */}\r\n\r\n      <div className=\"w-full max-w-2xl\">\r\n        <Card className=\"shadow-lg border-0 sm:border\">\r\n          <CardHeader className=\"space-y-1\">\r\n            <CardTitle className=\"text-2xl font-bold text-center\">Start your Free Trial</CardTitle>\r\n            <CardDescription className=\"text-center\">\r\n              Create an account and tell us about your requirements\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <form onSubmit={submit} className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"email\">Email</Label>\r\n                <Input\r\n                  id=\"email\"\r\n                  name=\"email\"\r\n                  placeholder=\"name@example.com\"\r\n                  value={form.email}\r\n                  onChange={handleChange}\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"password\">Password</Label>\r\n                <Input\r\n                  id=\"password\"\r\n                  name=\"password\"\r\n                  type=\"password\"\r\n                  placeholder=\"Create a password\"\r\n                  value={form.password}\r\n                  onChange={handleChange}\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"organisationName\">Business Name</Label>\r\n                <Input\r\n                  id=\"organisationName\"\r\n                  name=\"organisationName\"\r\n                  placeholder=\"Acme Corp\"\r\n                  value={form.organisationName}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"name\">Name</Label>\r\n                <Input\r\n                  id=\"name\"\r\n                  name=\"name\"\r\n                  placeholder=\"John Doe\"\r\n                  value={form.name}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"mobile\">Mobile</Label>\r\n                <Input\r\n                  id=\"mobile\"\r\n                  name=\"mobile\"\r\n                  placeholder=\"+1 (555) 000-0000\"\r\n                  value={form.mobile}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"address\">Address</Label>\r\n                <Input\r\n                  id=\"address\"\r\n                  name=\"address\"\r\n                  placeholder=\"123 Main St\"\r\n                  value={form.address}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"city\">City</Label>\r\n                <Input\r\n                  id=\"city\"\r\n                  name=\"city\"\r\n                  placeholder=\"New York\"\r\n                  value={form.city}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"state\">State</Label>\r\n                <Input\r\n                  id=\"state\"\r\n                  name=\"state\"\r\n                  placeholder=\"NY\"\r\n                  value={form.state}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"country\">Country</Label>\r\n                <Input\r\n                  id=\"country\"\r\n                  name=\"country\"\r\n                  placeholder=\"United States\"\r\n                  value={form.country}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"postalCode\">Postal Code</Label>\r\n                <Input\r\n                  id=\"postalCode\"\r\n                  name=\"postalCode\"\r\n                  placeholder=\"10001\"\r\n                  value={form.postalCode}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"taxNumber\">GST / Tax Number</Label>\r\n                <Input\r\n                  id=\"taxNumber\"\r\n                  name=\"taxNumber\"\r\n                  placeholder=\"Optional\"\r\n                  value={form.taxNumber}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"enquiryText\">Enquiry</Label>\r\n                <Textarea\r\n                  id=\"enquiryText\"\r\n                  name=\"enquiryText\"\r\n                  placeholder=\"Tell us about your requirements...\"\r\n                  className=\"min-h-[100px]\"\r\n                  value={form.enquiryText}\r\n                  onChange={handleChange}\r\n                />\r\n              </div>\r\n\r\n              <Button\r\n                type=\"submit\"\r\n                className=\"w-full md:col-span-2 mt-2\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? \"Submitting...\" : \"Create Account & Submit Enquiry\"}\r\n              </Button>\r\n              <div id=\"clerk-captcha\" />\r\n            </form>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\suspended\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\app\\test-youtube\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":142,"column":23,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5390,5420],"text":"Click &quot;Connect YouTube\" button"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5390,5420],"text":"Click &ldquo;Connect YouTube\" button"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5390,5420],"text":"Click &#34;Connect YouTube\" button"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5390,5420],"text":"Click &rdquo;Connect YouTube\" button"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":142,"column":39,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5390,5420],"text":"Click \"Connect YouTube&quot; button"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5390,5420],"text":"Click \"Connect YouTube&ldquo; button"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5390,5420],"text":"Click \"Connect YouTube&#34; button"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5390,5420],"text":"Click \"Connect YouTube&rdquo; button"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { auth } from \"@clerk/nextjs/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nexport default async function YouTubeTestPage() {\r\n  const { userId } = await auth();\r\n  \r\n  if (!userId) {\r\n    redirect(\"/sign-in\");\r\n  }\r\n\r\n  // Get user from database\r\n  const user = await prisma.user.findUnique({\r\n    where: { clerkId: userId },\r\n    select: {\r\n      email: true,\r\n      clerkId: true,\r\n      youtubeAccessToken: true,\r\n      youtubeAuthUrn: true,\r\n    },\r\n  });\r\n\r\n  // Get YouTube config\r\n  const youtubeClientId = await prisma.adminPlatformConfiguration.findFirst({\r\n    where: { key: \"YOUTUBE_CLIENT_ID\" },\r\n  });\r\n\r\n  const youtubeClientSecret = await prisma.adminPlatformConfiguration.findFirst({\r\n    where: { key: \"YOUTUBE_CLIENT_SECRET\" },\r\n  });\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-8 max-w-4xl\">\r\n      <h1 className=\"text-3xl font-bold mb-6\">YouTube OAuth Diagnostic</h1>\r\n\r\n      <div className=\"space-y-6\">\r\n        {/* User Info */}\r\n        <div className=\"border rounded-lg p-6 bg-white shadow-sm\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">User Information</h2>\r\n          <div className=\"space-y-2 font-mono text-sm\">\r\n            <div>\r\n              <span className=\"font-bold\">Email:</span> {user?.email}\r\n            </div>\r\n            <div>\r\n              <span className=\"font-bold\">Clerk ID:</span> {userId}\r\n            </div>\r\n            <div>\r\n              <span className=\"font-bold\">YouTube Access Token:</span>{\" \"}\r\n              {user?.youtubeAccessToken ? (\r\n                <span className=\"text-green-600\">\r\n                   SET ({user.youtubeAccessToken.substring(0, 30)}...)\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-red-600\"> NULL</span>\r\n              )}\r\n            </div>\r\n            <div>\r\n              <span className=\"font-bold\">YouTube Refresh Token:</span>{\" \"}\r\n              {user?.youtubeAuthUrn ? (\r\n                <span className=\"text-green-600\">\r\n                   SET ({user.youtubeAuthUrn.substring(0, 30)}...)\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-red-600\"> NULL</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* YouTube Config */}\r\n        <div className=\"border rounded-lg p-6 bg-white shadow-sm\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">YouTube Configuration</h2>\r\n          <div className=\"space-y-2 font-mono text-sm\">\r\n            <div>\r\n              <span className=\"font-bold\">Client ID:</span>{\" \"}\r\n              {youtubeClientId?.value ? (\r\n                <span className=\"text-green-600\">\r\n                   SET ({youtubeClientId.value.substring(0, 20)}...)\r\n                </span>\r\n              ) : (\r\n                <span className=\"text-red-600\"> NOT SET</span>\r\n              )}\r\n            </div>\r\n            <div>\r\n              <span className=\"font-bold\">Client Secret:</span>{\" \"}\r\n              {youtubeClientSecret?.value ? (\r\n                <span className=\"text-green-600\"> SET (hidden)</span>\r\n              ) : (\r\n                <span className=\"text-red-600\"> NOT SET</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* OAuth URLs */}\r\n        <div className=\"border rounded-lg p-6 bg-white shadow-sm\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">OAuth URLs</h2>\r\n          <div className=\"space-y-3\">\r\n            <div>\r\n              <p className=\"font-bold mb-1\">Auth URL Endpoint:</p>\r\n              <code className=\"block bg-gray-100 p-2 rounded text-sm\">\r\n                /api/socialmedia/auth-url?platform=YOUTUBE\r\n              </code>\r\n            </div>\r\n            <div>\r\n              <p className=\"font-bold mb-1\">Callback URL:</p>\r\n              <code className=\"block bg-gray-100 p-2 rounded text-sm\">\r\n                http://localhost:3000/auth-callback\r\n              </code>\r\n            </div>\r\n            <div>\r\n              <p className=\"font-bold mb-1\">State Parameter:</p>\r\n              <code className=\"block bg-gray-100 p-2 rounded text-sm\">\r\n                YOUTUBE_{userId}\r\n              </code>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Test Button */}\r\n        <div className=\"border rounded-lg p-6 bg-white shadow-sm\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Test OAuth Flow</h2>\r\n          <p className=\"text-sm text-gray-600 mb-4\">\r\n            Click the button below to initiate the YouTube OAuth flow. Check your terminal logs for detailed information.\r\n          </p>\r\n          <form action=\"/api/socialmedia/auth-url\" method=\"GET\">\r\n            <input type=\"hidden\" name=\"platform\" value=\"YOUTUBE\" />\r\n            <button\r\n              type=\"submit\"\r\n              className=\"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded\"\r\n            >\r\n               Connect YouTube\r\n            </button>\r\n          </form>\r\n        </div>\r\n\r\n        {/* Instructions */}\r\n        <div className=\"border rounded-lg p-6 bg-blue-50 border-blue-200\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Instructions</h2>\r\n          <ol className=\"list-decimal list-inside space-y-2 text-sm\">\r\n            <li>Verify that YouTube Client ID and Client Secret are set above</li>\r\n            <li>Click \"Connect YouTube\" button</li>\r\n            <li>Authorize with Google</li>\r\n            <li>Watch your terminal for logs starting with </li>\r\n            <li>After redirect, refresh this page to see if tokens are set</li>\r\n          </ol>\r\n        </div>\r\n\r\n        {/* Expected Logs */}\r\n        <div className=\"border rounded-lg p-6 bg-gray-50\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Expected Terminal Logs</h2>\r\n          <pre className=\"text-xs bg-black text-green-400 p-4 rounded overflow-x-auto\">\r\n{` OAuth Callback Received: { platform: 'YOUTUBE', stateUserId: '${userId?.substring(0, 10)}...', hasCode: true }\r\n User verified: { email: '${user?.email}' }\r\n YouTube Token Exchange - Request: { tokenUrl: '...', redirectUri: '...', clientId: '...' }\r\n YouTube Token Exchange - Response: { hasAccessToken: true, hasRefreshToken: true, expiresIn: 3600, error: undefined }\r\n YouTube Update Data: { hasAccessToken: true, hasRefreshToken: true, accessTokenLength: 200+ }\r\n Updating user: { clerkId: '${userId}', platform: 'YOUTUBE', updateFields: ['youtubeAccessToken', 'youtubeAuthUrn'] }\r\n User updated successfully: { platform: 'YOUTUBE', youtubeAccessToken: 'SET', youtubeAuthUrn: 'SET' }`}\r\n          </pre>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\AdminDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'LogOut' is defined but never used.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Home' is defined but never used.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":20,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onLogout' is defined but never used.","line":98,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onNavigate' is defined but never used.","line":98,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSearchQuery' is assigned a value but never used.","line":106,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":106,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'organisationId' is defined but never used.","line":240,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":240,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":1,"message":"Expected an assignment or function call and instead saw an expression.","line":392,"column":35,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":394,"endColumn":66},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19821,19856],"text":"\r\n              This will suspend &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19821,19856],"text":"\r\n              This will suspend &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19821,19856],"text":"\r\n              This will suspend &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19821,19856],"text":"\r\n              This will suspend &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":485,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19884,19997],"text":"&quot; and prevent users from accessing their account.\r\n              You can restore the account later.\r\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19884,19997],"text":"&ldquo; and prevent users from accessing their account.\r\n              You can restore the account later.\r\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19884,19997],"text":"&#34; and prevent users from accessing their account.\r\n              You can restore the account later.\r\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19884,19997],"text":"&rdquo; and prevent users from accessing their account.\r\n              You can restore the account later.\r\n            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":504,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20748,20783],"text":"\r\n              This will restore &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20748,20783],"text":"\r\n              This will restore &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20748,20783],"text":"\r\n              This will restore &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20748,20783],"text":"\r\n              This will restore &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":504,"column":62,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[20811,20873],"text":"&quot; and allow users to access their account again.\r\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[20811,20873],"text":"&ldquo; and allow users to access their account again.\r\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[20811,20873],"text":"&#34; and allow users to access their account again.\r\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[20811,20873],"text":"&rdquo; and allow users to access their account again.\r\n            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from './ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\r\nimport { Badge } from './ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from './ui/table';\r\nimport { Header } from '@/components/Header';\r\n\r\nimport { \r\n  Users, \r\n  DollarSign, \r\n  TrendingUp, \r\n  Activity,\r\n  LogOut,\r\n  Home,\r\n  Settings,\r\n  Search,\r\n  MoreVertical,\r\n  Plus\r\n} from 'lucide-react';\r\nimport { Input } from './ui/input';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from './ui/dropdown-menu';\r\nimport { useState } from 'react';\r\nimport { OrganisationManagementModal } from './OrganisationManagementModal';\r\nimport { OrganisationDetailsModal } from './OrganisationDetailsModal';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from './ui/alert-dialog';\r\n\r\ninterface AdminDashboardProps {\r\n  onLogout: () => void;\r\n  onNavigate: (view: 'landing' | 'admin' | 'organisation') => void;\r\n}\r\n\r\n// =============================================\r\n// TODO: REPLACE WITH REAL DATABASE CALLS\r\n// =============================================\r\n// In production, use these API calls instead of mock data:\r\n//\r\n// 1. Fetch Stats:\r\n//    const { data } = await fetch('/api/dashboard/stats').then(r => r.json())\r\n//\r\n// 2. Fetch Organisations:\r\n//    const { organisations } = await fetch('/api/organisations').then(r => r.json())\r\n//\r\n// 3. Fetch Activity:\r\n//    const { activities } = await fetch('/api/activities').then(r => r.json())\r\n//\r\n// Use React Query or SWR for better data management:\r\n// import useSWR from 'swr'\r\n// const { data, error, isLoading } = useSWR('/api/organisations', fetcher)\r\n// =============================================\r\n\r\n// Mock data - In production, this would come from Prisma + Neon database\r\nconst mockStats = {\r\n  totalRevenue: 2459800,\r\n  totalUsers: 1234,\r\n  activeSubscriptions: 856,\r\n  growthRate: 23.5\r\n};\r\n\r\ninterface Organisation {\r\n  id: number;\r\n  name: string;\r\n  email: string;\r\n  plan: string;\r\n  status: string;\r\n  mrr: number;\r\n  joinedAt: string;\r\n}\r\n\r\nconst initialMockOrganisations: Organisation[] = [\r\n  { id: 1, name: 'Acme Corp', email: 'admin@acme.com', plan: 'Enterprise', status: 'active', mrr: 9999, joinedAt: '2024-01-15' },\r\n  { id: 2, name: 'TechStart Inc', email: 'hello@techstart.com', plan: 'Professional', status: 'active', mrr: 2999, joinedAt: '2024-02-20' },\r\n  { id: 3, name: 'Creative Studio', email: 'info@creative.com', plan: 'Professional', status: 'trial', mrr: 0, joinedAt: '2024-11-15' },\r\n  { id: 4, name: 'Global Services', email: 'contact@global.com', plan: 'Enterprise', status: 'active', mrr: 9999, joinedAt: '2024-03-10' },\r\n  { id: 5, name: 'Startup Hub', email: 'team@startuphub.com', plan: 'Professional', status: 'suspended', mrr: 2999, joinedAt: '2024-04-05' },\r\n];\r\n\r\nconst mockRecentActivity = [\r\n  { id: 1, action: 'New subscription', user: 'Creative Studio', timestamp: '2 hours ago' },\r\n  { id: 2, action: 'Payment received', user: 'Acme Corp', timestamp: '5 hours ago' },\r\n  { id: 3, action: 'Plan upgraded', user: 'TechStart Inc', timestamp: '1 day ago' },\r\n  { id: 4, action: 'New user signup', user: 'Startup Hub', timestamp: '2 days ago' },\r\n];\r\n\r\nexport function AdminDashboard({ onLogout, onNavigate }: AdminDashboardProps) {\r\n  const [organisations, setOrganisations] = useState<Organisation[]>(initialMockOrganisations);\r\n  const [selectedOrganisation, setSelectedOrganisation] = useState<Organisation | null>(null);\r\n  const [showManagementModal, setShowManagementModal] = useState(false);\r\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\r\n  const [modalMode, setModalMode] = useState<'add' | 'edit'>('add');\r\n  const [showSuspendDialog, setShowSuspendDialog] = useState(false);\r\n  const [showRestoreDialog, setShowRestoreDialog] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n\r\n  // =============================================\r\n  // TODO: ADD REAL DATA FETCHING\r\n  // =============================================\r\n  // Replace mock data with real API calls:\r\n  //\r\n  // useEffect(() => {\r\n  //   async function fetchData() {\r\n  //     const [statsRes, organisationsRes, activityRes] = await Promise.all([\r\n  //       fetch('/api/dashboard/stats'),\r\n  //       fetch('/api/admin/organisations'),\r\n  //       fetch('/api/activities')\r\n  //     ])\r\n  //     \r\n  //     setStats(await statsRes.json())\r\n  //     setOrganisations(await organisationsRes.json())\r\n  //     setActivity(await activityRes.json())\r\n  //   }\r\n  //   fetchData()\r\n  // }, [])\r\n  // =============================================\r\n\r\n  // =============================================\r\n  // ACTION HANDLERS\r\n  // =============================================\r\n  \r\n  const handleAddOrganisation = () => {\r\n    setSelectedOrganisation(null);\r\n    setModalMode('add');\r\n    setShowManagementModal(true);\r\n  };\r\n\r\n  const handleEditOrganisation = (organisation: Organisation) => {\r\n    setSelectedOrganisation(organisation);\r\n    setModalMode('edit');\r\n    setShowManagementModal(true);\r\n  };\r\n\r\n  const handleViewDetails = (organisation: Organisation) => {\r\n    setSelectedOrganisation(organisation);\r\n    setShowDetailsModal(true);\r\n  };\r\n\r\n  const handleSaveOrganisation = async (organisationData: Partial<Organisation>) => {\r\n    // =============================================\r\n    // TODO: REPLACE WITH REAL API CALL\r\n    // =============================================\r\n    // if (modalMode === 'add') {\r\n    //   const response = await fetch('/api/admin/organisations', {\r\n    //     method: 'POST',\r\n    //     headers: { 'Content-Type': 'application/json' },\r\n    //     body: JSON.stringify(organisationData)\r\n    //   });\r\n    //   const newOrganisation = await response.json();\r\n    //   setOrganisations([...organisations, newOrganisation]);\r\n    // } else if (selectedOrganisation) {\r\n    //   const response = await fetch(`/api/admin/organisations/${selectedOrganisation.id}`, {\r\n    //     method: 'PATCH',\r\n    //     headers: { 'Content-Type': 'application/json' },\r\n    //     body: JSON.stringify(organisationData)\r\n    //   });\r\n    //   const updatedOrganisation = await response.json();\r\n    //   setOrganisations(organisations.map(t => t.id === selectedOrganisation.id ? updatedOrganisation : t));\r\n    // }\r\n    // =============================================\r\n\r\n    // Mock implementation\r\n    if (modalMode === 'add') {\r\n      const newOrganisation: Organisation = {\r\n        id: Math.max(...organisations.map(t => t.id)) + 1,\r\n        name: organisationData.name || '',\r\n        email: organisationData.email || '',\r\n        plan: organisationData.plan || 'Professional',\r\n        status: organisationData.status || 'trial',\r\n        mrr: organisationData.plan === 'Professional' ? 2999 : organisationData.plan === 'Enterprise' ? 9999 : 0,\r\n        joinedAt: new Date().toISOString().split('T')[0],\r\n      };\r\n      setOrganisations([...organisations, newOrganisation]);\r\n    } else if (selectedOrganisation) {\r\n      setOrganisations(organisations.map(t => \r\n        t.id === selectedOrganisation.id \r\n          ? { ...t, ...organisationData }\r\n          : t\r\n      ));\r\n    }\r\n  };\r\n\r\n  const handleSuspendOrganisation = async () => {\r\n    if (!selectedOrganisation) return;\r\n\r\n    // =============================================\r\n    // TODO: REPLACE WITH REAL API CALL\r\n    // =============================================\r\n    // await fetch(`/api/admin/organisations/${selectedOrganisation.id}`, {\r\n    //   method: 'PATCH',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({ status: 'suspended' })\r\n    // });\r\n    // =============================================\r\n\r\n    setOrganisations(organisations.map(t => \r\n      t.id === selectedOrganisation.id \r\n        ? { ...t, status: 'suspended' }\r\n        : t\r\n    ));\r\n    setShowSuspendDialog(false);\r\n    setShowDetailsModal(false);\r\n    setSelectedOrganisation(null);\r\n  };\r\n\r\n  const handleRestoreOrganisation = async () => {\r\n    if (!selectedOrganisation) return;\r\n\r\n    // =============================================\r\n    // TODO: REPLACE WITH REAL API CALL\r\n    // =============================================\r\n    // await fetch(`/api/admin/organisations/${selectedOrganisation.id}`, {\r\n    //   method: 'PATCH',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({ status: 'active' })\r\n    // });\r\n    // =============================================\r\n\r\n    setOrganisations(organisations.map(t => \r\n      t.id === selectedOrganisation.id \r\n        ? { ...t, status: 'active' }\r\n        : t\r\n    ));\r\n    setShowRestoreDialog(false);\r\n    setShowDetailsModal(false);\r\n    setSelectedOrganisation(null);\r\n  };\r\n\r\n  const handleSendEmail = async (organisationId: number) => {\r\n    // =============================================\r\n    // TODO: IMPLEMENT EMAIL FUNCTIONALITY\r\n    // =============================================\r\n    // await fetch(`/api/admin/organisations/${organisationId}/send-email`, {\r\n    //   method: 'POST',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({ \r\n    //     subject: 'Message from Admin',\r\n    //     template: 'admin-message'\r\n    //   })\r\n    // });\r\n    // =============================================\r\n    alert('Email functionality would be implemented here');\r\n  };\r\n\r\n  // Filter organisations based on search\r\n  const filteredOrganisations = organisations.filter(organisation =>\r\n    organisation.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    organisation.email.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-muted/30\">\r\n      {/* Header */}\r\n     <Header />\r\n\r\n      <div className=\"p-6 max-w-7xl mx-auto\">\r\n        {/* Stats Overview */}\r\n        <div className=\"grid gap-4 md:grid-cols-4 mb-6\">\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n              <CardTitle className=\"text-sm\">Total Revenue</CardTitle>\r\n              <DollarSign className=\"size-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl\">{mockStats.totalRevenue.toLocaleString()}</div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                +{mockStats.growthRate}% from last month\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n              <CardTitle className=\"text-sm\">Total Users</CardTitle>\r\n              <Users className=\"size-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl\">{mockStats.totalUsers}</div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                +180 from last month\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n              <CardTitle className=\"text-sm\">Active Subscriptions</CardTitle>\r\n              <Activity className=\"size-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl\">{mockStats.activeSubscriptions}</div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                +12% conversion rate\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n              <CardTitle className=\"text-sm\">Growth Rate</CardTitle>\r\n              <TrendingUp className=\"size-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl\">{mockStats.growthRate}%</div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                +5.2% from last month\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <Tabs defaultValue=\"organisations\" className=\"space-y-4\">\r\n          <TabsList>\r\n            <TabsTrigger value=\"organisations\">Organisations</TabsTrigger>\r\n            <TabsTrigger value=\"activity\">Recent Activity</TabsTrigger>\r\n            <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"organisations\" className=\"space-y-4\">\r\n            <Card>\r\n              <CardHeader>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <CardTitle>All Organisations</CardTitle>\r\n                    <CardDescription>\r\n                      Manage and monitor all organisation accounts\r\n                    </CardDescription>\r\n                  </div>\r\n                  <Button onClick={handleAddOrganisation}>\r\n                    <Plus className=\"size-4 mr-2\" />\r\n                    Add Organisation\r\n                  </Button>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <Table>\r\n                  <TableHeader>\r\n                    <TableRow>\r\n                      <TableHead>Organization</TableHead>\r\n                      <TableHead>Email</TableHead>\r\n                      <TableHead>Plan</TableHead>\r\n                      <TableHead>Status</TableHead>\r\n                      <TableHead>MRR</TableHead>\r\n                      <TableHead>Joined</TableHead>\r\n                      <TableHead></TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {filteredOrganisations.map((organisation) => (\r\n                      <TableRow key={organisation.id}>\r\n                        <TableCell>{organisation.name}</TableCell>\r\n                        <TableCell className=\"text-muted-foreground\">{organisation.email}</TableCell>\r\n                        <TableCell>\r\n                          <Badge variant={organisation.plan === 'Enterprise' ? 'default' : 'secondary'}>\r\n                            {organisation.plan}\r\n                          </Badge>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <Badge variant={organisation.status === 'active' ? 'default' : 'outline'}>\r\n                            {organisation.status}\r\n                          </Badge>\r\n                        </TableCell>\r\n                        <TableCell>{organisation.mrr.toLocaleString()}</TableCell>\r\n                        <TableCell className=\"text-muted-foreground\">{organisation.joinedAt}</TableCell>\r\n                        <TableCell>\r\n                          <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                              <Button variant=\"ghost\" size=\"icon\">\r\n                                <MoreVertical className=\"size-4\" />\r\n                              </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"end\">\r\n                              <DropdownMenuItem onClick={() => handleViewDetails(organisation)}>View Details</DropdownMenuItem>\r\n                              <DropdownMenuItem onClick={() => handleEditOrganisation(organisation)}>Edit Plan</DropdownMenuItem>\r\n                              <DropdownMenuItem onClick={() => handleSendEmail(organisation.id)}>Send Email</DropdownMenuItem>\r\n                              <DropdownMenuItem \r\n                                className=\"text-destructive\" \r\n                                onClick={() => {\r\n                                  setSelectedOrganisation(organisation);\r\n                                  organisation.status === 'suspended' \r\n                                    ? setShowRestoreDialog(true) \r\n                                    : setShowSuspendDialog(true);\r\n                                }}\r\n                              >\r\n                                {organisation.status === 'suspended' ? 'Restore Account' : 'Suspend Account'}\r\n                              </DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                          </DropdownMenu>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"activity\" className=\"space-y-4\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Recent Activity</CardTitle>\r\n                <CardDescription>\r\n                  Latest actions and events across all organisations\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {mockRecentActivity.map((activity) => (\r\n                    <div key={activity.id} className=\"flex items-center justify-between py-3 border-b last:border-0\">\r\n                      <div>\r\n                        <p>{activity.action}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">{activity.user}</p>\r\n                      </div>\r\n                      <span className=\"text-sm text-muted-foreground\">{activity.timestamp}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"analytics\" className=\"space-y-4\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Analytics Dashboard</CardTitle>\r\n                <CardDescription>\r\n                  Detailed metrics and insights (Chart visualization would go here)\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"h-64 flex items-center justify-center text-muted-foreground\">\r\n                <div className=\"text-center\">\r\n                  <TrendingUp className=\"size-12 mx-auto mb-4\" />\r\n                  <p>Advanced analytics charts would be displayed here</p>\r\n                  <p className=\"text-sm\">Using Recharts or similar charting library</p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      {showManagementModal && (\r\n        <OrganisationManagementModal\r\n          isOpen={showManagementModal}\r\n          organisation={selectedOrganisation}\r\n          mode={modalMode}\r\n          onClose={() => {\r\n            setShowManagementModal(false);\r\n            setSelectedOrganisation(null);\r\n          }}\r\n          onSave={handleSaveOrganisation}\r\n        />\r\n      )}\r\n\r\n      {showDetailsModal && selectedOrganisation && (\r\n        <OrganisationDetailsModal\r\n          isOpen={showDetailsModal}\r\n          organisation={selectedOrganisation}\r\n          onClose={() => {\r\n            setShowDetailsModal(false);\r\n            setSelectedOrganisation(null);\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Suspend Confirmation Dialog */}\r\n      <AlertDialog open={showSuspendDialog} onOpenChange={setShowSuspendDialog}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Suspend Organisation Account?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              This will suspend \"{selectedOrganisation?.name}\" and prevent users from accessing their account.\r\n              You can restore the account later.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleSuspendOrganisation} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\r\n              Suspend Account\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Restore Confirmation Dialog */}\r\n      <AlertDialog open={showRestoreDialog} onOpenChange={setShowRestoreDialog}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Restore Organisation Account?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              This will restore \"{selectedOrganisation?.name}\" and allow users to access their account again.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleRestoreOrganisation}>\r\n              Restore Account\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Zap' is defined but never used.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":13},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":15,"column":21,"nodeType":"JSXOpeningElement","endLine":15,"endColumn":102}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useRouter } from 'next/navigation';\r\nimport { Button } from '@/components/ui/button';\r\nimport { SignedIn, UserButton } from '@clerk/clerk-react';\r\nimport { Zap, Home, Bell } from 'lucide-react';\r\n\r\nexport function Header() {\r\n    const router = useRouter();\r\n\r\n    return (\r\n        <header className=\"sticky top-0 z-40 border-b bg-background\">\r\n            <div className=\"flex h-16 items-center gap-4 px-6\">\r\n                <div className=\"flex items-center gap-2 font-semibold\">\r\n                    <img src=\"/logo-1.png\" alt=\"CampZeo\" style={{ width: '100%', height: '50px' }} />\r\n                </div>\r\n                <div className=\"flex-1\" />\r\n                <Button variant=\"ghost\" size=\"icon\" onClick={() => router.push('/')}>\r\n                    <Home className=\"size-5\" />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"icon\">\r\n                    <Bell className=\"size-5\" />\r\n                </Button>\r\n                <SignedIn>\r\n                    <UserButton />\r\n                </SignedIn>\r\n            </div>\r\n        </header>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\LandingPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onNavigate' is defined but never used.","line":78,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from './ui/button';\r\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from './ui/card';\r\nimport { Badge } from './ui/badge';\r\nimport { Check, Zap, Shield, BarChart3, Users, Star, ArrowRight } from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport { PaymentModal } from './PaymentModal';\r\nimport { SignInButton, SignUpButton, SignedOut, SignedIn, UserButton } from '@clerk/clerk-react';\r\n\r\ninterface LandingPageProps {\r\n  onLogin: (role: 'admin' | 'organisation') => void;\r\n  onNavigate: (view: 'landing' | 'admin' | 'organisation') => void;\r\n}\r\n\r\ntype Plan = {\r\n  name: string;\r\n  price: number;\r\n  period: string;\r\n  description: string;\r\n  features: string[];\r\n  isTrial?: boolean;\r\n  isPopular?: boolean;\r\n  priceId?: string;\r\n};\r\n\r\nconst plans: Plan[] = [\r\n  {\r\n    name: 'Free Trial',\r\n    price: 0,\r\n    period: '14 days',\r\n    description: 'Try all features for free',\r\n    isTrial: true,\r\n    features: [\r\n      'Up to 5 users',\r\n      'Basic analytics',\r\n      'Email support',\r\n      'Core features access',\r\n      '5GB storage',\r\n      'Community support'\r\n    ]\r\n  },\r\n  {\r\n    name: 'Professional',\r\n    price: 2999,\r\n    period: 'month',\r\n    description: 'Perfect for growing teams',\r\n    isPopular: true,\r\n    priceId: 'plan_pro_monthly',\r\n    features: [\r\n      'Unlimited users',\r\n      'Advanced analytics',\r\n      'Priority support',\r\n      'All features unlocked',\r\n      '100GB storage',\r\n      'Custom integrations',\r\n      'API access',\r\n      'White-label options'\r\n    ]\r\n  },\r\n  {\r\n    name: 'Enterprise',\r\n    price: 9999,\r\n    period: 'month',\r\n    description: 'For large organizations',\r\n    priceId: 'plan_enterprise_monthly',\r\n    features: [\r\n      'Everything in Professional',\r\n      'Dedicated account manager',\r\n      '24/7 phone support',\r\n      'Custom SLA',\r\n      'Unlimited storage',\r\n      'Advanced security',\r\n      'Custom contracts',\r\n      'On-premise deployment option'\r\n    ]\r\n  }\r\n];\r\n\r\nexport function LandingPage({ onLogin, onNavigate }: LandingPageProps) {\r\n  const [selectedPlan, setSelectedPlan] = useState<Plan | null>(null);\r\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n\r\n  const handlePlanSelect = (plan: Plan) => {\r\n    if (plan.isTrial) {\r\n      // =============================================\r\n      // TODO: REPLACE WITH CLERK SIGN UP\r\n      // =============================================\r\n      // In production, redirect to Clerk sign-up with trial metadata:\r\n      //\r\n      // import { useSignUp } from '@clerk/nextjs'\r\n      // const { signUp } = useSignUp()\r\n      // \r\n      // await signUp.create({\r\n      //   emailAddress: email,\r\n      //   password: password,\r\n      //   unsafeMetadata: {\r\n      //     plan: 'FREE_TRIAL',\r\n      //     trialEndsAt: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000)\r\n      //   }\r\n      // })\r\n      //\r\n      // Then in Clerk webhook, create organisation with trial:\r\n      // await prisma.organisation.create({\r\n      //   data: {\r\n      //     plan: 'FREE_TRIAL',\r\n      //     status: 'TRIAL',\r\n      //     trialEndsAt: userData.unsafeMetadata.trialEndsAt\r\n      //   }\r\n      // })\r\n      // =============================================\r\n      \r\n      // Start free trial - mock Clerk signup\r\n      alert('Starting free trial! You would be redirected to sign up with Clerk.');\r\n      // In production: Redirect to Clerk sign-up with trial metadata\r\n      onLogin('organisation');\r\n    } else {\r\n      // Show payment modal for paid plans\r\n      setSelectedPlan(plan);\r\n      setShowPaymentModal(true);\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = () => {\r\n    // =============================================\r\n    // TODO: HANDLE SUCCESSFUL PAYMENT\r\n    // =============================================\r\n    // After successful payment verification:\r\n    // 1. Backend has already created/updated organisation in database\r\n    // 2. Backend has recorded payment in Payment table\r\n    // 3. Backend has logged activity\r\n    // 4. Now redirect user to dashboard\r\n    //\r\n    // The payment verification API should return:\r\n    // { success: true, organisation: {...}, redirectUrl: '/dashboard' }\r\n    // =============================================\r\n    \r\n    setShowPaymentModal(false);\r\n    // Mock successful payment and account creation\r\n    alert('Payment successful! Your account has been created.');\r\n    onLogin('organisation');\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen\">\r\n      {/* Navigation */}\r\n      <nav className=\"fixed top-0 w-full bg-background/80 backdrop-blur-md border-b z-50\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex justify-between items-center h-16\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Zap className=\"size-8 text-primary\" />\r\n              <span className=\"font-semibold\">SaaSify</span>\r\n            </div>\r\n            <div className=\"hidden md:flex items-center gap-8\">\r\n              <a href=\"#features\" className=\"text-muted-foreground hover:text-foreground\">\r\n                Features\r\n              </a>\r\n              <a href=\"#pricing\" className=\"text-muted-foreground hover:text-foreground\">\r\n                Pricing\r\n              </a>\r\n              <a href=\"#about\" className=\"text-muted-foreground hover:text-foreground\">\r\n                About\r\n              </a>\r\n            </div>\r\n            <div className=\"flex items-center gap-4\">\r\n              <SignedOut>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <SignUpButton>\r\n                    <button className=\"px-3 py-2 text-primary border border-primary rounded-md hover:bg-primary/10\">\r\n                      Sign Up\r\n                    </button>\r\n                  </SignUpButton>\r\n\r\n                  <SignInButton>\r\n                    <button className=\"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90\">\r\n                      Sign In\r\n                    </button>\r\n                  </SignInButton>\r\n                </div>\r\n              </SignedOut>\r\n              \r\n              <SignedIn>\r\n                <UserButton />\r\n              </SignedIn>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* Hero Section */}\r\n      <section className=\"pt-32 pb-20 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-7xl mx-auto text-center\">\r\n          <Badge variant=\"secondary\" className=\"mb-4\">\r\n             Now with AI-powered insights\r\n          </Badge>\r\n          <h1 className=\"mb-6 max-w-4xl mx-auto\">\r\n            The Complete SaaS Platform for Modern Teams\r\n          </h1>\r\n          <p className=\"text-muted-foreground mb-8 max-w-2xl mx-auto\">\r\n            Streamline your workflow, boost productivity, and scale your business with our all-in-one platform. \r\n            Start your free 14-day trial today, no credit card required.\r\n          </p>\r\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\r\n            <Button size=\"lg\" onClick={() => handlePlanSelect(plans[0])}>\r\n              Start Free Trial\r\n              <ArrowRight className=\"ml-2 size-4\" />\r\n            </Button>\r\n            <Button size=\"lg\" variant=\"outline\" onClick={() => document.getElementById('pricing')?.scrollIntoView({ behavior: 'smooth' })}>\r\n              View Pricing\r\n            </Button>\r\n          </div>\r\n          <div className=\"mt-16 flex justify-center gap-8 text-sm text-muted-foreground\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              14-day free trial\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              No credit card required\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"size-4 text-green-500\" />\r\n              Cancel anytime\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Features Section */}\r\n      <section id=\"features\" className=\"py-20 px-4 sm:px-6 lg:px-8 bg-muted/30\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          <div className=\"text-center mb-16\">\r\n            <h2 className=\"mb-4\">Powerful Features for Every Team</h2>\r\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\r\n              Everything you need to manage, scale, and optimize your business operations\r\n            </p>\r\n          </div>\r\n          <div className=\"grid md:grid-cols-3 gap-8\">\r\n            <Card>\r\n              <CardHeader>\r\n                <BarChart3 className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Advanced Analytics</CardTitle>\r\n                <CardDescription>\r\n                  Get deep insights into your business metrics with real-time dashboards and custom reports\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader>\r\n                <Shield className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Enterprise Security</CardTitle>\r\n                <CardDescription>\r\n                  Bank-level encryption, SOC 2 compliance, and advanced access controls to keep your data safe\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader>\r\n                <Users className=\"size-12 text-primary mb-4\" />\r\n                <CardTitle>Team Collaboration</CardTitle>\r\n                <CardDescription>\r\n                  Work seamlessly with your team using shared workspaces, comments, and real-time updates\r\n                </CardDescription>\r\n              </CardHeader>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Pricing Section */}\r\n      <section id=\"pricing\" className=\"py-20 px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n          <div className=\"text-center mb-16\">\r\n            <h2 className=\"mb-4\">Simple, Transparent Pricing</h2>\r\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\r\n              Choose the perfect plan for your needs. Start with a free trial or go straight to a paid plan.\r\n            </p>\r\n          </div>\r\n          <div className=\"grid md:grid-cols-3 gap-8\">\r\n            {plans.map((plan) => (\r\n              <Card \r\n                key={plan.name}\r\n                className={`relative ${plan.isPopular ? 'border-primary shadow-lg' : ''}`}\r\n              >\r\n                {plan.isPopular && (\r\n                  <div className=\"absolute -top-4 left-1/2 -translate-x-1/2\">\r\n                    <Badge className=\"gap-1\">\r\n                      <Star className=\"size-3\" />\r\n                      Most Popular\r\n                    </Badge>\r\n                  </div>\r\n                )}\r\n                <CardHeader>\r\n                  <CardTitle>{plan.name}</CardTitle>\r\n                  <CardDescription>{plan.description}</CardDescription>\r\n                  <div className=\"mt-4\">\r\n                    <span className=\"text-4xl\">\r\n                      {plan.price === 0 ? 'Free' : `${plan.price}`}\r\n                    </span>\r\n                    {plan.price > 0 && (\r\n                      <span className=\"text-muted-foreground\">/{plan.period}</span>\r\n                    )}\r\n                    {plan.isTrial && (\r\n                      <span className=\"text-muted-foreground\"> for {plan.period}</span>\r\n                    )}\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <ul className=\"space-y-3\">\r\n                    {plan.features.map((feature, index) => (\r\n                      <li key={index} className=\"flex items-start gap-2\">\r\n                        <Check className=\"size-5 text-green-500 shrink-0 mt-0.5\" />\r\n                        <span className=\"text-sm\">{feature}</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </CardContent>\r\n                <CardFooter>\r\n                  <Button \r\n                    className=\"w-full\" \r\n                    variant={plan.isPopular ? 'default' : 'outline'}\r\n                    onClick={() => handlePlanSelect(plan)}\r\n                  >\r\n                    {plan.isTrial ? 'Start Free Trial' : 'Purchase Now'}\r\n                  </Button>\r\n                </CardFooter>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n\r\n      <section className=\"py-20 px-4 sm:px-6 lg:px-8 bg-primary text-primary-foreground\">\r\n        <div className=\"max-w-4xl mx-auto text-center\">\r\n          <h2 className=\"mb-4 text-primary-foreground\">Ready to Get Started?</h2>\r\n          <p className=\"mb-8 text-primary-foreground/90\">\r\n            Join thousands of teams already using SaaSify to streamline their operations\r\n          </p>\r\n          <Button size=\"lg\" variant=\"secondary\" onClick={() => handlePlanSelect(plans[0])}>\r\n            Start Your Free Trial\r\n            <ArrowRight className=\"ml-2 size-4\" />\r\n          </Button>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Footer */}\r\n      <footer className=\"py-12 px-4 sm:px-6 lg:px-8 border-t\">\r\n        <div className=\"max-w-7xl mx-auto text-center text-muted-foreground text-sm\">\r\n          <div className=\"flex items-center justify-center gap-2 mb-4\">\r\n            <Zap className=\"size-6 text-primary\" />\r\n            <span className=\"font-semibold text-foreground\">SaaSify</span>\r\n          </div>\r\n          <p> 2025 SaaSify. All rights reserved.</p>\r\n        </div>\r\n      </footer>\r\n\r\n      {/* Payment Modal */}\r\n      {showPaymentModal && selectedPlan && (\r\n        <PaymentModal\r\n          plan={selectedPlan}\r\n          onClose={() => setShowPaymentModal(false)}\r\n          onSuccess={handlePaymentSuccess}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\OrganisationDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Home' is defined but never used.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":10,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SignedIn' is defined but never used.","line":15,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserButton' is defined but never used.","line":15,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onLogout' is defined but never used.","line":52,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onNavigate' is defined but never used.","line":52,"column":51,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":61},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":92,"column":21,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[3145,3226],"text":"\r\n                Here&apos;s what's happening with your account today\r\n              "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[3145,3226],"text":"\r\n                Here&lsquo;s what's happening with your account today\r\n              "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[3145,3226],"text":"\r\n                Here&#39;s what's happening with your account today\r\n              "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[3145,3226],"text":"\r\n                Here&rsquo;s what's happening with your account today\r\n              "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":92,"column":28,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[3145,3226],"text":"\r\n                Here's what&apos;s happening with your account today\r\n              "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[3145,3226],"text":"\r\n                Here's what&lsquo;s happening with your account today\r\n              "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[3145,3226],"text":"\r\n                Here's what&#39;s happening with your account today\r\n              "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[3145,3226],"text":"\r\n                Here's what&rsquo;s happening with your account today\r\n              "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from './ui/button';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\r\nimport { Badge } from './ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\r\nimport { Progress } from './ui/progress';\r\nimport {\r\n  Users,\r\n  CreditCard,\r\n  Home,\r\n  Bell,\r\n  BarChart3,\r\n  Zap\r\n} from 'lucide-react';\r\nimport { Avatar, AvatarFallback } from './ui/avatar';\r\nimport { SignedIn, UserButton } from '@clerk/clerk-react';\r\nimport { Sidebar } from './Sidebar';\r\nimport { Header } from '@/components/Header';\r\n\r\n\r\ninterface OrganisationDashboardProps {\r\n  onLogout: () => void;\r\n  onNavigate: (view: 'landing' | 'admin' | 'organisation') => void;\r\n}\r\n\r\n// Mock organisation data - In production, this would come from Prisma + Neon\r\nconst mockOrganisation = {\r\n  name: 'Acme Corp',\r\n  email: 'admin@acme.com',\r\n  plan: 'Professional',\r\n  status: 'active',\r\n  trialEndsAt: null,\r\n  storageUsed: 45,\r\n  storageLimit: 100,\r\n  usersCount: 12,\r\n  usersLimit: 50,\r\n  nextBillingDate: '2025-01-15',\r\n  nextBillingAmount: 2999\r\n};\r\n\r\nconst mockTeamMembers = [\r\n  { id: 1, name: 'John Doe', email: 'john@acme.com', role: 'Admin', status: 'active' },\r\n  { id: 2, name: 'Jane Smith', email: 'jane@acme.com', role: 'Member', status: 'active' },\r\n  { id: 3, name: 'Bob Johnson', email: 'bob@acme.com', role: 'Member', status: 'active' },\r\n];\r\n\r\nconst mockRecentActivity = [\r\n  { id: 1, action: 'Document uploaded', user: 'John Doe', timestamp: '2 hours ago' },\r\n  { id: 2, action: 'Team member invited', user: 'Jane Smith', timestamp: '5 hours ago' },\r\n  { id: 3, action: 'Settings updated', user: 'John Doe', timestamp: '1 day ago' },\r\n];\r\n\r\nexport function OrganisationDashboard({ onLogout, onNavigate }: OrganisationDashboardProps) {\r\n  // =============================================\r\n  // TODO: ADD ACTION HANDLERS FOR DATABASE OPERATIONS\r\n  // =============================================\r\n  const handleInviteMember = () => {\r\n    // In production:\r\n    // await fetch('/api/team/invite', {\r\n    //   method: 'POST',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({ email, role })\r\n    // })\r\n    alert('Invite member functionality would open a modal here');\r\n  };\r\n\r\n  const handleManageBilling = () => {\r\n    // In production:\r\n    // Navigate to Razorpay billing portal or show billing modal\r\n    // const response = await fetch('/api/billing/portal')\r\n    // const { url } = await response.json()\r\n    // window.location.href = url\r\n    alert('Manage billing functionality would be implemented here');\r\n  };\r\n  // =============================================\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-muted/30\">\r\n      {/* Header */}\r\n      <Header/>\r\n\r\n      <div className=\"flex\">\r\n        {/* Sidebar */}\r\n        <Sidebar />\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 p-6\">\r\n          <div className=\"max-w-6xl mx-auto space-y-6\">\r\n            {/* Welcome Section */}\r\n            <div>\r\n              <h1>Welcome back, {mockOrganisation.name}</h1>\r\n              <p className=\"text-muted-foreground\">\r\n                Here's what's happening with your account today\r\n              </p>\r\n            </div>\r\n\r\n            {/* Plan Status Banner */}\r\n            <Card className=\"bg-primary text-primary-foreground\">\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                      <h3 className=\"text-primary-foreground\">{mockOrganisation.plan} Plan</h3>\r\n                      <Badge variant=\"secondary\">Active</Badge>\r\n                    </div>\r\n                    <p className=\"text-primary-foreground/80\">\r\n                      Next billing: {mockOrganisation.nextBillingDate}  {mockOrganisation.nextBillingAmount}\r\n                    </p>\r\n                  </div>\r\n                  <Button variant=\"secondary\" onClick={handleManageBilling}>\r\n                    <CreditCard className=\"size-4 mr-2\" />\r\n                    Manage Billing\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid gap-4 md:grid-cols-3\">\r\n              <Card>\r\n                <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                  <CardTitle className=\"text-sm\">Team Members</CardTitle>\r\n                  <Users className=\"size-4 text-muted-foreground\" />\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl\">{mockOrganisation.usersCount}</div>\r\n                  <Progress value={(mockOrganisation.usersCount / mockOrganisation.usersLimit) * 100} className=\"mt-2\" />\r\n                  <p className=\"text-xs text-muted-foreground mt-2\">\r\n                    {mockOrganisation.usersCount} of {mockOrganisation.usersLimit} users\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                  <CardTitle className=\"text-sm\">Storage Used</CardTitle>\r\n                  <BarChart3 className=\"size-4 text-muted-foreground\" />\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl\">{mockOrganisation.storageUsed}GB</div>\r\n                  <Progress value={mockOrganisation.storageUsed} className=\"mt-2\" />\r\n                  <p className=\"text-xs text-muted-foreground mt-2\">\r\n                    {mockOrganisation.storageUsed} of {mockOrganisation.storageLimit}GB used\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n                  <CardTitle className=\"text-sm\">API Calls</CardTitle>\r\n                  <Zap className=\"size-4 text-muted-foreground\" />\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-2xl\">12,450</div>\r\n                  <Progress value={62} className=\"mt-2\" />\r\n                  <p className=\"text-xs text-muted-foreground mt-2\">\r\n                    62% of monthly limit\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Tabs Content */}\r\n            <Tabs defaultValue=\"activity\" className=\"space-y-4\">\r\n              <TabsList>\r\n                <TabsTrigger value=\"activity\">Recent Activity</TabsTrigger>\r\n                <TabsTrigger value=\"team\">Team Members</TabsTrigger>\r\n                <TabsTrigger value=\"usage\">Usage Details</TabsTrigger>\r\n              </TabsList>\r\n\r\n              <TabsContent value=\"activity\" className=\"space-y-4\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>Recent Activity</CardTitle>\r\n                    <CardDescription>\r\n                      Latest actions in your workspace\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-4\">\r\n                      {mockRecentActivity.map((activity) => (\r\n                        <div key={activity.id} className=\"flex items-center justify-between py-3 border-b last:border-0\">\r\n                          <div>\r\n                            <p>{activity.action}</p>\r\n                            <p className=\"text-sm text-muted-foreground\">{activity.user}</p>\r\n                          </div>\r\n                          <span className=\"text-sm text-muted-foreground\">{activity.timestamp}</span>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"team\" className=\"space-y-4\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <CardTitle>Team Members</CardTitle>\r\n                        <CardDescription>\r\n                          Manage your team members and their roles\r\n                        </CardDescription>\r\n                      </div>\r\n                      <Button onClick={handleInviteMember}>\r\n                        <Users className=\"size-4 mr-2\" />\r\n                        Invite Member\r\n                      </Button>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-4\">\r\n                      {mockTeamMembers.map((member) => (\r\n                        <div key={member.id} className=\"flex items-center justify-between py-3 border-b last:border-0\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <Avatar>\r\n                              <AvatarFallback>{member.name.split(' ').map(n => n[0]).join('')}</AvatarFallback>\r\n                            </Avatar>\r\n                            <div>\r\n                              <p>{member.name}</p>\r\n                              <p className=\"text-sm text-muted-foreground\">{member.email}</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Badge variant=\"secondary\">{member.role}</Badge>\r\n                            <Button variant=\"ghost\" size=\"sm\">Edit</Button>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"usage\" className=\"space-y-4\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle>Usage Details</CardTitle>\r\n                    <CardDescription>\r\n                      Detailed breakdown of your usage and limits\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-6\">\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>Storage</span>\r\n                          <span className=\"text-muted-foreground\">{mockOrganisation.storageUsed}/{mockOrganisation.storageLimit}GB</span>\r\n                        </div>\r\n                        <Progress value={mockOrganisation.storageUsed} />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>Team Members</span>\r\n                          <span className=\"text-muted-foreground\">{mockOrganisation.usersCount}/{mockOrganisation.usersLimit}</span>\r\n                        </div>\r\n                        <Progress value={(mockOrganisation.usersCount / mockOrganisation.usersLimit) * 100} />\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"flex justify-between mb-2\">\r\n                          <span>API Calls</span>\r\n                          <span className=\"text-muted-foreground\">12,450/20,000</span>\r\n                        </div>\r\n                        <Progress value={62} />\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\OrganisationDetailsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":6,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Database' is defined but never used.","line":6,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Header' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';\r\nimport { Button } from './ui/button';\r\nimport { Badge } from './ui/badge';\r\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\r\nimport { Separator } from './ui/separator';\r\nimport { Calendar, CreditCard, Users, Database, Activity } from 'lucide-react';\r\nimport { Header } from '@/components/Header';\r\n\r\ninterface Organisation {\r\n  id: number;\r\n  name: string;\r\n  email: string;\r\n  plan: string;\r\n  status: string;\r\n  mrr: number;\r\n  joinedAt: string;\r\n}\r\n\r\ninterface OrganisationDetailsModalProps {\r\n  isOpen: boolean;\r\n  organisation: Organisation | null;\r\n  onClose: () => void;\r\n}\r\n\r\nexport function OrganisationDetailsModal({ isOpen, organisation, onClose }: OrganisationDetailsModalProps) {\r\n  if (!organisation) return null;\r\n\r\n  // =============================================\r\n  // TODO: FETCH DETAILED ORGANISATION DATA\r\n  // =============================================\r\n  // useEffect(() => {\r\n  //   async function fetchOrganisationDetails() {\r\n  //     const response = await fetch(`/api/admin/organisations/${organisation.id}/details`)\r\n  //     const data = await response.json()\r\n  //     setOrganisationDetails(data)\r\n  //   }\r\n  //   fetchOrganisationDetails()\r\n  // }, [organisation.id])\r\n  // =============================================\r\n\r\n  // Mock detailed data\r\n  const details = {\r\n    userCount: 12,\r\n    storageUsedGB: 45,\r\n    apiCallsThisMonth: 12450,\r\n    lastPaymentDate: '2024-11-01',\r\n    nextBillingDate: '2024-12-01',\r\n    totalRevenue: 29990,\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onOpenChange={onClose}>\r\n      <DialogContent className=\"sm:max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <div className=\"flex items-start justify-between\">\r\n            <div>\r\n              <DialogTitle>{organisation.name}</DialogTitle>\r\n              <DialogDescription>{organisation.email}</DialogDescription>\r\n            </div>\r\n            <Badge variant={organisation.status === 'active' ? 'default' : 'outline'}>\r\n              {organisation.status}\r\n            </Badge>\r\n          </div>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6 mt-4\">\r\n          {/* Quick Stats */}\r\n          <div className=\"grid grid-cols-3 gap-4\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-sm\">Users</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl\">{details.userCount}</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-sm\">Storage</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl\">{details.storageUsedGB}GB</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-sm\">API Calls</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl\">{details.apiCallsThisMonth.toLocaleString()}</div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* Subscription Details */}\r\n          <div className=\"space-y-4\">\r\n            <h4 className=\"font-semibold\">Subscription Details</h4>\r\n            \r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <CreditCard className=\"size-4 text-muted-foreground\" />\r\n                  <span>Plan</span>\r\n                </div>\r\n                <Badge variant=\"secondary\">{organisation.plan}</Badge>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <CreditCard className=\"size-4 text-muted-foreground\" />\r\n                  <span>Monthly Revenue</span>\r\n                </div>\r\n                <span className=\"font-semibold\">{organisation.mrr}</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <Calendar className=\"size-4 text-muted-foreground\" />\r\n                  <span>Joined</span>\r\n                </div>\r\n                <span className=\"text-sm text-muted-foreground\">{organisation.joinedAt}</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <Calendar className=\"size-4 text-muted-foreground\" />\r\n                  <span>Last Payment</span>\r\n                </div>\r\n                <span className=\"text-sm text-muted-foreground\">{details.lastPaymentDate}</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <Calendar className=\"size-4 text-muted-foreground\" />\r\n                  <span>Next Billing</span>\r\n                </div>\r\n                <span className=\"text-sm text-muted-foreground\">{details.nextBillingDate}</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm\">\r\n                  <Activity className=\"size-4 text-muted-foreground\" />\r\n                  <span>Total Revenue</span>\r\n                </div>\r\n                <span className=\"font-semibold\">{details.totalRevenue.toLocaleString()}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex gap-2\">\r\n            <Button onClick={onClose} variant=\"outline\" className=\"flex-1\">\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\OrganisationManagementModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\PaymentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'options' is assigned a value but never used.","line":97,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":97,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3765,3768],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3765,3768],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":134,"column":16,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[4571,4611],"text":"\r\n            You&apos;re subscribing to the "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[4571,4611],"text":"\r\n            You&lsquo;re subscribing to the "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[4571,4611],"text":"\r\n            You&#39;re subscribing to the "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[4571,4611],"text":"\r\n            You&rsquo;re subscribing to the "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';\r\nimport { Button } from './ui/button';\r\nimport { Input } from './ui/input';\r\nimport { Label } from './ui/label';\r\nimport { useState } from 'react';\r\nimport { CreditCard, Lock } from 'lucide-react';\r\n\r\ninterface PaymentModalProps {\r\n  plan: {\r\n    name: string;\r\n    price: number;\r\n    period: string;\r\n  };\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}\r\n\r\nexport function PaymentModal({ plan, onClose, onSuccess }: PaymentModalProps) {\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  const handlePayment = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsProcessing(true);\r\n\r\n    // =============================================\r\n    // TODO: REPLACE WITH REAL RAZORPAY INTEGRATION\r\n    // =============================================\r\n    // PRODUCTION IMPLEMENTATION:\r\n    //\r\n    // STEP 1: Create order on backend\r\n    // const orderResponse = await fetch('/api/payments/create-order', {\r\n    //   method: 'POST',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({ \r\n    //     planId: plan.name.toUpperCase(),\r\n    //     amount: plan.price \r\n    //   })\r\n    // })\r\n    // const { orderId, amount, currency, key } = await orderResponse.json()\r\n    //\r\n    // STEP 2: Initialize Razorpay Checkout\r\n    // const options = {\r\n    //   key: key, // Razorpay Key ID from backend\r\n    //   amount: amount, // Amount in paise\r\n    //   currency: currency,\r\n    //   name: 'SaaSify',\r\n    //   description: `${plan.name} Plan Subscription`,\r\n    //   order_id: orderId,\r\n    //   handler: async function(response) {\r\n    //     // STEP 3: Verify payment on backend\r\n    //     const verifyResponse = await fetch('/api/payments/verify', {\r\n    //       method: 'POST',\r\n    //       headers: { 'Content-Type': 'application/json' },\r\n    //       body: JSON.stringify({\r\n    //         razorpay_order_id: response.razorpay_order_id,\r\n    //         razorpay_payment_id: response.razorpay_payment_id,\r\n    //         razorpay_signature: response.razorpay_signature,\r\n    //         planId: plan.name.toUpperCase()\r\n    //       })\r\n    //     })\r\n    //     const result = await verifyResponse.json()\r\n    //     \r\n    //     if (result.success) {\r\n    //       onSuccess()\r\n    //     } else {\r\n    //       alert('Payment verification failed')\r\n    //     }\r\n    //   },\r\n    //   prefill: {\r\n    //     name: 'User Name',\r\n    //     email: 'user@example.com',\r\n    //     contact: '9999999999'\r\n    //   },\r\n    //   theme: {\r\n    //     color: '#dc2626' // Red color matching our theme\r\n    //   }\r\n    // }\r\n    //\r\n    // STEP 4: Open Razorpay Checkout\r\n    // const rzp = new window.Razorpay(options)\r\n    // rzp.open()\r\n    //\r\n    // STEP 5: Add Razorpay script to your HTML\r\n    // Add this to your app/layout.tsx or index.html:\r\n    // <script src=\"https://checkout.razorpay.com/v1/checkout.js\"></script>\r\n    // =============================================\r\n\r\n    // Mock Razorpay integration\r\n    // In production, you would:\r\n    // 1. Create an order on your backend using Razorpay API\r\n    // 2. Initialize Razorpay checkout with the order ID\r\n    // 3. Handle payment success/failure callbacks\r\n    // 4. Update user subscription in database (Prisma + Neon)\r\n\r\n    setTimeout(() => {\r\n      // Simulate payment processing\r\n      const options = {\r\n        key: 'YOUR_RAZORPAY_KEY_ID', // Replace with actual Razorpay key\r\n        amount: plan.price * 100, // Razorpay expects amount in paise\r\n        currency: 'INR',\r\n        name: 'SaaSify',\r\n        description: `${plan.name} Plan Subscription`,\r\n        image: '/logo.png',\r\n        handler: function (response: any) {\r\n          // This would be called on successful payment\r\n          console.log('Payment successful:', response.razorpay_payment_id);\r\n          onSuccess();\r\n        },\r\n        prefill: {\r\n          name: 'User Name',\r\n          email: 'user@example.com',\r\n          contact: '9999999999'\r\n        },\r\n        theme: {\r\n          color: '#3b82f6'\r\n        }\r\n      };\r\n\r\n      // In production: const rzp = new Razorpay(options);\r\n      // rzp.open();\r\n\r\n      // For demo purposes, simulate success\r\n      setIsProcessing(false);\r\n      onSuccess();\r\n    }, 2000);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={true} onOpenChange={onClose}>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>Complete Your Purchase</DialogTitle>\r\n          <DialogDescription>\r\n            You're subscribing to the {plan.name} plan for {plan.price}/{plan.period}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <form onSubmit={handlePayment} className=\"space-y-4 mt-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"name\">Full Name</Label>\r\n            <Input id=\"name\" placeholder=\"John Doe\" required />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"email\">Email</Label>\r\n            <Input id=\"email\" type=\"email\" placeholder=\"john@example.com\" required />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"phone\">Phone Number</Label>\r\n            <Input id=\"phone\" type=\"tel\" placeholder=\"+91 9999999999\" required />\r\n          </div>\r\n\r\n          <div className=\"bg-muted p-4 rounded-lg space-y-2\">\r\n            <div className=\"flex justify-between\">\r\n              <span>Plan</span>\r\n              <span>{plan.name}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span>Amount</span>\r\n              <span>{plan.price}</span>\r\n            </div>\r\n            <div className=\"flex justify-between border-t pt-2\">\r\n              <span className=\"font-semibold\">Total</span>\r\n              <span className=\"font-semibold\">{plan.price}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n            <Lock className=\"size-4\" />\r\n            <span>Secure payment powered by Razorpay</span>\r\n          </div>\r\n\r\n          <div className=\"flex gap-3\">\r\n            <Button type=\"button\" variant=\"outline\" onClick={onClose} className=\"flex-1\">\r\n              Cancel\r\n            </Button>\r\n            <Button type=\"submit\" disabled={isProcessing} className=\"flex-1\">\r\n              <CreditCard className=\"size-4 mr-2\" />\r\n              {isProcessing ? 'Processing...' : 'Pay Now'}\r\n            </Button>\r\n          </div>\r\n\r\n          <p className=\"text-xs text-muted-foreground text-center\">\r\n            By proceeding, you agree to our Terms of Service and Privacy Policy\r\n          </p>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\Sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":11,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":12,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n    LayoutDashboard,\r\n    FileText,\r\n    Users,\r\n    BarChart3,\r\n    CreditCard,\r\n    Settings,\r\n} from 'lucide-react';\r\n\r\nexport function Sidebar() {\r\n    const pathname = usePathname();\r\n\r\n    const isActive = (path: string) => {\r\n        return pathname === path || pathname?.startsWith(`${path}/`);\r\n    };\r\n\r\n    return (\r\n        <aside className=\"w-64 border-r bg-background min-h-[calc(100vh-4rem)] p-4\">\r\n            <nav className=\"space-y-2\">\r\n                <Button\r\n                    variant={isActive('/organisation') ? 'secondary' : 'ghost'}\r\n                    className=\"w-full justify-start\"\r\n                    asChild\r\n                >\r\n                    <Link href=\"/organisation\">\r\n                        <LayoutDashboard className=\"size-4 mr-2\" />\r\n                        Dashboard\r\n                    </Link>\r\n                </Button>\r\n                <Button\r\n                    variant={isActive('/contacts') ? 'secondary' : 'ghost'}\r\n                    className=\"w-full justify-start\"\r\n                    asChild\r\n                >\r\n                    <Link href=\"/contacts\">\r\n                        <FileText className=\"size-4 mr-2\" />\r\n                        Contacts\r\n                    </Link>\r\n                </Button>\r\n                <Button\r\n                    variant={isActive('/organisation/campaigns') ? 'secondary' : 'ghost'}\r\n                    className=\"w-full justify-start\"\r\n                    asChild\r\n                >\r\n                    <Link href=\"/organisation/campaigns\">\r\n                        <Users className=\"size-4 mr-2\" />\r\n                        Campaigns\r\n                    </Link>\r\n                </Button>\r\n                <Button\r\n                    variant={isActive('/organisation/templates') ? 'secondary' : 'ghost'}\r\n                    className=\"w-full justify-start\"\r\n                    asChild\r\n                >\r\n                    <Link href=\"/organisation/templates\">\r\n                        <FileText className=\"size-4 mr-2\" />\r\n                        Templates\r\n                    </Link>\r\n                </Button>\r\n                <Button\r\n                    variant={isActive('/organisation/settings') ? 'secondary' : 'ghost'}\r\n                    className=\"w-full justify-start\"\r\n                    asChild\r\n                >\r\n                    <Link href=\"/organisation/settings\">\r\n                        <FileText className=\"size-4 mr-2\" />\r\n                        Accounts\r\n                    </Link>\r\n                </Button>\r\n                {/* <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n                    <Users className=\"size-4 mr-2\" />\r\n                    Team\r\n                </Button>\r\n                <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n                    <BarChart3 className=\"size-4 mr-2\" />\r\n                    Analytics\r\n                </Button>\r\n                <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n                    <CreditCard className=\"size-4 mr-2\" />\r\n                    Billing\r\n                </Button>\r\n                <Button variant=\"ghost\" className=\"w-full justify-start\">\r\n                    <Settings className=\"size-4 mr-2\" />\r\n                    Settings\r\n                </Button> */}\r\n            </nav>\r\n        </aside>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\auth\\OnboardingPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":70,"column":16,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2314,2385],"text":"\r\n            Let&apos;s set up your organization to get started\r\n          "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2314,2385],"text":"\r\n            Let&lsquo;s set up your organization to get started\r\n          "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2314,2385],"text":"\r\n            Let&#39;s set up your organization to get started\r\n          "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2314,2385],"text":"\r\n            Let&rsquo;s set up your organization to get started\r\n          "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3496,3499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3496,3499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Onboarding Page Component\r\n * \r\n * After sign-up, users complete their profile and create their tenant.\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport { useUser } from '@clerk/clerk-react';\r\nimport { Button } from '../ui/button';\r\nimport { Input } from '../ui/input';\r\nimport { Label } from '../ui/label';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../ui/card';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../ui/select';\r\nimport { Activity, Building2 } from 'lucide-react';\r\n\r\ninterface OnboardingPageProps {\r\n  onComplete: () => void;\r\n}\r\n\r\nexport function OnboardingPage({ onComplete }: OnboardingPageProps) {\r\n  const { user } = useUser();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    organizationName: '',\r\n    plan: 'FREE_TRIAL',\r\n  });\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    // =============================================\r\n    // TODO: REPLACE WITH REAL API CALL\r\n    // =============================================\r\n    // This should create a tenant in the database\r\n    // \r\n    // const response = await fetch('/api/onboarding', {\r\n    //   method: 'POST',\r\n    //   headers: { 'Content-Type': 'application/json' },\r\n    //   body: JSON.stringify({\r\n    //     organizationName: formData.organizationName,\r\n    //     plan: formData.plan,\r\n    //   })\r\n    // });\r\n    // \r\n    // if (response.ok) {\r\n    //   const { tenant } = await response.json();\r\n    //   onComplete();\r\n    // }\r\n    // =============================================\r\n\r\n    // Mock implementation\r\n    setTimeout(() => {\r\n      setIsLoading(false);\r\n      onComplete();\r\n    }, 1000);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/30 p-4\">\r\n      <Card className=\"w-full max-w-md\">\r\n        <CardHeader className=\"text-center\">\r\n          <div className=\"flex justify-center mb-4\">\r\n            <div className=\"size-16 rounded-full bg-primary/10 flex items-center justify-center\">\r\n              <Building2 className=\"size-8 text-primary\" />\r\n            </div>\r\n          </div>\r\n          <CardTitle>Welcome to SaaSify!</CardTitle>\r\n          <CardDescription>\r\n            Let's set up your organization to get started\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"email\">Email</Label>\r\n              <Input\r\n                id=\"email\"\r\n                type=\"email\"\r\n                value={user?.primaryEmailAddress?.emailAddress || ''}\r\n                disabled\r\n                className=\"bg-muted\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"organizationName\">Organization Name</Label>\r\n              <Input\r\n                id=\"organizationName\"\r\n                placeholder=\"Acme Corp\"\r\n                value={formData.organizationName}\r\n                onChange={(e) => setFormData({ ...formData, organizationName: e.target.value })}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"plan\">Select Plan</Label>\r\n              <Select \r\n                value={formData.plan} \r\n                onValueChange={(value:any) => setFormData({ ...formData, plan: value })}\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"FREE_TRIAL\">Free Trial (14 days)</SelectItem>\r\n                  <SelectItem value=\"PROFESSIONAL\">Professional - 2,999/month</SelectItem>\r\n                  <SelectItem value=\"ENTERPRISE\">Enterprise - 9,999/month</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                You can change your plan anytime\r\n              </p>\r\n            </div>\r\n\r\n            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n              {isLoading ? 'Setting up...' : 'Complete Setup'}\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\auth\\SignInPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\auth\\SignUpPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\figma\\ImageWithFallback.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":21,"column":9,"nodeType":"JSXOpeningElement","endLine":21,"endColumn":96},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":25,"column":5,"nodeType":"JSXOpeningElement","endLine":25,"endColumn":100}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react'\r\n\r\nconst ERROR_IMG_SRC =\r\n  'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg=='\r\n\r\nexport function ImageWithFallback(props: React.ImgHTMLAttributes<HTMLImageElement>) {\r\n  const [didError, setDidError] = useState(false)\r\n\r\n  const handleError = () => {\r\n    setDidError(true)\r\n  }\r\n\r\n  const { src, alt, style, className, ...rest } = props\r\n\r\n  return didError ? (\r\n    <div\r\n      className={`inline-block bg-gray-100 text-center align-middle ${className ?? ''}`}\r\n      style={style}\r\n    >\r\n      <div className=\"flex items-center justify-center w-full h-full\">\r\n        <img src={ERROR_IMG_SRC} alt=\"Error loading image\" {...rest} data-original-url={src} />\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    <img src={src} alt={alt} className={className} style={style} {...rest} onError={handleError} />\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\razorpay-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[410,413],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[410,413],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'amount' is defined but never used.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":9},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":138,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4348,4351],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4348,4351],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4577,4580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4577,4580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useUser } from \"@clerk/nextjs\";\r\nimport { toast } from \"sonner\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport type { RazorpayOptions, RazorpayResponse } from \"@/types/razorpay\";\r\n\r\ninterface RazorpayButtonProps {\r\n  plan: string;\r\n  amount: number;\r\n  onSuccess?: (paymentData?: any) => void;\r\n  onError?: (error: string) => void;\r\n  children: React.ReactNode;\r\n  variant?: \"default\" | \"outline\" | \"secondary\" | \"ghost\" | \"link\" | \"destructive\";\r\n  className?: string;\r\n  organizationName?: string;\r\n  isSignup?: boolean;\r\n}\r\n\r\nexport function RazorpayButton({\r\n  plan,\r\n  amount,\r\n  onSuccess,\r\n  onError,\r\n  children,\r\n  variant = \"default\",\r\n  className,\r\n  organizationName,\r\n  isSignup = false,\r\n}: RazorpayButtonProps) {\r\n  const { user } = useUser();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isScriptLoaded, setIsScriptLoaded] = useState(false);\r\n\r\n  // Load Razorpay script\r\n  useEffect(() => {\r\n    const script = document.createElement(\"script\");\r\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n    script.async = true;\r\n    script.onload = () => setIsScriptLoaded(true);\r\n    document.body.appendChild(script);\r\n\r\n    return () => {\r\n      document.body.removeChild(script);\r\n    };\r\n  }, []);\r\n\r\n  const router = useRouter(); // Add this hook at the top\r\n\r\n  const handlePayment = async () => {\r\n    if (!isScriptLoaded) {\r\n      toast.error(\"Payment system is loading, please try again\");\r\n      return;\r\n    }\r\n\r\n    if (!user) {\r\n      toast.error(\"Please sign in to continue\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // Create order\r\n      const orderResponse = await fetch(\"/api/razorpay/create-order\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ plan, organizationName, isSignup }),\r\n      });\r\n\r\n      if (!orderResponse.ok) {\r\n        const error = await orderResponse.json();\r\n        throw new Error(error.error || \"Failed to create order\");\r\n      }\r\n\r\n      const orderData = await orderResponse.json();\r\n\r\n      const options: RazorpayOptions = {\r\n        key: orderData.keyId,\r\n        amount: orderData.amount,\r\n        currency: orderData.currency,\r\n        name: \"CampZeo\",\r\n        description: `${plan} Plan Subscription`,\r\n        order_id: orderData.orderId,\r\n        handler: async (response: RazorpayResponse) => {\r\n          try {\r\n            const verifyResponse = await fetch(\"/api/razorpay/verify-payment\", {\r\n              method: \"POST\",\r\n              headers: { \"Content-Type\": \"application/json\" },\r\n              body: JSON.stringify({\r\n                razorpay_order_id: response.razorpay_order_id,\r\n                razorpay_payment_id: response.razorpay_payment_id,\r\n                razorpay_signature: response.razorpay_signature,\r\n                plan,\r\n                isSignup,\r\n              }),\r\n            });\r\n\r\n            if (!verifyResponse.ok) {\r\n              throw new Error(\"Payment verification failed\");\r\n            }\r\n\r\n            const verifyData = await verifyResponse.json();\r\n            toast.success(\"Payment successful!\");\r\n            \r\n            onSuccess?.(verifyData);\r\n\r\n            if (!isSignup) {\r\n                router.push(`/payment/success?payment_id=${response.razorpay_payment_id}`);\r\n            }\r\n          } catch (error) {\r\n            console.error(\"Payment verification error:\", error);\r\n            toast.error(\"Payment verification failed\");\r\n            onError?.(error instanceof Error ? error.message : \"Verification failed\");\r\n            router.push(`/payment/failure?error=${encodeURIComponent(\"Verification failed\")}`);\r\n          } finally {\r\n            setIsLoading(false);\r\n          }\r\n        },\r\n        prefill: {\r\n          name: user.fullName || \"\",\r\n          email: user.primaryEmailAddress?.emailAddress || \"\",\r\n        },\r\n        theme: {\r\n          color: \"#3b82f6\",\r\n        },\r\n        modal: {\r\n          ondismiss: () => {\r\n            setIsLoading(false);\r\n            toast.info(\"Payment cancelled\");\r\n          },\r\n        },\r\n      };\r\n\r\n      const razorpay = new window.Razorpay(options);\r\n      razorpay.on('payment.failed', ((response: any) => {\r\n        console.error(\"Payment Failed\", response.error);\r\n        toast.error(response.error.description);\r\n        router.push(`/payment/failure?error=${encodeURIComponent(response.error.description)}`);\r\n      }) as any);\r\n      razorpay.open();\r\n    } catch (error) {\r\n      console.error(\"Payment error:\", error);\r\n      toast.error(error instanceof Error ? error.message : \"Payment failed\");\r\n      onError?.(error instanceof Error ? error.message : \"Payment failed\");\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Button\r\n      onClick={handlePayment}\r\n      disabled={isLoading || !isScriptLoaded}\r\n      variant={variant}\r\n      className={className}\r\n    >\r\n      {isLoading ? \"Processing...\" : children}\r\n    </Button>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\command.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\navigation-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\secret-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\sidebar.tsx:611:26\n  609 |   // Random width between 50 to 90%.\n  610 |   const width = React.useMemo(() => {\n> 611 |     return `${Math.floor(Math.random() * 40) + 50}%`;\n      |                          ^^^^^^^^^^^^^ Cannot call impure function\n  612 |   }, []);\n  613 |\n  614 |   return (","line":611,"column":26,"nodeType":null,"endLine":611,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport { VariantProps, cva } from \"class-variance-authority\";\r\nimport { PanelLeftIcon } from \"lucide-react\";\r\n\r\nimport { useIsMobile } from \"./use-mobile\";\r\nimport { cn } from \"./utils\";\r\nimport { Button } from \"./button\";\r\nimport { Input } from \"./input\";\r\nimport { Separator } from \"./separator\";\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetDescription,\r\n  SheetHeader,\r\n  SheetTitle,\r\n} from \"./sheet\";\r\nimport { Skeleton } from \"./skeleton\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"./tooltip\";\r\n\r\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\";\r\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;\r\nconst SIDEBAR_WIDTH = \"16rem\";\r\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\";\r\nconst SIDEBAR_WIDTH_ICON = \"3rem\";\r\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\";\r\n\r\ntype SidebarContextProps = {\r\n  state: \"expanded\" | \"collapsed\";\r\n  open: boolean;\r\n  setOpen: (open: boolean) => void;\r\n  openMobile: boolean;\r\n  setOpenMobile: (open: boolean) => void;\r\n  isMobile: boolean;\r\n  toggleSidebar: () => void;\r\n};\r\n\r\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null);\r\n\r\nfunction useSidebar() {\r\n  const context = React.useContext(SidebarContext);\r\n  if (!context) {\r\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\");\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nfunction SidebarProvider({\r\n  defaultOpen = true,\r\n  open: openProp,\r\n  onOpenChange: setOpenProp,\r\n  className,\r\n  style,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  defaultOpen?: boolean;\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n}) {\r\n  const isMobile = useIsMobile();\r\n  const [openMobile, setOpenMobile] = React.useState(false);\r\n\r\n  // This is the internal state of the sidebar.\r\n  // We use openProp and setOpenProp for control from outside the component.\r\n  const [_open, _setOpen] = React.useState(defaultOpen);\r\n  const open = openProp ?? _open;\r\n  const setOpen = React.useCallback(\r\n    (value: boolean | ((value: boolean) => boolean)) => {\r\n      const openState = typeof value === \"function\" ? value(open) : value;\r\n      if (setOpenProp) {\r\n        setOpenProp(openState);\r\n      } else {\r\n        _setOpen(openState);\r\n      }\r\n\r\n      // This sets the cookie to keep the sidebar state.\r\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;\r\n    },\r\n    [setOpenProp, open],\r\n  );\r\n\r\n  // Helper to toggle the sidebar.\r\n  const toggleSidebar = React.useCallback(() => {\r\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);\r\n  }, [isMobile, setOpen, setOpenMobile]);\r\n\r\n  // Adds a keyboard shortcut to toggle the sidebar.\r\n  React.useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      if (\r\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\r\n        (event.metaKey || event.ctrlKey)\r\n      ) {\r\n        event.preventDefault();\r\n        toggleSidebar();\r\n      }\r\n    };\r\n\r\n    window.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [toggleSidebar]);\r\n\r\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\r\n  // This makes it easier to style the sidebar with Tailwind classes.\r\n  const state = open ? \"expanded\" : \"collapsed\";\r\n\r\n  const contextValue = React.useMemo<SidebarContextProps>(\r\n    () => ({\r\n      state,\r\n      open,\r\n      setOpen,\r\n      isMobile,\r\n      openMobile,\r\n      setOpenMobile,\r\n      toggleSidebar,\r\n    }),\r\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],\r\n  );\r\n\r\n  return (\r\n    <SidebarContext.Provider value={contextValue}>\r\n      <TooltipProvider delayDuration={0}>\r\n        <div\r\n          data-slot=\"sidebar-wrapper\"\r\n          style={\r\n            {\r\n              \"--sidebar-width\": SIDEBAR_WIDTH,\r\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\r\n              ...style,\r\n            } as React.CSSProperties\r\n          }\r\n          className={cn(\r\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\r\n            className,\r\n          )}\r\n          {...props}\r\n        >\r\n          {children}\r\n        </div>\r\n      </TooltipProvider>\r\n    </SidebarContext.Provider>\r\n  );\r\n}\r\n\r\nfunction Sidebar({\r\n  side = \"left\",\r\n  variant = \"sidebar\",\r\n  collapsible = \"offcanvas\",\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  side?: \"left\" | \"right\";\r\n  variant?: \"sidebar\" | \"floating\" | \"inset\";\r\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\";\r\n}) {\r\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();\r\n\r\n  if (collapsible === \"none\") {\r\n    return (\r\n      <div\r\n        data-slot=\"sidebar\"\r\n        className={cn(\r\n          \"bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col\",\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isMobile) {\r\n    return (\r\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\r\n        <SheetContent\r\n          data-sidebar=\"sidebar\"\r\n          data-slot=\"sidebar\"\r\n          data-mobile=\"true\"\r\n          className=\"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden\"\r\n          style={\r\n            {\r\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\r\n            } as React.CSSProperties\r\n          }\r\n          side={side}\r\n        >\r\n          <SheetHeader className=\"sr-only\">\r\n            <SheetTitle>Sidebar</SheetTitle>\r\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\r\n          </SheetHeader>\r\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\r\n        </SheetContent>\r\n      </Sheet>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"group peer text-sidebar-foreground hidden md:block\"\r\n      data-state={state}\r\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\r\n      data-variant={variant}\r\n      data-side={side}\r\n      data-slot=\"sidebar\"\r\n    >\r\n      {/* This is what handles the sidebar gap on desktop */}\r\n      <div\r\n        data-slot=\"sidebar-gap\"\r\n        className={cn(\r\n          \"relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear\",\r\n          \"group-data-[collapsible=offcanvas]:w-0\",\r\n          \"group-data-[side=right]:rotate-180\",\r\n          variant === \"floating\" || variant === \"inset\"\r\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]\"\r\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon)\",\r\n        )}\r\n      />\r\n      <div\r\n        data-slot=\"sidebar-container\"\r\n        className={cn(\r\n          \"fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex\",\r\n          side === \"left\"\r\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\r\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\r\n          // Adjust the padding for floating and inset variants.\r\n          variant === \"floating\" || variant === \"inset\"\r\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]\"\r\n            : \"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l\",\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        <div\r\n          data-sidebar=\"sidebar\"\r\n          data-slot=\"sidebar-inner\"\r\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\r\n        >\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SidebarTrigger({\r\n  className,\r\n  onClick,\r\n  ...props\r\n}: React.ComponentProps<typeof Button>) {\r\n  const { toggleSidebar } = useSidebar();\r\n\r\n  return (\r\n    <Button\r\n      data-sidebar=\"trigger\"\r\n      data-slot=\"sidebar-trigger\"\r\n      variant=\"ghost\"\r\n      size=\"icon\"\r\n      className={cn(\"size-7\", className)}\r\n      onClick={(event) => {\r\n        onClick?.(event);\r\n        toggleSidebar();\r\n      }}\r\n      {...props}\r\n    >\r\n      <PanelLeftIcon />\r\n      <span className=\"sr-only\">Toggle Sidebar</span>\r\n    </Button>\r\n  );\r\n}\r\n\r\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\r\n  const { toggleSidebar } = useSidebar();\r\n\r\n  return (\r\n    <button\r\n      data-sidebar=\"rail\"\r\n      data-slot=\"sidebar-rail\"\r\n      aria-label=\"Toggle Sidebar\"\r\n      tabIndex={-1}\r\n      onClick={toggleSidebar}\r\n      title=\"Toggle Sidebar\"\r\n      className={cn(\r\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\r\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\r\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\r\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\r\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\r\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\r\n  return (\r\n    <main\r\n      data-slot=\"sidebar-inset\"\r\n      className={cn(\r\n        \"bg-background relative flex w-full flex-1 flex-col\",\r\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarInput({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof Input>) {\r\n  return (\r\n    <Input\r\n      data-slot=\"sidebar-input\"\r\n      data-sidebar=\"input\"\r\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-header\"\r\n      data-sidebar=\"header\"\r\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-footer\"\r\n      data-sidebar=\"footer\"\r\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof Separator>) {\r\n  return (\r\n    <Separator\r\n      data-slot=\"sidebar-separator\"\r\n      data-sidebar=\"separator\"\r\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-content\"\r\n      data-sidebar=\"content\"\r\n      className={cn(\r\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-group\"\r\n      data-sidebar=\"group\"\r\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarGroupLabel({\r\n  className,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"div\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-group-label\"\r\n      data-sidebar=\"group-label\"\r\n      className={cn(\r\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarGroupAction({\r\n  className,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"button\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-group-action\"\r\n      data-sidebar=\"group-action\"\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 md:after:hidden\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarGroupContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-group-content\"\r\n      data-sidebar=\"group-content\"\r\n      className={cn(\"w-full text-sm\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\r\n  return (\r\n    <ul\r\n      data-slot=\"sidebar-menu\"\r\n      data-sidebar=\"menu\"\r\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\r\n  return (\r\n    <li\r\n      data-slot=\"sidebar-menu-item\"\r\n      data-sidebar=\"menu-item\"\r\n      className={cn(\"group/menu-item relative\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nconst sidebarMenuButtonVariants = cva(\r\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\r\n        outline:\r\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\r\n      },\r\n      size: {\r\n        default: \"h-8 text-sm\",\r\n        sm: \"h-7 text-xs\",\r\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nfunction SidebarMenuButton({\r\n  asChild = false,\r\n  isActive = false,\r\n  variant = \"default\",\r\n  size = \"default\",\r\n  tooltip,\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & {\r\n  asChild?: boolean;\r\n  isActive?: boolean;\r\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>;\r\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\r\n  const Comp = asChild ? Slot : \"button\";\r\n  const { isMobile, state } = useSidebar();\r\n\r\n  const button = (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-button\"\r\n      data-sidebar=\"menu-button\"\r\n      data-size={size}\r\n      data-active={isActive}\r\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\r\n      {...props}\r\n    />\r\n  );\r\n\r\n  if (!tooltip) {\r\n    return button;\r\n  }\r\n\r\n  if (typeof tooltip === \"string\") {\r\n    tooltip = {\r\n      children: tooltip,\r\n    };\r\n  }\r\n\r\n  return (\r\n    <Tooltip>\r\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\r\n      <TooltipContent\r\n        side=\"right\"\r\n        align=\"center\"\r\n        hidden={state !== \"collapsed\" || isMobile}\r\n        {...tooltip}\r\n      />\r\n    </Tooltip>\r\n  );\r\n}\r\n\r\nfunction SidebarMenuAction({\r\n  className,\r\n  asChild = false,\r\n  showOnHover = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> & {\r\n  asChild?: boolean;\r\n  showOnHover?: boolean;\r\n}) {\r\n  const Comp = asChild ? Slot : \"button\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-action\"\r\n      data-sidebar=\"menu-action\"\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        // Increases the hit area of the button on mobile.\r\n        \"after:absolute after:-inset-2 md:after:hidden\",\r\n        \"peer-data-[size=sm]/menu-button:top-1\",\r\n        \"peer-data-[size=default]/menu-button:top-1.5\",\r\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        showOnHover &&\r\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenuBadge({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-menu-badge\"\r\n      data-sidebar=\"menu-badge\"\r\n      className={cn(\r\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\r\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\r\n        \"peer-data-[size=sm]/menu-button:top-1\",\r\n        \"peer-data-[size=default]/menu-button:top-1.5\",\r\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenuSkeleton({\r\n  className,\r\n  showIcon = false,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & {\r\n  showIcon?: boolean;\r\n}) {\r\n  // Random width between 50 to 90%.\r\n  const width = React.useMemo(() => {\r\n    return `${Math.floor(Math.random() * 40) + 50}%`;\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      data-slot=\"sidebar-menu-skeleton\"\r\n      data-sidebar=\"menu-skeleton\"\r\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\r\n      {...props}\r\n    >\r\n      {showIcon && (\r\n        <Skeleton\r\n          className=\"size-4 rounded-md\"\r\n          data-sidebar=\"menu-skeleton-icon\"\r\n        />\r\n      )}\r\n      <Skeleton\r\n        className=\"h-4 max-w-(--skeleton-width) flex-1\"\r\n        data-sidebar=\"menu-skeleton-text\"\r\n        style={\r\n          {\r\n            \"--skeleton-width\": width,\r\n          } as React.CSSProperties\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\r\n  return (\r\n    <ul\r\n      data-slot=\"sidebar-menu-sub\"\r\n      data-sidebar=\"menu-sub\"\r\n      className={cn(\r\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenuSubItem({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"li\">) {\r\n  return (\r\n    <li\r\n      data-slot=\"sidebar-menu-sub-item\"\r\n      data-sidebar=\"menu-sub-item\"\r\n      className={cn(\"group/menu-sub-item relative\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SidebarMenuSubButton({\r\n  asChild = false,\r\n  size = \"md\",\r\n  isActive = false,\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"a\"> & {\r\n  asChild?: boolean;\r\n  size?: \"sm\" | \"md\";\r\n  isActive?: boolean;\r\n}) {\r\n  const Comp = asChild ? Slot : \"a\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"sidebar-menu-sub-button\"\r\n      data-sidebar=\"menu-sub-button\"\r\n      data-size={size}\r\n      data-active={isActive}\r\n      className={cn(\r\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\r\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\r\n        size === \"sm\" && \"text-xs\",\r\n        size === \"md\" && \"text-sm\",\r\n        \"group-data-[collapsible=icon]:hidden\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  Sidebar,\r\n  SidebarContent,\r\n  SidebarFooter,\r\n  SidebarGroup,\r\n  SidebarGroupAction,\r\n  SidebarGroupContent,\r\n  SidebarGroupLabel,\r\n  SidebarHeader,\r\n  SidebarInput,\r\n  SidebarInset,\r\n  SidebarMenu,\r\n  SidebarMenuAction,\r\n  SidebarMenuBadge,\r\n  SidebarMenuButton,\r\n  SidebarMenuItem,\r\n  SidebarMenuSkeleton,\r\n  SidebarMenuSub,\r\n  SidebarMenuSubButton,\r\n  SidebarMenuSubItem,\r\n  SidebarProvider,\r\n  SidebarRail,\r\n  SidebarSeparator,\r\n  SidebarTrigger,\r\n  useSidebar,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\sonner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\use-mobile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\components\\ui\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\admin-impersonation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\auth-utils.ts","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useAuth\" is called in function \"getCurrentUser\" that is neither a React function component nor a custom React Hook function. React component names must start with an uppercase letter. React Hook names must start with the word \"use\".","line":14,"column":22,"nodeType":"Identifier","endLine":14,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Authentication Utilities\r\n * \r\n * Helper functions for authentication and authorization\r\n */\r\n\r\nimport { useAuth } from '@clerk/nextjs'\r\nimport { prisma } from './prisma'\r\n\r\n/**\r\n * Get the current authenticated user from the database\r\n */\r\nexport async function getCurrentUser() {\r\n  const { userId } = useAuth()\r\n\r\n  if (!userId) {\r\n    return null\r\n  }\r\n\r\n  const user = await prisma.user.findUnique({\r\n    where: { clerkId: userId },\r\n    include: {\r\n      organisation: true\r\n    }\r\n  })\r\n\r\n  return user\r\n}\r\n\r\n/**\r\n * Check if the current user is an admin\r\n */\r\nexport async function isAdmin() {\r\n  const user = await getCurrentUser()\r\n  return user?.role === 'ADMIN_USER'\r\n}\r\n\r\n/**\r\n * Check if the current user has an organisation\r\n */\r\nexport async function hasOrganisation() {\r\n  const user = await getCurrentUser()\r\n  return !!user?.organisationId\r\n}\r\n\r\n/**\r\n * Get the current user's organisation\r\n */\r\nexport async function getCurrentOrganisation() {\r\n  const user = await getCurrentUser()\r\n\r\n  if (!user?.organisationId) {\r\n    return null\r\n  }\r\n\r\n  const organisation = await prisma.organisation.findUnique({\r\n    where: { id: user.organisationId },\r\n    include: {\r\n      users: true\r\n    }\r\n  })\r\n\r\n  return organisation\r\n}\r\n\r\n/**\r\n * Require admin role - throw error if not admin\r\n */\r\nexport async function requireAdmin() {\r\n  const user = await getCurrentUser()\r\n\r\n  if (!user || user.role !== 'ADMIN_USER') {\r\n    throw new Error('Admin access required')\r\n  }\r\n\r\n  return user\r\n}\r\n\r\n/**\r\n * Require organisation - throw error if user doesn't have an organisation\r\n */\r\nexport async function requireOrganisation() {\r\n  const user = await getCurrentUser()\r\n\r\n  if (!user?.organisationId) {\r\n    throw new Error('Organisation required')\r\n  }\r\n\r\n  return user\r\n}\r\n\r\n/**\r\n * Get user role for routing\r\n */\r\nexport async function getUserRole(): Promise<'admin' | 'organisation' | null> {\r\n  const user = await getCurrentUser()\r\n\r\n  if (!user) return null\r\n\r\n  return user.role === 'ADMIN_USER' ? 'admin' : 'organisation'\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\clerk-admin.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1745,1748],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1745,1748],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2310,2313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2310,2313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Clerk Admin utilities for user management and impersonation\r\n */\r\n\r\nimport { clerkClient } from \"@clerk/nextjs/server\";\r\n\r\ninterface CreateUserParams {\r\n    email: string;\r\n    password: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    username?: string;\r\n}\r\n\r\n/**\r\n * Create a new user in Clerk\r\n * @param params - User creation parameters\r\n * @returns Clerk user object\r\n */\r\nexport async function createClerkUser(params: CreateUserParams) {\r\n    const { email, password, firstName, lastName, username } = params;\r\n\r\n    // Validate inputs\r\n    if (!email || email.trim() === '') {\r\n        throw new Error('Email is required');\r\n    }\r\n    if (!password || password.trim() === '') {\r\n        throw new Error('Password is required');\r\n    }\r\n\r\n    try {\r\n        const client = await clerkClient();\r\n\r\n        // Generate username from email if not provided (fallback)\r\n        const generatedUsername = username || email.split('@')[0].toLowerCase().replace(/[^a-z0-9]/g, '');\r\n\r\n        console.log('Creating Clerk user with:', {\r\n            email: email.trim(),\r\n            username: generatedUsername,\r\n            firstName: firstName || 'User',\r\n            hasPassword: !!password,\r\n            passwordLength: password.length\r\n        });\r\n\r\n        const user = await client.users.createUser({\r\n            emailAddress: [email.trim()],\r\n            username: generatedUsername,\r\n            password,\r\n            firstName: firstName?.trim() || 'User',\r\n            lastName: lastName?.trim() || undefined,\r\n            skipPasswordChecks: true,\r\n            skipPasswordRequirement: false,\r\n        });\r\n\r\n        console.log('User created successfully:', user.id);\r\n        return user;\r\n    } catch (error: any) {\r\n        console.error('=== Clerk User Creation Error ===');\r\n        console.error('Email:', email);\r\n        console.error('Error object:', error);\r\n        console.error('Error message:', error?.message);\r\n        console.error('Error errors:', error?.errors);\r\n        console.error('Error status:', error?.status);\r\n        console.error('Full error:', JSON.stringify(error, null, 2));\r\n\r\n        // Provide more specific error message\r\n        if (error?.errors && Array.isArray(error.errors)) {\r\n            const errorMessages = error.errors.map((e: any) => e.message).join(', ');\r\n            throw new Error(`Failed to create user: ${errorMessages}`);\r\n        }\r\n\r\n        throw new Error(`Failed to create user in authentication system: ${error?.message || 'Unknown error'}`);\r\n    }\r\n}\r\n\r\n/**\r\n * Generate a sign-in token for user impersonation\r\n * @param userId - Clerk user ID\r\n * @returns Sign-in token\r\n */\r\nexport async function generateSignInToken(userId: string) {\r\n    try {\r\n        // Create a sign-in token that allows the admin to sign in as this user\r\n        const client = await clerkClient();\r\n        const token = await client.signInTokens.createSignInToken({\r\n            userId,\r\n            expiresInSeconds: 3600, // 1 hour\r\n        });\r\n\r\n        return token;\r\n    } catch (error) {\r\n        console.error('Error generating sign-in token:', error);\r\n        throw new Error('Failed to generate sign-in token');\r\n    }\r\n}\r\n\r\n/**\r\n * Delete a Clerk user\r\n * @param userId - Clerk user ID\r\n */\r\nexport async function deleteClerkUser(userId: string) {\r\n    try {\r\n        const client = await clerkClient();\r\n        await client.users.deleteUser(userId);\r\n    } catch (error) {\r\n        console.error('Error deleting Clerk user:', error);\r\n        throw new Error('Failed to delete user from authentication system');\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\email.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3071,3074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3071,3074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":167,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6891,6894],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6891,6894],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":207,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":207,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8442,8445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8442,8445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8830,8833],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8830,8833],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":306,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":306,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12163,12166],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12163,12166],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Mailgun from 'mailgun.js';\r\nimport FormData from 'form-data';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\n\r\ninterface OrganisationInviteParams {\r\n    email: string;\r\n    password: string;\r\n    organisationName: string;\r\n    ownerName?: string;\r\n}\r\n\r\nasync function getEmailConfig() {\r\n    try {\r\n        const configs = await prisma.adminPlatformConfiguration.findMany({\r\n            where: {\r\n                key: { in: ['MAILGUN_API_KEY', 'MAILGUN_DOMAIN', 'MAILGUN_FROM_EMAIL'] }\r\n            }\r\n        });\r\n\r\n        const apiKey = configs.find(c => c.key === 'MAILGUN_API_KEY')?.value;\r\n        const domain = configs.find(c => c.key === 'MAILGUN_DOMAIN')?.value;\r\n        const fromEmail = configs.find(c => c.key === 'MAILGUN_FROM_EMAIL')?.value;\r\n\r\n        return { apiKey, domain, fromEmail };\r\n    } catch (error) {\r\n        console.error(\"Failed to fetch email config:\", error);\r\n        return { apiKey: null, domain: null, fromEmail: null };\r\n    }\r\n}\r\n\r\n/**\r\n * Send organisation invitation email with login credentials\r\n * @param params - Email parameters including recipient, password, and org details\r\n */\r\nexport async function sendOrganisationInvite(params: OrganisationInviteParams): Promise<void> {\r\n    const { email, password, organisationName, ownerName } = params;\r\n    const { apiKey, domain, fromEmail } = await getEmailConfig();\r\n\r\n    if (apiKey && domain && fromEmail) {\r\n        const mailgun = new Mailgun(FormData);\r\n        const mg = mailgun.client({ username: 'api', key: apiKey });\r\n\r\n        const msg = {\r\n            from: fromEmail,\r\n            to: [email],\r\n            subject: `Welcome to ${organisationName} - Your Account Details`,\r\n            html: `\r\n                <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\r\n                    <h2>Welcome to ${organisationName}!</h2>\r\n                    <p>Dear ${ownerName || 'User'},</p>\r\n                    <p>Your organisation \"${organisationName}\" has been created successfully.</p>\r\n                    <div style=\"background-color: #f4f4f4; padding: 20px; border-radius: 5px; margin: 20px 0;\">\r\n                        <h3>Login Credentials</h3>\r\n                        <p><strong>Email:</strong> ${email}</p>\r\n                        <p><strong>Temporary Password:</strong> ${password}</p>\r\n                    </div>\r\n                    <p>Please login and change your password immediately.</p>\r\n                    <p>\r\n                        <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/sign-in\" \r\n                           style=\"background-color: #0070f3; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;\">\r\n                           Login to Dashboard\r\n                        </a>\r\n                    </p>\r\n                </div>\r\n            `,\r\n        };\r\n\r\n        try {\r\n            await mg.messages.create(domain, msg);\r\n            console.log(` Email sent to ${email} via Mailgun`);\r\n            return;\r\n        } catch (error: any) {\r\n            console.error('Error sending email via Mailgun:', error);\r\n        \r\n        }\r\n    }\r\n\r\n    console.log('='.repeat(60));\r\n    console.log('  MOCK EMAIL SERVICE (Mailgun not configured or failed)');\r\n    console.log('='.repeat(60));\r\n    console.log(' Email Content:');\r\n    console.log('='.repeat(60));\r\n    console.log(`To: ${email}`);\r\n    console.log(`Subject: Welcome to ${organisationName} - Your Account Details`);\r\n    console.log('\\nEmail Body:');\r\n    console.log(`Dear ${ownerName || 'User'},\\n`);\r\n    console.log(`Your organisation \"${organisationName}\" has been created successfully!\\n`);\r\n    console.log('Login Credentials:');\r\n    console.log(`Email: ${email}`);\r\n    console.log(`Temporary Password: ${password}\\n`);\r\n    console.log('Please login and change your password immediately.');\r\n    console.log(`Login URL: ${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/sign-in\\n`);\r\n    console.log('='.repeat(60));\r\n}\r\n\r\n/**\r\n * Generate a random password\r\n * @param length - Password length (default: 12)\r\n * @returns Random password string\r\n */\r\nexport function generatePassword(length: number = 12): string {\r\n    const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n    const lowercase = 'abcdefghijklmnopqrstuvwxyz';\r\n    const numbers = '0123456789';\r\n    const symbols = '!@#$%^&*';\r\n\r\n    const allChars = uppercase + lowercase + numbers + symbols;\r\n\r\n    let password = '';\r\n    password += uppercase[Math.floor(Math.random() * uppercase.length)];\r\n    password += lowercase[Math.floor(Math.random() * lowercase.length)];\r\n    password += numbers[Math.floor(Math.random() * numbers.length)];\r\n    password += symbols[Math.floor(Math.random() * symbols.length)];\r\n\r\n    // Fill the rest randomly\r\n    for (let i = password.length; i < length; i++) {\r\n        password += allChars[Math.floor(Math.random() * allChars.length)];\r\n    }\r\n\r\n    // Shuffle the password\r\n    return password.split('').sort(() => Math.random() - 0.5).join('');\r\n}\r\n\r\ninterface OrganisationApprovedParams {\r\n    email: string;\r\n    organisationName: string;\r\n    ownerName?: string;\r\n}\r\n\r\n/**\r\n * Send organisation approval email\r\n * @param params - Email parameters\r\n */\r\nexport async function sendOrganisationApproved(params: OrganisationApprovedParams): Promise<void> {\r\n    const { email, organisationName, ownerName } = params;\r\n    const { apiKey, domain, fromEmail } = await getEmailConfig();\r\n\r\n    if (apiKey && domain && fromEmail) {\r\n        const mailgun = new Mailgun(FormData);\r\n        const mg = mailgun.client({ username: 'api', key: apiKey });\r\n\r\n        const msg = {\r\n            from: fromEmail,\r\n            to: [email],\r\n            subject: `Your Organisation ${organisationName} is Approved!`,\r\n            html: `\r\n                <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\r\n                    <h2>Organisation Approved!</h2>\r\n                    <p>Dear ${ownerName || 'User'},</p>\r\n                    <p>Great news! Your organisation \"${organisationName}\" has been approved by the administrator.</p>\r\n                    <p>You can now access your dashboard and start using all features.</p>\r\n                    <p>\r\n                        <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/sign-in\" \r\n                           style=\"background-color: #0070f3; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;\">\r\n                           Go to Dashboard\r\n                        </a>\r\n                    </p>\r\n                </div>\r\n            `,\r\n        };\r\n\r\n        try {\r\n            await mg.messages.create(domain, msg);\r\n            console.log(` Email sent to ${email} via Mailgun`);\r\n            return;\r\n        } catch (error: any) {\r\n            console.error('Error sending email via Mailgun:', error);\r\n        }\r\n    }\r\n\r\n    // Mock implementation - logs to console\r\n    console.log('='.repeat(60));\r\n    console.log(' MOCK EMAIL: Organisation Approved');\r\n    console.log('='.repeat(60));\r\n    console.log(`To: ${email}`);\r\n    console.log(`Subject: Your Organisation ${organisationName} is Approved!`);\r\n    console.log('\\nEmail Body:');\r\n    console.log(`Dear ${ownerName || 'User'},\\n`);\r\n    console.log(`Great news! Your organisation \"${organisationName}\" has been approved by the administrator.\\n`);\r\n    console.log('You can now access your dashboard and start using all features.');\r\n    console.log(`Login URL: ${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/sign-in\\n`);\r\n    console.log('='.repeat(60));\r\n    console.log(`Login URL: ${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/sign-in\\n`);\r\n    console.log('='.repeat(60));\r\n}\r\n\r\ninterface CampaignEmailParams {\r\n    to: string;\r\n    subject: string;\r\n    html: string;\r\n    replyTo?: string;\r\n}\r\n\r\n/**\r\n * Send a campaign email to a contact\r\n * @param params - Email parameters\r\n */\r\nexport async function sendCampaignEmail(params: CampaignEmailParams): Promise<boolean> {\r\n    const { to, subject, html, replyTo } = params;\r\n    const { apiKey, domain, fromEmail } = await getEmailConfig();\r\n\r\n    if (apiKey && domain && fromEmail) {\r\n        const mailgun = new Mailgun(FormData);\r\n        const mg = mailgun.client({ username: 'api', key: apiKey });\r\n\r\n        const msg: any = {\r\n            from: fromEmail,\r\n            to: [to],\r\n            subject: subject,\r\n            html: html,\r\n        };\r\n\r\n        if (replyTo) {\r\n            msg['h:Reply-To'] = replyTo;\r\n        }\r\n\r\n        try {\r\n            await mg.messages.create(domain, msg);\r\n            console.log(` Campaign email sent to ${to}`);\r\n            return true;\r\n        } catch (error: any) {\r\n            console.error('Error sending campaign email via Mailgun:', error);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Mock implementation\r\n    console.log('='.repeat(60));\r\n    console.log(' MOCK CAMPAIGN EMAIL');\r\n    console.log('='.repeat(60));\r\n    console.log(`To: ${to}`);\r\n    console.log(`Subject: ${subject}`);\r\n    if (replyTo) console.log(`Reply-To: ${replyTo}`);\r\n    console.log('\\nBody:');\r\n    console.log(html);\r\n    console.log('='.repeat(60));\r\n\r\n    return true; // Return true for mock success\r\n}\r\n\r\ninterface PaymentReceiptParams {\r\n    email: string;\r\n    amount: number;\r\n    currency: string;\r\n    planName: string;\r\n    receiptId: string;\r\n    date: Date;\r\n    organisationName: string;\r\n}\r\n\r\n/**\r\n * Send payment receipt email\r\n * @param params - Payment receipt parameters\r\n */\r\nexport async function sendPaymentReceipt(params: PaymentReceiptParams): Promise<void> {\r\n    const { email, amount, currency, planName, receiptId, date, organisationName } = params;\r\n    const { apiKey, domain, fromEmail } = await getEmailConfig();\r\n\r\n    const formattedAmount = new Intl.NumberFormat('en-IN', {\r\n        style: 'currency',\r\n        currency: currency\r\n    }).format(amount / 100); // Amount is in smallest currency unit\r\n\r\n    const formattedDate = new Date(date).toLocaleDateString();\r\n\r\n    if (apiKey && domain && fromEmail) {\r\n        const mailgun = new Mailgun(FormData);\r\n        const mg = mailgun.client({ username: 'api', key: apiKey });\r\n\r\n        const msg = {\r\n            from: fromEmail,\r\n            to: [email],\r\n            subject: `Payment Receipt - ${receiptId}`,\r\n            html: `\r\n                <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\r\n                    <h2>Payment Receipt</h2>\r\n                    <p>Dear Customer,</p>\r\n                    <p>Thank you for your payment. Here are the details of your transaction:</p>\r\n                    \r\n                    <div style=\"background-color: #f9f9f9; padding: 20px; border-radius: 5px; margin: 20px 0;\">\r\n                        <p><strong>Receipt ID:</strong> ${receiptId}</p>\r\n                        <p><strong>Date:</strong> ${formattedDate}</p>\r\n                        <p><strong>Organisation:</strong> ${organisationName}</p>\r\n                        <p><strong>Plan:</strong> ${planName}</p>\r\n                        <hr style=\"border: 1px solid #eee; margin: 10px 0;\">\r\n                        <p style=\"font-size: 18px;\"><strong>Amount Paid:</strong> ${formattedAmount}</p>\r\n                    </div>\r\n\r\n                    <p>You can view your invoice in your dashboard.</p>\r\n                    \r\n                    <p>\r\n                        <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/organisation/settings/billing\" \r\n                           style=\"background-color: #0070f3; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;\">\r\n                           View Billing History\r\n                        </a>\r\n                    </p>\r\n                </div>\r\n            `,\r\n        };\r\n\r\n        try {\r\n            await mg.messages.create(domain, msg);\r\n            console.log(` Payment receipt sent to ${email}`);\r\n            return;\r\n        } catch (error: any) {\r\n            console.error('Error sending payment receipt via Mailgun:', error);\r\n        }\r\n    }\r\n\r\n    // Mock implementation\r\n    console.log('='.repeat(60));\r\n    console.log(' MOCK EMAIL: Payment Receipt');\r\n    console.log('='.repeat(60));\r\n    console.log(`To: ${email}`);\r\n    console.log(`Subject: Payment Receipt - ${receiptId}`);\r\n    console.log('\\nEmail Body:');\r\n    console.log(`Receipt ID: ${receiptId}`);\r\n    console.log(`Amount: ${formattedAmount}`);\r\n    console.log(`Plan: ${planName}`);\r\n    console.log('='.repeat(60));\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\facebook.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getSocialMediaUrl' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FacebookPostOptions' is defined but never used.","line":8,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getSocialMediaUrl, validateMediaUrl, isVideoUrl } from './media-utils';\r\n\r\ninterface FacebookCredentials {\r\n    accessToken: string;\r\n    pageId: string;\r\n}\r\n\r\ninterface FacebookPostOptions {\r\n    message: string;\r\n    mediaUrls?: string | string[] | null;\r\n    isReel?: boolean; // For Facebook Reels\r\n}\r\n\r\nexport async function postToFacebook(\r\n    credentials: FacebookCredentials,\r\n    message: string,\r\n    mediaUrls?: string | string[] | null,\r\n    options?: { isReel?: boolean }\r\n) {\r\n    const { accessToken, pageId } = credentials;\r\n\r\n    // Normalize mediaUrls to array\r\n    const mediaList = Array.isArray(mediaUrls) ? mediaUrls : (mediaUrls ? [mediaUrls] : []);\r\n\r\n    console.log(`[Facebook] Posting to page: ${pageId}, Media Count: ${mediaList.length}, Is Reel: ${options?.isReel || false}`);\r\n\r\n    try {\r\n        let postId: string;\r\n\r\n        if (mediaList.length === 0) {\r\n            // Text-only post\r\n            const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/feed`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    message,\r\n                    access_token: accessToken,\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const error = await response.json();\r\n                throw new Error(`Facebook API error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const data = await response.json();\r\n            postId = data.id;\r\n\r\n        } else if (mediaList.length === 1) {\r\n            // Single photo/video post\r\n            const mediaUrl = mediaList[0];\r\n\r\n            // Validate and convert URL\r\n            const validation = validateMediaUrl(mediaUrl);\r\n\r\n            if (!validation.valid) {\r\n                console.warn(`[Facebook] ${validation.message} Posting as text-only.`);\r\n                // Fall back to text-only post\r\n                const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/feed`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        message: message + '\\n\\n(Media not posted: URL not publicly accessible)',\r\n                        access_token: accessToken,\r\n                    }),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    const error = await response.json();\r\n                    throw new Error(`Facebook API error: ${JSON.stringify(error)}`);\r\n                }\r\n\r\n                const data = await response.json();\r\n                postId = data.id;\r\n            } else {\r\n                const publicUrl = validation.url;\r\n                const isVideo = isVideoUrl(publicUrl);\r\n\r\n                // Check if it's a Reel (short video)\r\n                if (options?.isReel && isVideo) {\r\n                    console.log(`[Facebook] Posting as Reel with URL: ${publicUrl}`);\r\n\r\n                    // Post as Facebook Reel\r\n                    const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/video_reels`, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                        },\r\n                        body: JSON.stringify({\r\n                            description: message,\r\n                            video_url: publicUrl,\r\n                            access_token: accessToken,\r\n                        }),\r\n                    });\r\n\r\n                    if (!response.ok) {\r\n                        const error = await response.json();\r\n                        console.error('[Facebook] Reel API Error:', error);\r\n                        throw new Error(`Facebook Reel API error: ${JSON.stringify(error)}`);\r\n                    }\r\n\r\n                    const data = await response.json();\r\n                    postId = data.id;\r\n\r\n                } else {\r\n                    // Regular photo or video post\r\n                    const endpoint = isVideo ? 'videos' : 'photos';\r\n                    console.log(`[Facebook] Posting ${endpoint} with URL: ${publicUrl}`);\r\n\r\n                    const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/${endpoint}`, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                        },\r\n                        body: JSON.stringify({\r\n                            message,\r\n                            [isVideo ? 'file_url' : 'url']: publicUrl,\r\n                            access_token: accessToken,\r\n                        }),\r\n                    });\r\n\r\n                    if (!response.ok) {\r\n                        const error = await response.json();\r\n                        console.error('[Facebook] API Error:', error);\r\n                        throw new Error(`Facebook API error: ${JSON.stringify(error)}`);\r\n                    }\r\n\r\n                    const data = await response.json();\r\n                    postId = data.id;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            // Multiple photos - use batch upload\r\n            const photoIds: string[] = [];\r\n\r\n            for (const mediaUrl of mediaList) {\r\n                const validation = validateMediaUrl(mediaUrl);\r\n\r\n                if (!validation.valid) {\r\n                    console.warn(`[Facebook] Skipping invalid URL: ${mediaUrl}`);\r\n                    continue;\r\n                }\r\n\r\n                const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/photos`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        url: validation.url,\r\n                        published: false, // Don't publish yet\r\n                        access_token: accessToken,\r\n                    }),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    const error = await response.json();\r\n                    console.error(`Failed to upload photo: ${error}`);\r\n                    continue;\r\n                }\r\n\r\n                const data = await response.json();\r\n                photoIds.push(data.id);\r\n            }\r\n\r\n            if (photoIds.length === 0) {\r\n                throw new Error('No valid photos could be uploaded');\r\n            }\r\n\r\n            // Create album post with all photos\r\n            const response = await fetch(`https://graph.facebook.com/v18.0/${pageId}/feed`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    message,\r\n                    attached_media: photoIds.map(id => ({ media_fbid: id })),\r\n                    access_token: accessToken,\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const error = await response.json();\r\n                throw new Error(`Facebook API error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const data = await response.json();\r\n            postId = data.id;\r\n        }\r\n\r\n        console.log(`[Facebook] Post created successfully: ${postId}`);\r\n        return { id: postId };\r\n\r\n    } catch (error) {\r\n        console.error('Facebook posting error:', error);\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\instagram.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getSocialMediaUrl' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'InstagramPostOptions' is defined but never used.","line":8,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getSocialMediaUrl, validateMediaUrl, isVideoUrl } from './media-utils';\r\n\r\ninterface InstagramCredentials {\r\n    accessToken: string;\r\n    userId: string;\r\n}\r\n\r\ninterface InstagramPostOptions {\r\n    caption: string;\r\n    mediaUrls?: string | string[] | null;\r\n    isReel?: boolean; // For Instagram Reels\r\n    shareToFeed?: boolean; // Share Reel to feed as well\r\n}\r\n\r\nexport async function postToInstagram(\r\n    credentials: InstagramCredentials,\r\n    caption: string,\r\n    mediaUrls?: string | string[] | null,\r\n    options?: { isReel?: boolean; shareToFeed?: boolean }\r\n) {\r\n    const { accessToken, userId } = credentials;\r\n\r\n    // Normalize mediaUrls to array\r\n    const mediaList = Array.isArray(mediaUrls) ? mediaUrls : (mediaUrls ? [mediaUrls] : []);\r\n\r\n    if (mediaList.length === 0) {\r\n        throw new Error('Instagram requires at least one image or video');\r\n    }\r\n\r\n    console.log(`[Instagram] Posting to user: ${userId}, Media Count: ${mediaList.length}, Is Reel: ${options?.isReel || false}`);\r\n\r\n    try {\r\n        // Validate and convert URLs\r\n        const validatedUrls = mediaList.map(url => {\r\n            const validation = validateMediaUrl(url);\r\n            if (!validation.valid) {\r\n                throw new Error(`Invalid media URL: ${validation.message}`);\r\n            }\r\n            return validation.url;\r\n        });\r\n\r\n        const firstMediaUrl = validatedUrls[0];\r\n        const isVideo = isVideoUrl(firstMediaUrl);\r\n\r\n        // Check if it's a Reel\r\n        if (options?.isReel && isVideo) {\r\n            return await postInstagramReel(credentials, caption, firstMediaUrl, options.shareToFeed);\r\n        }\r\n\r\n        if (validatedUrls.length === 1) {\r\n            // Single media post\r\n            const mediaType = isVideo ? 'VIDEO' : 'IMAGE';\r\n\r\n            // Step 1: Create media container\r\n            const containerResponse = await fetch(\r\n                `https://graph.facebook.com/v18.0/${userId}/media`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        [isVideo ? 'video_url' : 'image_url']: firstMediaUrl,\r\n                        caption,\r\n                        media_type: mediaType,\r\n                        access_token: accessToken,\r\n                    }),\r\n                }\r\n            );\r\n\r\n            if (!containerResponse.ok) {\r\n                const error = await containerResponse.json();\r\n                throw new Error(`Instagram container creation error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const containerData = await containerResponse.json();\r\n            const creationId = containerData.id;\r\n\r\n            // For videos, we might need to wait for processing\r\n            if (isVideo) {\r\n                console.log('[Instagram] Waiting for video processing...');\r\n                await waitForVideoProcessing(userId, creationId, accessToken);\r\n            }\r\n\r\n            // Step 2: Publish the container\r\n            const publishResponse = await fetch(\r\n                `https://graph.facebook.com/v18.0/${userId}/media_publish`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        creation_id: creationId,\r\n                        access_token: accessToken,\r\n                    }),\r\n                }\r\n            );\r\n\r\n            if (!publishResponse.ok) {\r\n                const error = await publishResponse.json();\r\n                throw new Error(`Instagram publish error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const publishData = await publishResponse.json();\r\n            console.log(`[Instagram] Post created successfully: ${publishData.id}`);\r\n            return { id: publishData.id };\r\n\r\n        } else {\r\n            // Carousel post (multiple images)\r\n            const containerIds: string[] = [];\r\n\r\n            // Create containers for each media item\r\n            for (const mediaUrl of validatedUrls) {\r\n                const containerResponse = await fetch(\r\n                    `https://graph.facebook.com/v18.0/${userId}/media`,\r\n                    {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                        },\r\n                        body: JSON.stringify({\r\n                            image_url: mediaUrl,\r\n                            is_carousel_item: true,\r\n                            access_token: accessToken,\r\n                        }),\r\n                    }\r\n                );\r\n\r\n                if (!containerResponse.ok) {\r\n                    const error = await containerResponse.json();\r\n                    console.error(`Failed to create carousel item: ${error}`);\r\n                    continue;\r\n                }\r\n\r\n                const containerData = await containerResponse.json();\r\n                containerIds.push(containerData.id);\r\n            }\r\n\r\n            if (containerIds.length === 0) {\r\n                throw new Error('No valid media items could be uploaded');\r\n            }\r\n\r\n            // Create carousel container\r\n            const carouselResponse = await fetch(\r\n                `https://graph.facebook.com/v18.0/${userId}/media`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        media_type: 'CAROUSEL',\r\n                        caption,\r\n                        children: containerIds,\r\n                        access_token: accessToken,\r\n                    }),\r\n                }\r\n            );\r\n\r\n            if (!carouselResponse.ok) {\r\n                const error = await carouselResponse.json();\r\n                throw new Error(`Instagram carousel creation error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const carouselData = await carouselResponse.json();\r\n\r\n            // Publish carousel\r\n            const publishResponse = await fetch(\r\n                `https://graph.facebook.com/v18.0/${userId}/media_publish`,\r\n                {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                    body: JSON.stringify({\r\n                        creation_id: carouselData.id,\r\n                        access_token: accessToken,\r\n                    }),\r\n                }\r\n            );\r\n\r\n            if (!publishResponse.ok) {\r\n                const error = await publishResponse.json();\r\n                throw new Error(`Instagram publish error: ${JSON.stringify(error)}`);\r\n            }\r\n\r\n            const publishData = await publishResponse.json();\r\n            console.log(`[Instagram] Carousel post created successfully: ${publishData.id}`);\r\n            return { id: publishData.id };\r\n        }\r\n\r\n    } catch (error) {\r\n        console.error('Instagram posting error:', error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Post an Instagram Reel\r\n */\r\nasync function postInstagramReel(\r\n    credentials: InstagramCredentials,\r\n    caption: string,\r\n    videoUrl: string,\r\n    shareToFeed: boolean = true\r\n) {\r\n    const { accessToken, userId } = credentials;\r\n\r\n    console.log(`[Instagram] Creating Reel with video: ${videoUrl}`);\r\n\r\n    try {\r\n        // Step 1: Create Reel container\r\n        const containerResponse = await fetch(\r\n            `https://graph.facebook.com/v18.0/${userId}/media`,\r\n            {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    media_type: 'REELS',\r\n                    video_url: videoUrl,\r\n                    caption,\r\n                    share_to_feed: shareToFeed,\r\n                    access_token: accessToken,\r\n                }),\r\n            }\r\n        );\r\n\r\n        if (!containerResponse.ok) {\r\n            const error = await containerResponse.json();\r\n            throw new Error(`Instagram Reel container error: ${JSON.stringify(error)}`);\r\n        }\r\n\r\n        const containerData = await containerResponse.json();\r\n        const creationId = containerData.id;\r\n\r\n        // Step 2: Wait for video processing\r\n        console.log('[Instagram] Waiting for Reel video processing...');\r\n        await waitForVideoProcessing(userId, creationId, accessToken, 60000); // 60 second timeout\r\n\r\n        // Step 3: Publish the Reel\r\n        const publishResponse = await fetch(\r\n            `https://graph.facebook.com/v18.0/${userId}/media_publish`,\r\n            {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    creation_id: creationId,\r\n                    access_token: accessToken,\r\n                }),\r\n            }\r\n        );\r\n\r\n        if (!publishResponse.ok) {\r\n            const error = await publishResponse.json();\r\n            throw new Error(`Instagram Reel publish error: ${JSON.stringify(error)}`);\r\n        }\r\n\r\n        const publishData = await publishResponse.json();\r\n        console.log(`[Instagram] Reel created successfully: ${publishData.id}`);\r\n        return { id: publishData.id };\r\n\r\n    } catch (error) {\r\n        console.error('Instagram Reel posting error:', error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Wait for Instagram video processing to complete\r\n */\r\nasync function waitForVideoProcessing(\r\n    userId: string,\r\n    containerId: string,\r\n    accessToken: string,\r\n    timeout: number = 30000\r\n): Promise<void> {\r\n    const startTime = Date.now();\r\n    const pollInterval = 2000; // Check every 2 seconds\r\n\r\n    while (Date.now() - startTime < timeout) {\r\n        const statusResponse = await fetch(\r\n            `https://graph.facebook.com/v18.0/${containerId}?fields=status_code&access_token=${accessToken}`\r\n        );\r\n\r\n        if (statusResponse.ok) {\r\n            const statusData = await statusResponse.json();\r\n\r\n            if (statusData.status_code === 'FINISHED') {\r\n                console.log('[Instagram] Video processing complete');\r\n                return;\r\n            } else if (statusData.status_code === 'ERROR') {\r\n                throw new Error('Video processing failed');\r\n            }\r\n\r\n            console.log(`[Instagram] Video status: ${statusData.status_code}, waiting...`);\r\n        }\r\n\r\n        await new Promise(resolve => setTimeout(resolve, pollInterval));\r\n    }\r\n\r\n    throw new Error('Video processing timeout');\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\linkedin.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'prisma' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4013,4016],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4013,4016],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { prisma } from \"@/lib/prisma\";\r\nimport fs from \"fs/promises\";\r\nimport path from \"path\";\r\n\r\ninterface LinkedInCredentials {\r\n    accessToken: string;\r\n    authorUrn: string;\r\n}\r\n\r\nexport async function postToLinkedIn(\r\n    credentials: LinkedInCredentials,\r\n    text: string,\r\n    mediaUrls?: string | string[] | null\r\n) {\r\n    const { accessToken, authorUrn } = credentials;\r\n\r\n    // Normalize mediaUrls to array\r\n    const mediaList = Array.isArray(mediaUrls) ? mediaUrls : (mediaUrls ? [mediaUrls] : []);\r\n\r\n    console.log(`[LinkedIn] Posting with Author URN: ${authorUrn}, Media Count: ${mediaList.length}`);\r\n\r\n    const commonHeaders = {\r\n        \"Authorization\": `Bearer ${accessToken}`,\r\n        \"X-Restli-Protocol-Version\": \"2.0.0\",\r\n        \"LinkedIn-Version\": \"202401\",\r\n    };\r\n\r\n    try {\r\n        const assets: { urn: string, isVideo: boolean }[] = [];\r\n\r\n        // Upload all media files\r\n        for (const mediaUrl of mediaList) {\r\n            // Determine if image or video\r\n            const isVideo = !!mediaUrl.match(/\\.(mp4|mov|webm)$/i);\r\n\r\n            // 1. Register Upload\r\n            console.log(`[LinkedIn] Registering upload for ${mediaUrl}...`);\r\n            const registerResponse = await fetch(\"https://api.linkedin.com/v2/assets?action=registerUpload\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    ...commonHeaders,\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify({\r\n                    registerUploadRequest: {\r\n                        recipes: [isVideo ? \"urn:li:digitalmediaRecipe:feedshare-video\" : \"urn:li:digitalmediaRecipe:feedshare-image\"],\r\n                        owner: authorUrn,\r\n                        serviceRelationships: [\r\n                            {\r\n                                relationshipType: \"OWNER\",\r\n                                identifier: \"urn:li:userGeneratedContent\",\r\n                            },\r\n                        ],\r\n                    },\r\n                }),\r\n            });\r\n\r\n            if (!registerResponse.ok) {\r\n                const errorText = await registerResponse.text();\r\n                console.error(`[LinkedIn] Register Upload Failed: ${registerResponse.status} ${registerResponse.statusText}`, errorText);\r\n                throw new Error(`Failed to register upload: ${errorText}`);\r\n            }\r\n\r\n            const registerData = await registerResponse.json();\r\n            const uploadUrl = registerData.value.uploadMechanism[\"com.linkedin.digitalmedia.uploading.MediaUploadHttpRequest\"].uploadUrl;\r\n            const assetUrn = registerData.value.asset;\r\n\r\n            console.log(`[LinkedIn] Upload registered. Asset URN: ${assetUrn}`);\r\n\r\n            // 2. Upload File\r\n            const publicDir = path.join(process.cwd(), \"public\");\r\n            const filePath = path.join(publicDir, mediaUrl);\r\n\r\n            console.log(`[LinkedIn] Reading file from: ${filePath}`);\r\n            const fileBuffer = await fs.readFile(filePath);\r\n\r\n            console.log(\"[LinkedIn] Uploading file...\");\r\n            const uploadResponse = await fetch(uploadUrl, {\r\n                method: \"PUT\",\r\n                headers: {\r\n                    \"Authorization\": `Bearer ${accessToken}`,\r\n                    \"Content-Type\": \"application/octet-stream\",\r\n                },\r\n                body: fileBuffer,\r\n            });\r\n\r\n            if (!uploadResponse.ok) {\r\n                const errorText = await uploadResponse.text();\r\n                console.error(`[LinkedIn] File Upload Failed: ${uploadResponse.status} ${uploadResponse.statusText}`, errorText);\r\n                throw new Error(`Failed to upload file: ${errorText}`);\r\n            }\r\n            console.log(\"[LinkedIn] File uploaded successfully.\");\r\n\r\n            assets.push({ urn: assetUrn, isVideo });\r\n        }\r\n\r\n        // 3. Create Post\r\n        console.log(\"[LinkedIn] Creating UGC post...\");\r\n        const shareBody: any = {\r\n            author: authorUrn,\r\n            lifecycleState: \"PUBLISHED\",\r\n            specificContent: {\r\n                \"com.linkedin.ugc.ShareContent\": {\r\n                    shareCommentary: {\r\n                        text: text,\r\n                    },\r\n                    shareMediaCategory: \"NONE\",\r\n                },\r\n            },\r\n            visibility: {\r\n                \"com.linkedin.ugc.MemberNetworkVisibility\": \"PUBLIC\",\r\n            },\r\n        };\r\n\r\n        if (assets.length > 0) {\r\n            // If any video, treat as VIDEO (LinkedIn only supports single video usually, or mixed? \r\n            // Standard API supports single video OR multiple images. Not mixed usually.)\r\n            // If multiple assets and one is video, we might have an issue if we try to send all.\r\n            // For now, if there's a video, we take the first video and ignore others, or assume user knows what they are doing.\r\n            // If all images, we send all.\r\n\r\n            const hasVideo = assets.some(a => a.isVideo);\r\n\r\n            if (hasVideo) {\r\n                shareBody.specificContent[\"com.linkedin.ugc.ShareContent\"].shareMediaCategory = \"VIDEO\";\r\n                // Only take the first video\r\n                const videoAsset = assets.find(a => a.isVideo);\r\n                shareBody.specificContent[\"com.linkedin.ugc.ShareContent\"].media = [\r\n                    {\r\n                        status: \"READY\",\r\n                        description: { text: \"Video content\" },\r\n                        media: videoAsset?.urn,\r\n                        title: { text: \"Video content\" },\r\n                    }\r\n                ];\r\n            } else {\r\n                shareBody.specificContent[\"com.linkedin.ugc.ShareContent\"].shareMediaCategory = \"IMAGE\";\r\n                shareBody.specificContent[\"com.linkedin.ugc.ShareContent\"].media = assets.map(asset => ({\r\n                    status: \"READY\",\r\n                    description: { text: \"Image content\" },\r\n                    media: asset.urn,\r\n                    title: { text: \"Image content\" },\r\n                }));\r\n            }\r\n        }\r\n\r\n        const postResponse = await fetch(\"https://api.linkedin.com/v2/ugcPosts\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                ...commonHeaders,\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify(shareBody),\r\n        });\r\n\r\n        if (!postResponse.ok) {\r\n            const errorText = await postResponse.text();\r\n            console.error(`[LinkedIn] Create Post Failed: ${postResponse.status} ${postResponse.statusText}`, errorText);\r\n            throw new Error(`Failed to create post: ${errorText}`);\r\n        }\r\n\r\n        const postData = await postResponse.json();\r\n        console.log(\"[LinkedIn] Post created successfully:\", postData.id);\r\n        return postData;\r\n\r\n    } catch (error) {\r\n        console.error(\"LinkedIn posting error:\", error);\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\media-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\pinterest.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\plans.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\razorpay.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":1,"column":18,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":1,"endColumn":37}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const Razorpay = require(\"razorpay\");\r\nimport crypto from \"crypto\";\r\n\r\n// Initialize Razorpay instance\r\nexport const razorpay = new Razorpay({\r\n    key_id: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID!,\r\n    key_secret: process.env.RAZORPAY_KEY_SECRET!,\r\n});\r\n\r\n/**\r\n * Create a Razorpay order\r\n */\r\nexport async function createRazorpayOrder(\r\n    amount: number,\r\n    currency: string = \"INR\",\r\n    receipt: string,\r\n    notes?: Record<string, string>\r\n) {\r\n    try {\r\n        const options = {\r\n            amount: amount * 100, // Razorpay expects amount in paise\r\n            currency,\r\n            receipt,\r\n            notes,\r\n        };\r\n\r\n        const order = await razorpay.orders.create(options);\r\n        return order;\r\n    } catch (error) {\r\n        console.error(\"Error creating Razorpay order:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Verify Razorpay payment signature\r\n */\r\nexport function verifyRazorpaySignature(\r\n    orderId: string,\r\n    paymentId: string,\r\n    signature: string\r\n): boolean {\r\n    try {\r\n        const text = `${orderId}|${paymentId}`;\r\n        const generatedSignature = crypto\r\n            .createHmac(\"sha256\", process.env.RAZORPAY_KEY_SECRET!)\r\n            .update(text)\r\n            .digest(\"hex\");\r\n\r\n        return generatedSignature === signature;\r\n    } catch (error) {\r\n        console.error(\"Error verifying signature:\", error);\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Verify Razorpay webhook signature\r\n */\r\nexport function verifyWebhookSignature(\r\n    body: string,\r\n    signature: string,\r\n    secret: string\r\n): boolean {\r\n    try {\r\n        const expectedSignature = crypto\r\n            .createHmac(\"sha256\", secret)\r\n            .update(body)\r\n            .digest(\"hex\");\r\n\r\n        return expectedSignature === signature;\r\n    } catch (error) {\r\n        console.error(\"Error verifying webhook signature:\", error);\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Fetch payment details from Razorpay\r\n */\r\nexport async function fetchPaymentDetails(paymentId: string) {\r\n    try {\r\n        const payment = await razorpay.payments.fetch(paymentId);\r\n        return payment;\r\n    } catch (error) {\r\n        console.error(\"Error fetching payment details:\", error);\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\twilio.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\lib\\youtube.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refreshYouTubeToken' is defined but never used.","line":15,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1012,1015],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1012,1015],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4170,4173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4170,4173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":142,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4773,4776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4773,4776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5944,5947],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5944,5947],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":208,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6921,6924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6921,6924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import fs from 'fs/promises';\r\nimport path from 'path';\r\n\r\ninterface YouTubeCredentials {\r\n    accessToken: string;\r\n    refreshToken?: string;\r\n}\r\n\r\ninterface YouTubeMetadata {\r\n    tags?: string[];\r\n    privacy?: 'public' | 'private' | 'unlisted';\r\n}\r\n\r\n// Refresh YouTube access token using refresh token\r\nasync function refreshYouTubeToken(refreshToken: string, clientId: string, clientSecret: string): Promise<string> {\r\n    const response = await fetch('https://oauth2.googleapis.com/token', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        body: new URLSearchParams({\r\n            client_id: clientId,\r\n            client_secret: clientSecret,\r\n            refresh_token: refreshToken,\r\n            grant_type: 'refresh_token',\r\n        }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n        const error = await response.text();\r\n        throw new Error(`Failed to refresh YouTube token: ${error}`);\r\n    }\r\n\r\n    const data: any = await response.json();\r\n    return data.access_token;\r\n}\r\n\r\n// Upload video to YouTube using resumable upload\r\nexport async function postToYouTube(\r\n    credentials: YouTubeCredentials,\r\n    title: string,\r\n    description: string,\r\n    videoUrl: string,\r\n    metadata?: YouTubeMetadata\r\n) {\r\n    const { accessToken } = credentials;\r\n\r\n    console.log(`[YouTube] Starting video upload: ${title}`);\r\n\r\n    try {\r\n        // Step 1: Read the video file from local storage\r\n        const publicDir = path.join(process.cwd(), 'public');\r\n        const videoPath = path.join(publicDir, videoUrl);\r\n\r\n        console.log(`[YouTube] Reading video from: ${videoPath}`);\r\n        const videoBuffer = await fs.readFile(videoPath);\r\n        const videoSize = videoBuffer.length;\r\n\r\n        console.log(`[YouTube] Video size: ${videoSize} bytes`);\r\n\r\n        // Step 2: Initialize resumable upload session\r\n        const initResponse = await fetch('https://www.googleapis.com/upload/youtube/v3/videos?uploadType=resumable&part=snippet,status', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Authorization': `Bearer ${accessToken}`,\r\n                'Content-Type': 'application/json',\r\n                'X-Upload-Content-Length': videoSize.toString(),\r\n                'X-Upload-Content-Type': 'video/*',\r\n            },\r\n            body: JSON.stringify({\r\n                snippet: {\r\n                    title,\r\n                    description,\r\n                    tags: metadata?.tags || [],\r\n                    categoryId: '22', // People & Blogs\r\n                },\r\n                status: {\r\n                    privacyStatus: metadata?.privacy || 'public',\r\n                    selfDeclaredMadeForKids: false,\r\n                },\r\n            }),\r\n        });\r\n\r\n        if (!initResponse.ok) {\r\n            const error = await initResponse.text();\r\n            console.error('[YouTube] Init upload error:', error);\r\n\r\n            // Check if it's an authentication error\r\n            if (initResponse.status === 401) {\r\n                throw new Error('YouTube access token expired. Please reconnect your YouTube account in Settings.');\r\n            }\r\n\r\n            throw new Error(`YouTube init upload failed: ${error}`);\r\n        }\r\n\r\n        // Get the upload URL from Location header\r\n        const uploadUrl = initResponse.headers.get('location');\r\n        if (!uploadUrl) {\r\n            throw new Error('No upload URL received from YouTube');\r\n        }\r\n\r\n        console.log(`[YouTube] Upload session created, uploading video...`);\r\n\r\n        // Step 3: Upload the video file\r\n        const uploadResponse = await fetch(uploadUrl, {\r\n            method: 'PUT',\r\n            headers: {\r\n                'Content-Length': videoSize.toString(),\r\n                'Content-Type': 'video/*',\r\n            },\r\n            body: videoBuffer,\r\n        });\r\n\r\n        if (!uploadResponse.ok) {\r\n            const error = await uploadResponse.text();\r\n            console.error('[YouTube] Video upload error:', error);\r\n            throw new Error(`YouTube video upload failed: ${error}`);\r\n        }\r\n\r\n        const videoData: any = await uploadResponse.json();\r\n        console.log(`[YouTube] Video uploaded successfully: ${videoData.id}`);\r\n\r\n        return { id: videoData.id };\r\n\r\n    } catch (error) {\r\n        console.error('YouTube video upload error:', error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Create a YouTube Community Post (text + optional image)\r\nexport async function postYouTubeCommunity(\r\n    credentials: YouTubeCredentials,\r\n    text: string,\r\n    imageUrl?: string\r\n) {\r\n    const { accessToken } = credentials;\r\n\r\n    console.log(`[YouTube] Creating community post`);\r\n\r\n    try {\r\n        const postData: any = {\r\n            snippet: {\r\n                textMessageDetails: {\r\n                    messageText: text,\r\n                },\r\n            },\r\n        };\r\n\r\n        // Add image if provided\r\n        if (imageUrl) {\r\n            postData.snippet.imageDetails = {\r\n                url: imageUrl,\r\n            };\r\n        }\r\n\r\n        const response = await fetch('https://www.googleapis.com/youtube/v3/communityPosts', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Authorization': `Bearer ${accessToken}`,\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(postData),\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const error = await response.json();\r\n            console.error('[YouTube] Community post error:', error);\r\n\r\n            // Check if it's an authentication error\r\n            if (response.status === 401) {\r\n                throw new Error('YouTube access token expired. Please reconnect your YouTube account in Settings.');\r\n            }\r\n\r\n            throw new Error(`YouTube Community Post error: ${JSON.stringify(error)}`);\r\n        }\r\n\r\n        const data: any = await response.json();\r\n        console.log(`[YouTube] Community post created: ${data.id}`);\r\n\r\n        return { id: data.id };\r\n\r\n    } catch (error) {\r\n        console.error('YouTube community post error:', error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Get YouTube channel info\r\nexport async function getYouTubeChannelInfo(accessToken: string) {\r\n    try {\r\n        const response = await fetch('https://www.googleapis.com/youtube/v3/channels?part=snippet,contentDetails,statistics&mine=true', {\r\n            headers: {\r\n                'Authorization': `Bearer ${accessToken}`,\r\n            },\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const error = await response.json();\r\n\r\n            if (response.status === 401) {\r\n                throw new Error('YouTube access token expired. Please reconnect your YouTube account.');\r\n            }\r\n\r\n            throw new Error(`YouTube API error: ${JSON.stringify(error)}`);\r\n        }\r\n\r\n        const data: any = await response.json();\r\n        return data.items?.[0] || null;\r\n\r\n    } catch (error) {\r\n        console.error('YouTube channel info error:', error);\r\n        throw error;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\mahes\\OneDrive\\Desktop\\new-vercel-campzeo\\campzeoV1\\types\\razorpay.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]